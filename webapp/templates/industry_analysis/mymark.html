{% extends "stock_base.html" %}
{% block current_user %}
    {{ current_user.username }}
{% endblock %}

{% block body %}

    {#    地图模态框#}
    <div class="modal fade" id="modal_map">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- 模态框头部 -->
                <div class="modal-header">
                    <h4 class="modal-title">地图</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <!-- 模态框主体 -->
                <div class="modal-body">
                    <div id="map" style="height:400px;width:500px;margin:0 auto"></div>
                </div>
                <!-- 模态框底部 -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>
    {#    悬浮地图按钮#}
    <div id="dg" style="z-index: 9999; position: fixed ! important; right: 40px; top:100px;">
        <input type="button" value="全国" id="all_province">
        <input type="button" data-toggle="modal" data-target="#modal_map"
               style="margin-left:10px;background:url('../static/China_map.jpg') no-repeat center  ; width:50px; height:50px;background-size:100% 100%;border-radius:10px;">
        {#            <button  type="button" class="btn btn-default btn-circle"  background-image:;></button>#}
        </br>
        <a id="province_selected"></a>
    <input type="button" id="test" value="111">
    </div>
    <div class="span9">
        <div class="content">
            <div class="btn-controls">
                <!--市场分析-->
                <div class="btn-box-row row-fluid">
                    <div class="module span12">
                        <div class="module-head">
                            <a href="#postable" aria-expanded="false" data-toggle="collapse">市场分析</a>
                        </div>
                        <div class="modal-body">
                            <div id="postable" style="margin: auto;width:95%">
                                <ul id="myTab" class="am-nav nav-tabs">
                                    <li class="disabled">
                                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                                    </li>
                                    <li class="active"><a href="#chart" data-toggle="tab">图表</a>
                                    </li>
                                    <li><a href="#table" data-toggle="tab" onclick="RequestTable()">数据</a></li>
                                </ul>
                                <div id="mychoice" style="width:18%;height:300px;float:left;overflow-y :auto">
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:black"
                                             id="i_tot_oper_rev"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="tot_oper_rev" checked="checked"
                                                          id="first_check">总营业收入</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_net_profit_is"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="net_profit_is">净利润总和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_wgsd_net_inc"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="wgsd_net_inc">股东利润和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_tot_assets"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="tot_assets">总资产总和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_tot_liab"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="tot_liab">总负债总和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_net_assets"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="net_assets">净资产总和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_wgsd_com_eq"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="wgsd_com_eq">股东权益和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_operatecashflow_ttm2"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="operatecashflow_ttm2">经营性现金</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_investcashflow_ttm2"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="investcashflow_ttm2">投资性现金</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_financecashflow_ttm2"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="financecashflow_ttm2">融资性现金</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_cashflow_ttm2"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="cashflow_ttm2">总现金流</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="i_free_cash_flow"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="free_cash_flow">自由现金流</label>
                                        </div>
                                    </div>
                                </div>
                                <div id="choice" class="tab-content">
                                    <div class="tab-pane fade in active" id="chart">
                                        <div id="mychart" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                    <div class="tab-pane fade" id="table">
                                        <div id="mytable" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                </div>
                                <div style="float:right;width:80%;height:40px;margin-top:10px;border-radius:8px;background-color:#dcdcdc">
                                    <div style="float: left;margin-left:0;margin-top:10px">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c;">起始时间:</a><input size="10"
                                                                                                              type="text"
                                                                                                              value="2007-12-31"
                                                                                                              id="endtime"
                                                                                                              readonly
                                                                                                              class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">结束时间:</a><input size="10"
                                                                                                             type="text"
                                                                                                             value="2016-12-31"
                                                                                                             id="starttime"
                                                                                                             readonly
                                                                                                             class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">单位:</a>
                                        <select style="width:50px;height:26px;font-size: 10px;" id="unit">
                                            <option value="0" style="font-size: 10px;">亿</option>
                                            <option value="1" style="font-size: 10px;">万亿</option>
                                        </select>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <!--行业状况-->
                <div class="btn-box-row row-fluid">
                    <div class="module span12" style="background-color: transparent">
                        <div class="module-head">行业状况</div>
                        <div class="row-fluid">
                            <div class="btn-box small span3">
                                <div id="one" style="width:100%;height:200px;background-color: white">
                                    <script>

                                    </script>
                                </div>
                            </div>
                            <div class="btn-box small span3">
                                <div id="two" style="width:100%;height:200px;background-color: white">
                                    <script>

                                    </script>
                                </div>
                            </div>
                            <div class="btn-box small span3">
                                <div id="three" style="width:100%;height:200px;background-color: white">
                                    <script>

                                    </script>
                                </div>
                            </div>
                            <div class="btn-box small span3">
                                <div id="four" style="width:100%;height:200px;background-color: white">
                                    <script>

                                    </script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

{#                test#}
                <div class="btn-box-row row-fluid">
                    <div class="module span12" style="background-color: transparent">
                        <div class="module-head">行业状况</div>
                        <div class="row-fluid">
                            <div class="btn-box small span3">
                                <div id="one1" style="width:100%;height:200px;background-color: white">

                                </div>
                            </div>
                            <div class="btn-box small span3">
                                <div id="two1" style="width:100%;height:200px;background-color: white">
                                    <script>

                                    </script>
                                </div>
                            </div>
                            <div class="btn-box small span3">
                                <div id="three1" style="width:100%;height:200px;background-color: white">
                                    <script>

                                    </script>
                                </div>
                            </div>
                            <div class="btn-box small span3">
                                <div id="four1" style="width:100%;height:200px;background-color: white">
                                    <script>

                                    </script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--行业分析-->
                <div class="btn-box-row row-fluid">
                    <div class="module span12">
                        <div class="module-head">
                            <a href="#postgroup1" aria - expanded="false" data - toggle="collapse"> 行业分析 </a>
                        </div>
                        <div class="modal-body">
                            <div id="postgroup1" style="margin: auto;width:95%;height:auto">
                                <div class="form-search" id="form1">
                                    <div style="height:50px" class="input-group">
                                        <input id="stockcode1" list="itemlist1" name="stockcode" type="text"
                                               style="margin-top:0;margin-left:10px;height: 30px;width:100px;">
                                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                        <datalist id="itemlist1">
                                            <option value="10">能源</option>
                                            <option value="15">材料</option>
                                            <option value="20">工业</option>
                                            <option value="25">可选消费</option>
                                            <option value="30">日常消费</option>
                                            <option value="35">医疗保健</option>
                                            <option value="40">金融</option>
                                            <option value="45">信息技术</option>
                                            <option value="50">电信服务</option>
                                            <option value="55">公共事业</option>
                                            <option value="60">房地产</option>
                                        </datalist>
                                        <button id="submit1" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:10px;width:60px;height: 30px"
                                                data-toggle="tooltip"
                                                data-placement="right">搜索
                                        </button>

                                        <input id="stockcode2" list="itemlist22" name="stockcode" type="text"
                                               style="margin-top:0;margin-left:10px;height: 30px;width:100px;">
                                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                        <datalist id="itemlist22"></datalist>
                                        <button id="submit2" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:10px;width:60px;height: 30px"
                                                data-toggle="tooltip"
                                                data-placement="right">搜索
                                        </button>

                                        <input id="stockcode3" list="itemlist33" name="stockcode" type="text"
                                               style="margin-top:0;margin-left:10px;height: 30px;width:100px;">
                                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                        <datalist id="itemlist33"></datalist>
                                        <button id="submit3" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:10px;width:60px;height: 30px"
                                                data-toggle="tooltip"
                                                data-placement="right">搜索
                                        </button>

                                        <input id="stockcode4" list="itemlist44" name="stockcode" type="text"
                                               style="margin-top:0;margin-left:10px;height: 30px;width:100px;">
                                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                        <datalist id="itemlist44"></datalist>
                                        <button id="submit4" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:10px;width:60px;height: 30px"
                                                data-toggle="tooltip"
                                                data-placement="right">搜索
                                        </button>

                                    </div>
                                </div>
                                <ul id="myTab1" class="am-nav nav-tabs">
                                    <li class="disabled">
                                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                                    </li>
                                    <li class="active"><a href="#chart1" data-toggle="tab">图表</a>
                                    </li>
                                    <li><a href="#table1" data-toggle="tab" onclick="RequestTable1()">数据</a></li>
                                </ul>
                                <div id="mychoice1" style="width:18%;height:300px;float:left;overflow-y :auto">
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:black"
                                             id="a_tot_oper_rev"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="tot_oper_rev" checked="checked"
                                                          id="thefirst1">总营业收入</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_net_profit_is"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="net_profit_is">净利润总和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_wgsd_net_inc"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="wgsd_net_inc">股东利润和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_tot_assets"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="tot_assets">总资产总和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_tot_liab"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="tot_liab">总负债总和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_net_assets"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="net_assets">净资产总和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_wgsd_com_eq"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="wgsd_com_eq">股东权益和</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_operatecashflow_ttm2"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="operatecashflow_ttm2">经营性现金</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_investcashflow_ttm2"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="investcashflow_ttm2">投资性现金</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_financecashflow_ttm2"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="financecashflow_ttm2">融资性现金</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_cashflow_ttm2"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="cashflow_ttm2">总现金流</label>
                                        </div>
                                    </div>
                                    <div class="thediv"
                                         style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                        <div style="width:10px;height:10px;margin-right:5px;float:right;margin-top:15px;background-color:white"
                                             id="a_free_cash_flow"></div>
                                        <div class="checkbox"
                                             style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                            <label><input type="checkbox" value="free_cash_flow">自由现金流</label>
                                        </div>
                                    </div>
                                </div>
                                <div id="choice1" class="tab-content">
                                    <div class="tab-pane fade in active" id="chart1">
                                        <div id="mychart1" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                    <div class="tab-pane fade" id="table1">
                                        <div id="mytable1" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                </div>
                                <div style="float:right;width:80%;height:40px;margin-top:10px;border-radius:8px;background-color:#dcdcdc">
                                    <div style="float: left;margin-left:0;margin-top:10px">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c;">起始时间:</a><input size="10"
                                                                                                              type="text"
                                                                                                              value="1991-12-31"
                                                                                                              id="endtime1"
                                                                                                              readonly
                                                                                                              class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">结束时间:</a><input size="10"
                                                                                                             type="text"
                                                                                                             value="2016-12-31"
                                                                                                             id="starttime1"
                                                                                                             readonly
                                                                                                             class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">单位:</a>
                                        <select style="width:50px;height:26px;font-size: 10px;" id="unit1">
                                            <option value="0" style="font-size: 10px;">亿</option>
                                            <option value="1" style="font-size: 10px;">千亿</option>
                                        </select>
                                    </div>
                                </div>

                                <!--级联菜单1-->
                                <script>
                                    var dbct = {
                                        '1010': '能源Ⅱ',
                                        '1510': '材料Ⅱ',
                                        '2010': '资本货物',
                                        '2020': '商业和专业服务',
                                        '2030': '运输',
                                        '2510': '汽车与汽车零部件',
                                        '2520': '耐用消费品与服装',
                                        '2530': '消费者服务Ⅱ',
                                        '2540': '媒体Ⅱ',
                                        '2550': '零售业',
                                        '3010': '食品与主要用品零售Ⅱ',
                                        '3020': '食品、饮料与烟草',
                                        '3030': '家庭与个人用品',
                                        '3510': '医疗保健设备与服务',
                                        '3520': '制药、生物科技与生命科学',
                                        '4010': '银行',
                                        '4020': '多元金融<',
                                        '4030': '保险Ⅱ',
                                        '4510': '软件与服务',
                                        '4520': '技术硬件与设备',
                                        '4530': '半导体与半导体生产设备',
                                        '5010': '电信服务Ⅱ',
                                        '5510': '公用事业Ⅱ',
                                        '6010': '房地产Ⅱ'
                                    };
                                    $("#submit1").click(function () {
                                        thiscode1 = $("#stockcode1").val();
                                        Chosenindexes1 = ['tot_oper_rev'];
                                        Chosenindexes1['tot_oper_rev'] = "#000000";
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_form1") }}',
                                            data: {
                                                code: thiscode1,
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                for (var i = 0; i < data.length; i++) {
                                                    $('#itemlist22').append("<option value='" + data[i] + "'>" + dbct[data[i]] + "</option>")
                                                }
                                                requestChart1();
                                                $("div#mychoice1 :checkbox").each(function () {//each()方法遍历所有的复选框
                                                    a = $(this).val();
                                                    if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                                                        if (a != 'tot_oper_rev') {
                                                            $(this).removeAttr("checked");
                                                            $("#a_" + a).css("background-color", "white");
                                                        }
                                                    }
                                                });
                                                $("#thefirst1").prop("checked", true);
                                                $("#a_tot_oper_rev").css("background-color", "#000000");
                                            }
                                        });
                                    });
                                </script>
                                <!--级联菜单2-->
                                <script>
                                    var dcct = {
                                        '101010': '能源设备与服务',
                                        '101020': '石油、天然气与供消费用燃料',
                                        '151010': '化工',
                                        '151020': '建材Ⅲ',
                                        '151030': '容器与包装',
                                        '151040': '金属、非金属与采矿',
                                        '151050': '纸与林木产品',
                                        '201010': '航空航天与国防Ⅲ',
                                        '201020': '建筑产品Ⅲ',
                                        '201030': '建筑与工程Ⅲ',
                                        '201040': '电气设备',
                                        '201050': '综合类Ⅲ',
                                        '201060': '机械',
                                        '201070': '贸易公司与工业品经销商Ⅲ ',
                                        '202010': '商业服务与用品',
                                        '202020': '专业服务',
                                        '203010': '航空货运与物流Ⅲ',
                                        '203020': '航空Ⅲ',
                                        '203030': '海运Ⅲ',
                                        '203040': '公路与铁路运输',
                                        '203050': '交通基础设施',
                                        '251010': '汽车零配件',
                                        '251020': '汽车',
                                        '252010': '家庭耐用消费品',
                                        '252020': '休闲设备与用品',
                                        '252030': '纺织品、服装与奢侈品',
                                        '253010': '酒店、餐馆与休闲Ⅲ',
                                        '253020': '综合消费者服务Ⅲ',
                                        '254010': '媒体Ⅲ',
                                        '255010': '消费品经销商Ⅲ',
                                        '255020': '互联网与售货目录零售',
                                        '255030': '多元化零售',
                                        '255040': '专营零售',
                                        '301010': '食品与主要用品零售Ⅲ',
                                        '302010': '饮料',
                                        '302020': '食品',
                                        '303010': '家庭用品Ⅲ',
                                        '303020': '个人用品Ⅲ ',
                                        '351010': '医疗保健设备与用品',
                                        '351020': '医疗保健提供商与服务',
                                        '351030': '医疗保健技术Ⅲ',
                                        '352010': '生物科技Ⅲ',
                                        '352020': '制药',
                                        '352030': '生命科学工具和服务Ⅲ',
                                        '401010': '商业银行',
                                        '402010': '多元金融服务',
                                        '402030': '资本市场',
                                        '403010': '保险Ⅲ',
                                        '451010': '互联网软件与服务Ⅲ',
                                        '451020': '信息技术服务',
                                        '451030': '软件',
                                        '452010': '通信设备Ⅲ',
                                        '452020': '电脑与外围设备',
                                        '452030': '电子设备、仪器和元件',
                                        '453010': '半导体产品与半导体设备',
                                        '501010': '多元电信服务',
                                        '501020': '无线电信业务Ⅲ',
                                        '551010': '电力Ⅲ',
                                        '551020': '燃气Ⅲ',
                                        '551030': '复合型公用事业Ⅲ ',
                                        '551040': '水务Ⅲ',
                                        '551050': '独立电力生产商与能源贸易商Ⅲ',
                                        '601020': '房地产管理和开发',
                                    };
                                    $("#submit2").click(function () {
                                        thiscode2 = $("#stockcode2").val();
                                        $("#mytable1").empty();
                                        myChart1.clear();
                                        Chosenindexes2 = ['tot_oper_rev'];
                                        Chosenindexes2['tot_oper_rev'] = "#000000";
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_form2") }}',
                                            data: {
                                                code: thiscode2,
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                for (var i = 0; i < data.length; i++) {
                                                    $('#itemlist33').append("<option value='" + data[i] + "'>" + dcct[data[i]] + "</option>")
                                                }
                                                requestChart2();
                                                $("div#mychoice1 :checkbox").each(function () {//each()方法遍历所有的复选框
                                                    a = $(this).val();
                                                    if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                                                        if (a != 'tot_oper_rev') {
                                                            $(this).removeAttr("checked");
                                                            $("#a_" + a).css("background-color", "white");
                                                        }
                                                    }
                                                });
                                                $("#thefirst1").prop("checked", true);
                                                $("#a_tot_oper_rev").css("background-color", "#000000");
                                            }
                                        });
                                    });
                                </script>
                                <!--级联菜单3-->
                                <script>
                                    var ddct = {
                                        '10101010': '石油天然气钻井',
                                        '10101020': '石油天然气设备与服务',
                                        '10102010': '综合性石油天然气',
                                        '10102020': '石油天然气勘探与生产',
                                        '10102030': '石油与天然气的炼制和销售',
                                        '10102040': '石油与天然气的储存和运输',
                                        '10102050': '煤炭与消费用燃料',
                                        '15101010': '基础化工',
                                        '15101011': '化纤',
                                        '15101020': '多元化工',
                                        '15101030': '化肥与农用化工',
                                        '15101040': '工业气体',
                                        '15101050': '特种化工',
                                        '15102010': '建材 ',
                                        '15103010': '金属与玻璃容器',
                                        '15103020': '纸包装',
                                        '15104010': '铝',
                                        '15104020': '金属非金属',
                                        '15104030': '黄金',
                                        '15104040': '贵金属与矿石',
                                        '15104045': '白银',
                                        '15104050': '钢铁',
                                        '15105010': '林木产品',
                                        '15105020': '纸制品',
                                        '20101010': '航天航空与国防',
                                        '20102010': '建筑产品',
                                        '20103010': '建筑与工程',
                                        '20104010': '电气部件与设备',
                                        '20104020': '重型电气设备',
                                        '20105010': '综合类行业',
                                        '20106010': '建筑机械与重型卡车',
                                        '20106015': '农用农业机械',
                                        '20106020': '工业机械',
                                        '20107010': '贸易公司与工业品经销商',
                                        '20201010': '商业印刷',
                                        '20201050': '环境与设施服务',
                                        '20201060': '办公服务与用品',
                                        '20201070': '综合支持服务',
                                        '20201080': '安全和报警服务',
                                        '20202020': '调查和咨询服务',
                                        '20301010': '航空货运与物流',
                                        '20302010': '航空 ',
                                        '20303010': '海运',
                                        '20304010': '铁路运输',
                                        '20304020': '公路运输',
                                        '20305010': '机场服务',
                                        '20305020': '公路与铁路',
                                        '20305030': '海港与服务',
                                        '25101010': '汽车零配件',
                                        '25101020': '轮胎与橡胶',
                                        '25102010': '汽车制造',
                                        '25102020': '摩托车制造',
                                        '25201010': '消费电子产品',
                                        '25201020': '家庭装饰品',
                                        '25201030': '住宅建筑',
                                        '25201040': '家用电器',
                                        '25201050': '家用器具与特殊消费品',
                                        '25202010': '休闲用品',
                                        '25202020': '摄影用品',
                                        '25203010': '服装、服饰与奢侈品',
                                        '25203020': '鞋类',
                                        '25203030': '纺织品',
                                        '25301020': '酒店、度假村与豪华游轮',
                                        '25301030': '休闲设施',
                                        '25301040': '餐馆',
                                        '25302010': '教育服务',
                                        '25401010': '广告',
                                        '25401020': '有线和卫星电视',
                                        '25401030': '电影与娱乐',
                                        '25401040': '出版',
                                        '25501010': '消费品经销商',
                                        '25502010': '售货目录零售',
                                        '25502020': '互联网零售',
                                        '25503010': '百货商店',
                                        '25503020': '综合货品商店',
                                        '25504020': '电脑与电子产品零售',
                                        '25504030': '专卖店',
                                        '25504050': '汽车零售',
                                        '30101010': '药品零售',
                                        '30101020': '食品分销商',
                                        '30101030': '食品零售',
                                        '30101040': '大卖场与超市',
                                        '30201010': '啤酒',
                                        '30201020': '白酒与葡萄酒',
                                        '30201030': '软饮料',
                                        '30202010': '农产品',
                                        '30202030': '食品加工与肉类',
                                        '30301010': '家庭用品',
                                        '30302010': '个人用品',
                                        '35101010': '医疗保健设备',
                                        '35101020': '医疗保健用品',
                                        '35102015': '保健护理服务',
                                        '35102020': '保健护理设施',
                                        '35103010': '医疗保健技术',
                                        '35201010': '生物科技',
                                        '35202010': '西药',
                                        '35202011': '中药',
                                        '35203010': '生命科学工具和服务',
                                        '40101010': '多元化银行',
                                        '40101015': '区域性银行',
                                        '40201020': '其他多元金融服务',
                                        '40201030': '多领域控股',
                                        '40203010': '资产管理与托管银行',
                                        '40203020': '投资银行业与经纪业',
                                        '40203030': '多元资本市场',
                                        '40301020': '人寿与健康保险',
                                        '40301030': '多元化保险',
                                        '40301040': '财产与意外伤害保险',
                                        '45101010': '互联网软件与服务',
                                        '45102010': '信息科技咨询与其它服务',
                                        '45102020': '数据处理与外包服务',
                                        '45103010': '应用软件',
                                        '45103020': '系统软件',
                                        '45103030': '家庭娱乐软件',
                                        '45202010': '通信设备',
                                        '45201020': '电脑硬件',
                                        '45202020': '电脑存储与外围设备',
                                        '45203010': '电子元件',
                                        '45203015': '电子设备和仪器',
                                        '45203020': '电子制造服务',
                                        '45303030': '技术产品经销商',
                                        '45301010': '半导体设备',
                                        '45301020': '半导体产品',
                                        '50101010': '非传统电信运营商',
                                        '50101020': '综合电信服务',
                                        '50102010': '无线电信业务',
                                        '55101010': '电力',
                                        '55102010': '燃气',
                                        '55103010': '复合型公用事业',
                                        '55104010': '水务',
                                        '55105010': '独立电力生产商与能源贸易商',
                                        '55105020': '新能源发电业者',
                                        '60102020': '房地产经营公司',
                                        '60102030': '房地产开发',
                                        '60102040': '房地产服务',
                                    };
                                    $("#submit3").click(function () {
                                        thiscode3 = $("#stockcode3").val();
                                        $("#mytable1").empty();
                                        myChart1.clear();
                                        Chosenindexes3 = ['tot_oper_rev'];
                                        Chosenindexes3['tot_oper_rev'] = "#000000";
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_form3") }}',
                                            data: {
                                                code: thiscode3,
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                for (var i = 0; i < data.length; i++) {
                                                    $('#itemlist44').append("<option value='" + data[i] + "'>" + ddct[data[i]] + "</option>")
                                                }
                                                requestChart3();
                                                $("div#mychoice1 :checkbox").each(function () {//each()方法遍历所有的复选框
                                                    a = $(this).val();
                                                    if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                                                        if (a != 'tot_oper_rev') {
                                                            $(this).removeAttr("checked");
                                                            $("#a_" + a).css("background-color", "white");
                                                        }
                                                    }
                                                });
                                                $("#thefirst1").prop("checked", true);
                                                $("#a_tot_oper_rev").css("background-color", "#000000");
                                            }
                                        });
                                    });
                                </script>
                                <!--级联菜单3-->
                                <script>
                                    $("#submit4").click(function () {
                                        thiscode4 = $("#stockcode4").val();
                                        $("#mytable1").empty();
                                        myChart1.clear();
                                        Chosenindexes4 = ['tot_oper_rev'];
                                        Chosenindexes4['tot_oper_rev'] = "#000000";
                                        requestChart4();
                                        $("div#mychoice1 :checkbox").each(function () {//each()方法遍历所有的复选框
                                            a = $(this).val();
                                            if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                                                if (a != 'tot_oper_rev') {
                                                    $(this).removeAttr("checked");
                                                    $("#a_" + a).css("background-color", "white");
                                                }
                                            }
                                        });
                                        $("#thefirst1").prop("checked", true);
                                        $("#a_tot_oper_rev").css("background-color", "#000000");
                                    });
                                </script>

                                <!--建图1-->
                                <script>
                                    var myChart1 = echarts.init(document.getElementById('mychart1'));
                                    var market_results1;
                                    var thiscode1 = '10';
                                    var dict = {
                                        'tot_oper_rev': '总营业收入',
                                        'net_profit_is': '净利润总和',
                                        'wgsd_net_inc': '归属股东利润总和',
                                        'tot_assets': '总资产总和',
                                        'tot_liab': '总负债总和',
                                        'net_assets': '净资产总和',
                                        'wgsd_com_eq': '股东权益总和',
                                        'operatecashflow_ttm2': '经营性现金流总和',
                                        'investcashflow_ttm2': '投资性现金流总和',
                                        'financecashflow_ttm2': '融资性现金流总和',
                                        'cashflow_ttm2': '总现金流总和',
                                        'free_cash_flow': '自由现金流估计',
                                        'net_profit_rate': '平均净利润率',
                                        'tot_assets_turnover': '平均总资产周转率',
                                        'equ_multi': '平均权益乘数',
                                        'roe_tot': '平均净资产收益率',
                                        'roe_holder': '平均净资产收益率（股东）'
                                    };
                                    $.ajax({
                                        type: 'GET',
                                        url: '{{ url_for("restfulapi.market_status1") }}',
                                        data: {
                                            code: thiscode1,
                                            starttime: '19911231',
                                            endtime: '20161231',
                                            indexes: ['tot_oper_rev'],
                                        },
                                        dataType: 'json',
                                        success: function (data) {
                                            dataSeries = [];
                                            temp = {
                                                name: data.indexes,
                                                type: 'bar',
                                                itemStyle: {normal: {color: '#000000'}},
                                                smooth: true,
                                                data: numfilter1(eval("data." + data.indexes))
                                            };
                                            dataSeries.push(temp);
                                            option = {
                                                title: {
                                                    text: '财务指标分析图',
                                                    left: '45%'
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                    }
                                                },
                                                legend: {
                                                    data: [],
                                                    orient: 'vertical',
                                                    left: '85%',
                                                    top: '10%',
                                                    formatter: function (name) {
                                                        return dict[name];
                                                    }
                                                },
                                                grid: {
                                                    left: '5%',
                                                    top: '10%',
                                                    containLabel: true
                                                },
                                                toolbox: {
                                                    feature: {
                                                        magicType: {
                                                            type: ['line', 'bar']
                                                        }
                                                    }
                                                },
                                                xAxis: {
                                                    type: 'category',
                                                    axisTick: {
                                                        show: false
                                                    },
                                                    data: dateformat(data.the_year),
                                                    Interval: 5
                                                },
                                                yAxis: {
                                                    type: 'value',
                                                    axisTick: {
                                                        show: false
                                                    },
                                                },
                                                dataZoom: [
                                                    {
                                                        type: 'slider',
                                                        xAxisIndex: [0],
                                                        startValue: "2016年Q4",
                                                        endValue: "1991年Q4",
                                                        filterMode: 'filter',
                                                    }
                                                ],
                                                series: dataSeries
                                            };
                                            myChart1.setOption(option, true);
                                            myChart1.on('datazoom', function (params) {
                                                option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                if (Math.ceil(1 - params.end / 100)) {
                                                    var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                }
                                                else {
                                                    var starts = '1991-12-31'
                                                }
                                                set_timepicker1(starts, ends)
                                            });
                                            function set_timepicker1(start, end) {
                                                document.getElementById('endtime1').value = start
                                                document.getElementById('starttime1').value = end
                                            }
                                        }
                                    });
                                    function requestChart1() {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status1") }}',
                                            data: {
                                                code: thiscode1,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: ['tot_oper_rev'],
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                dataSeries = [];
                                                temp = {
                                                    name: data.indexes,
                                                    type: 'bar',
                                                    itemStyle: {normal: {color: '#000000'}},
                                                    smooth: true,
                                                    data: numfilter1(eval("data." + data.indexes))
                                                };
                                                dataSeries.push(temp);
                                                option = {
                                                    title: {
                                                        text: '财务指标分析图',
                                                        left: '45%'
                                                    },
                                                    tooltip: {
                                                        trigger: 'item',
                                                        formatter: function (params) {
                                                            return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                        }
                                                    },
                                                    legend: {
                                                        data: [],
                                                        orient: 'vertical',
                                                        left: '85%',
                                                        top: '10%',
                                                        formatter: function (name) {
                                                            return dict[name];
                                                        }
                                                    },
                                                    grid: {
                                                        left: '5%',
                                                        top: '10%',
                                                        containLabel: true
                                                    },
                                                    toolbox: {
                                                        feature: {
                                                            magicType: {
                                                                type: ['line', 'bar']
                                                            }
                                                        }
                                                    },
                                                    xAxis: {
                                                        type: 'category',
                                                        axisTick: {
                                                            show: false
                                                        },
                                                        data: dateformat(data.the_year),
                                                        Interval: 5
                                                    },
                                                    yAxis: {
                                                        type: 'value',
                                                        axisTick: {
                                                            show: false
                                                        },
                                                    },
                                                    dataZoom: [
                                                        {
                                                            type: 'slider',
                                                            xAxisIndex: [0],
                                                            startValue: "2016年Q4",
                                                            endValue: "1991年Q4",
                                                            filterMode: 'filter',
                                                        }
                                                    ],
                                                    series: dataSeries
                                                };
                                                myChart1.setOption(option, true);
                                                myChart1.on('datazoom', function (params) {
                                                    option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                    var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                    if (Math.ceil(1 - params.end / 100)) {
                                                        var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                    }
                                                    else {
                                                        var starts = '1991-12-31'
                                                    }
                                                    set_timepicker1(starts, ends)
                                                });
                                            }
                                        });
                                    }
                                    function RequestChart1() {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status1") }}',
                                            data: {
                                                code: thiscode1,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexes1,
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                market_results1 = data;
                                                CreateChart1();
                                            }
                                        });
                                    }
                                    function CreateChart1() {
                                        dataSeries = [];
                                        for (var i = 0; i < market_results1.indexes.length; i++) {
                                            temp = {
                                                name: market_results1.indexes[i],
                                                type: 'bar',
                                                itemStyle: {normal: {color: Chosenindexes1[market_results1.indexes[i]]}},
                                                smooth: true,
                                                data: numfilter1(eval("market_results1." + market_results1.indexes[i]))
                                            };
                                            dataSeries.push(temp);
                                        }
                                        option = {
                                            title: {
                                                text: '财务指标分析图',
                                                left: '45%'
                                            },
                                            tooltip: {
                                                trigger: 'item',
                                                formatter: function (params) {
                                                    return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                }
                                            },
                                            legend: {
                                                data: [],
                                                orient: 'vertical',
                                                left: '85%',
                                                top: '10%',
                                                formatter: function (name) {
                                                    return dict[name];
                                                }
                                            },
                                            grid: {
                                                left: '5%',
                                                top: '10%',
                                                containLabel: true
                                            },
                                            toolbox: {
                                                feature: {
                                                    magicType: {
                                                        type: ['line', 'bar']
                                                    }
                                                }
                                            },
                                            xAxis: {
                                                type: 'category',
                                                axisTick: {
                                                    show: false
                                                },
                                                data: dateformat(market_results1.the_year),
                                                Interval: 5
                                            },
                                            yAxis: {
                                                type: 'value',
                                                axisTick: {
                                                    show: false
                                                },
                                            },
                                            dataZoom: [
                                                {
                                                    type: 'slider',
                                                    xAxisIndex: [0],
                                                    startValue: "2016年Q4",
                                                    endValue: "1991年Q4",
                                                    filterMode: 'filter',
                                                }
                                            ],
                                            series: dataSeries
                                        };
                                        myChart1.setOption(option, true);
                                        myChart1.on('datazoom', function (params) {
                                            option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                            var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                            if (Math.ceil(1 - params.end / 100)) {
                                                var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                            }
                                            else {
                                                var starts = '1991-12-31'
                                            }
                                            set_timepicker1(starts, ends)
                                        });
                                        function set_timepicker1(start, end) {
                                            document.getElementById('endtime1').value = start
                                            document.getElementById('starttime1').value = end
                                        }
                                    }

                                    function requestChart2() {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status2") }}',
                                            data: {
                                                code: thiscode2,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: ['tot_oper_rev'],
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                dataSeries = [];
                                                temp = {
                                                    name: data.indexes,
                                                    type: 'bar',
                                                    itemStyle: {normal: {color: '#000000'}},
                                                    smooth: true,
                                                    data: numfilter1(eval("data." + data.indexes))
                                                };
                                                dataSeries.push(temp);
                                                option = {
                                                    title: {
                                                        text: '财务指标分析图',
                                                        left: '45%'
                                                    },
                                                    tooltip: {
                                                        trigger: 'item',
                                                        formatter: function (params) {
                                                            return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                        }
                                                    },
                                                    legend: {
                                                        data: [],
                                                        orient: 'vertical',
                                                        left: '85%',
                                                        top: '10%',
                                                        formatter: function (name) {
                                                            return dict[name];
                                                        }
                                                    },
                                                    grid: {
                                                        left: '5%',
                                                        top: '10%',
                                                        containLabel: true
                                                    },
                                                    toolbox: {
                                                        feature: {
                                                            magicType: {
                                                                type: ['line', 'bar']
                                                            }
                                                        }
                                                    },
                                                    xAxis: {
                                                        type: 'category',
                                                        axisTick: {
                                                            show: false
                                                        },
                                                        data: dateformat(data.the_year),
                                                        Interval: 5
                                                    },
                                                    yAxis: {
                                                        type: 'value',
                                                        axisTick: {
                                                            show: false
                                                        },
                                                    },
                                                    dataZoom: [
                                                        {
                                                            type: 'slider',
                                                            xAxisIndex: [0],
                                                            startValue: "2016年Q4",
                                                            endValue: "1991年Q4",
                                                            filterMode: 'filter',
                                                        }
                                                    ],
                                                    series: dataSeries
                                                };
                                                myChart1.setOption(option, true);
                                                myChart1.on('datazoom', function (params) {
                                                    option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                    var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                    if (Math.ceil(1 - params.end / 100)) {
                                                        var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                    }
                                                    else {
                                                        var starts = '1991-12-31'
                                                    }
                                                    set_timepicker1(starts, ends)
                                                });
                                            }
                                        });
                                    }
                                    function requestChart3() {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status3") }}',
                                            data: {
                                                code: thiscode3,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: ['tot_oper_rev'],
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                dataSeries = [];
                                                temp = {
                                                    name: data.indexes,
                                                    type: 'bar',
                                                    itemStyle: {normal: {color: '#000000'}},
                                                    smooth: true,
                                                    data: numfilter1(eval("data." + data.indexes))
                                                };
                                                dataSeries.push(temp);
                                                option = {
                                                    title: {
                                                        text: '财务指标分析图',
                                                        left: '45%'
                                                    },
                                                    tooltip: {
                                                        trigger: 'item',
                                                        formatter: function (params) {
                                                            return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                        }
                                                    },
                                                    legend: {
                                                        data: [],
                                                        orient: 'vertical',
                                                        left: '85%',
                                                        top: '10%',
                                                        formatter: function (name) {
                                                            return dict[name];
                                                        }
                                                    },
                                                    grid: {
                                                        left: '5%',
                                                        top: '10%',
                                                        containLabel: true
                                                    },
                                                    toolbox: {
                                                        feature: {
                                                            magicType: {
                                                                type: ['line', 'bar']
                                                            }
                                                        }
                                                    },
                                                    xAxis: {
                                                        type: 'category',
                                                        axisTick: {
                                                            show: false
                                                        },
                                                        data: dateformat(data.the_year),
                                                        Interval: 5
                                                    },
                                                    yAxis: {
                                                        type: 'value',
                                                        axisTick: {
                                                            show: false
                                                        },
                                                    },
                                                    dataZoom: [
                                                        {
                                                            type: 'slider',
                                                            xAxisIndex: [0],
                                                            startValue: "2016年Q4",
                                                            endValue: "1991年Q4",
                                                            filterMode: 'filter',
                                                        }
                                                    ],
                                                    series: dataSeries
                                                };
                                                myChart1.setOption(option, true);
                                                myChart1.on('datazoom', function (params) {
                                                    option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                    var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                    if (Math.ceil(1 - params.end / 100)) {
                                                        var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                    }
                                                    else {
                                                        var starts = '1991-12-31'
                                                    }
                                                    set_timepicker1(starts, ends)
                                                });
                                            }
                                        });
                                    }
                                    function requestChart4() {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status4") }}',
                                            data: {
                                                code: thiscode4,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: ['tot_oper_rev'],
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                dataSeries = [];
                                                temp = {
                                                    name: data.indexes,
                                                    type: 'bar',
                                                    itemStyle: {normal: {color: '#000000'}},
                                                    smooth: true,
                                                    data: numfilter1(eval("data." + data.indexes))
                                                };
                                                dataSeries.push(temp);
                                                option = {
                                                    title: {
                                                        text: '财务指标分析图',
                                                        left: '45%'
                                                    },
                                                    tooltip: {
                                                        trigger: 'item',
                                                        formatter: function (params) {
                                                            return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                        }
                                                    },
                                                    legend: {
                                                        data: [],
                                                        orient: 'vertical',
                                                        left: '85%',
                                                        top: '10%',
                                                        formatter: function (name) {
                                                            return dict[name];
                                                        }
                                                    },
                                                    grid: {
                                                        left: '5%',
                                                        top: '10%',
                                                        containLabel: true
                                                    },
                                                    toolbox: {
                                                        feature: {
                                                            magicType: {
                                                                type: ['line', 'bar']
                                                            }
                                                        }
                                                    },
                                                    xAxis: {
                                                        type: 'category',
                                                        axisTick: {
                                                            show: false
                                                        },
                                                        data: dateformat(data.the_year),
                                                        Interval: 5
                                                    },
                                                    yAxis: {
                                                        type: 'value',
                                                        axisTick: {
                                                            show: false
                                                        },
                                                    },
                                                    dataZoom: [
                                                        {
                                                            type: 'slider',
                                                            xAxisIndex: [0],
                                                            startValue: "2016年Q4",
                                                            endValue: "1991年Q4",
                                                            filterMode: 'filter',
                                                        }
                                                    ],
                                                    series: dataSeries
                                                };
                                                myChart1.setOption(option, true);
                                                myChart1.on('datazoom', function (params) {
                                                    option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                    var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                    if (Math.ceil(1 - params.end / 100)) {
                                                        var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                    }
                                                    else {
                                                        var starts = '1991-12-31'
                                                    }
                                                    set_timepicker1(starts, ends)
                                                });
                                            }
                                        });
                                    }

                                    function set_timepicker1(start, end) {
                                        document.getElementById('endtime1').value = start
                                        document.getElementById('starttime1').value = end
                                    }
                                    function set_time1() {
                                        document.getElementById('endtime1').value = "1991-12-31"
                                        document.getElementById('starttime1').value = "2016-12-31"
                                    }
                                </script>

                                <!--建表-->
                                <script>
                                    var market_results_t1;
                                    var invest_results_t1;
                                    function RequestTable1() {
                                        var opt = myChart1.getOption();
                                        var dz = opt.dataZoom[0];
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status1")}}',
                                            data: {
                                                code: thiscode1,
                                                starttime: opt.xAxis[0].data[dz.endValue],
                                                endtime: opt.xAxis[0].data[dz.startValue],
                                                indexes: Chosenindexes1
                                            },
                                            dataType: 'json',//希望服务器返回json格式的数据
                                            success: function (data) {
                                                console.log(data)
                                                market_results_t1 = data;
                                                invest_results_t1 = data;
                                                CreateTable1();
                                            }
                                        })
                                    }
                                    function CreateTable1() {
                                        $("#mytable1").empty();
                                        var table = $("<table id=\"temptable1\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                        table.appendTo($("#mytable1"));
                                        th = $("<thead></thead>");
                                        th.appendTo(table);
                                        var tr = $("<tr></tr>");
                                        tr.appendTo(th);
                                        var td = $("<td id=\"subject\">" + "项目" + "</td>");
                                        td.appendTo(tr);
                                        theyear = dateformat(market_results_t1.the_year)
                                        for (var j = 0; j < theyear.length; j++) {
                                            var td = $("<td>" + theyear[j] + "</td>");
                                            td.appendTo(tr);
                                        }
                                        tb = $("<tbody></tbody>");
                                        tb.appendTo(table);
                                        $("#mytable1").append("</table>");
                                        var mydatatb = $('#temptable1').DataTable({
                                            "info": false,
                                            "processing": true,
                                            "scrollX": true,
                                            "searching": true,
                                            "fixedColumns": { //固定列的配置项
                                                "leftColumns": 1//固定左边第一列
                                            },
                                            "language": {
                                                "emptyTable": "没有数据",
                                                "loadingRecords": "加载中…",
                                                "processing": "查询中…",
                                                "search": "检索:",
                                                "lengthMenu": "每页 _MENU_ 条",
                                                "zeroRecords": "没有数据",
                                                "paginate": {
                                                    "first": "第一页",
                                                    "last": "最后一页",
                                                    "next": "",
                                                    "previous": ""
                                                },
                                                "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                "infoEmpty": "没有数据",
                                                "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                            }
                                        });
                                        setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                        for (var i = 0; i < market_results_t1.indexes.length; i++) {
                                            var rowNode = mydatatb
                                                .row.add([dict[market_results_t1.indexes[i]]].concat(numfilter1(eval("market_results_t1." + market_results_t1.indexes[i]))))
                                                .draw()
                                                .node();
                                            $(rowNode)
                                                .attr('id', market_results_t1.indexes[i]);
                                        }
                                        for (var key in Chosenindexes1) {
                                            $('tr#' + key).css('color', Chosenindexes1[key])
                                        }
                                    }
                                </script>
                                <!--复选框操作-->
                                <script>
                                    var Chosenindexes1 = new Array();
                                    Chosenindexes1 = ['tot_oper_rev'];
                                    Chosenindexes1['tot_oper_rev'] = "#000000";
                                    $("div#mychoice1 :checkbox").change(function () {
                                        indexname1 = $(this).val();
                                        if ($(this).is(':checked') == true) {
                                            colorname1 = NewColor();
                                            console.log(this);
                                            Chosenindexes1.push(indexname1);
                                            Chosenindexes1[indexname1] = colorname1;
                                            $("#a_" + indexname1).css("background-color", colorname1);
                                            console.log(Chosenindexes1);
                                        }
                                        else {
                                            Chosenindexes1.remove(indexname1);
                                            console.log(Chosenindexes1);
                                            $("#a_" + indexname1).css("background-color", "white");
                                        }
                                        RequestChart1();
                                        RequestTable1()
                                        set_time1();
                                    });
                                </script>
                                <!--时间控制框-->
                                <script>
                                    var starttime1 = "19911231";
                                    var endtime1 = "20161231";
                                    $(".form_datetime").datetimepicker({
                                        format: 'yyyy-mm-dd ',
                                        startView: 4,
                                        minView: 4,
                                        maxView: 4,
                                        autoclose: true,
                                        pickerPosition: 'top-right'
                                    });
                                    $('#starttime1').datetimepicker('setStartDate', '1991-12-31');
                                    $('#starttime1').datetimepicker('setEndDate', '2016-12-31');
                                    $('#endtime1').datetimepicker('setStartDate', '1991-12-31');
                                    $('#endtime1').datetimepicker('setEndDate', '2016-12-31');
                                    $('#starttime1')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            starts = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].startValue = starts;
                                            myChart1.setOption(option);
                                            RequestTable1();
                                        });
                                    $('#endtime1')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            ends = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].endValue = ends;
                                            myChart1.setOption(option);
                                            RequestTable1();
                                        });
                                    Date.prototype.Format = function (fmt) { //author: meizz
                                        var o = {
                                            "M+": this.getMonth() + 1, //月份
                                            "d+": this.getDate(), //日
                                            "h+": this.getHours(), //小时
                                            "m+": this.getMinutes(), //分
                                            "s+": this.getSeconds(), //秒
                                            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                                            "S": this.getMilliseconds() //毫秒
                                        };
                                        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
                                        for (var k in o)
                                            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                                        return fmt;
                                    }
                                    function dateformat(olddate) {
                                        newdate = []
                                        for (i = 0; i < olddate.length; i++) {
                                            var str = olddate[i];
                                            var reg = /1231/g;
                                            str = str.replace(reg, '年Q4');
                                            newdate.push(str)
                                        }
                                        return newdate
                                    }
                                </script>
                                <!--单位转换-->
                                <script>
                                    denominator1 = 1
                                    $("select#unit1").change(function () {
                                        flag = $(this).val();
                                        if (flag == "0") {
                                            denominator1 = 1;
                                            RequestChart1();
                                            CreateTable1();
                                            set_time1();
                                        }
                                        if (flag == "1") {
                                            denominator1 = 1000;
                                            RequestChart1();
                                            CreateTable1();
                                            set_time1();
                                        }
                                    });
                                    function numfilter1(oldnum) {
                                        newnum = []
                                        for (i = 0; i < oldnum.length; i++) {
                                            temp = oldnum[i] / denominator1;
                                            newnum.push(temp.toFixed(2))
                                        }
                                        return newnum;
                                    }
                                </script>
                                <!--面板切换-->
                                <script>
                                    $("#mydropdown").on("click", "[data-stopPropagation]", function (e) {
                                        e.stopPropagation();
                                    })
                                </script>
                                <!--随机生成颜色-->
                                <script>
                                    function NewColor() {
                                        var colorElements = "0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";
                                        var colorArray = colorElements.split(",");
                                        var color = "#";
                                        for (var i = 0; i < 6; i++) {
                                            color += colorArray[Math.floor(Math.random() * 16)];
                                        }
                                        return color;
                                    }
                                </script>
                                <!--删除函数-->
                                <script>
                                    Array.prototype.indexOf = function (val) {
                                        for (var i = 0; i < this.length; i++) {
                                            if (this[i] == val) return i;
                                        }
                                        return -1;
                                    };
                                    Array.prototype.remove = function (val) {
                                        var index = this.indexOf(val);
                                        if (index > -1) {
                                            this.splice(index, 1);
                                        }
                                    };
                                </script>
                            </div>
                        </div>
                    </div>
                </div>

                <!--部门对比分析-->
                <div class="btn-box-row row-fluid">
                    <div class="module span12">
                        <div class="module-head">
                            <a href="#compare1" aria-expanded="false" data-toggle="collapse">部门对比分析
                                <input id="stock" list="item" type="text"
                                       style="margin-top:0;margin-left:10px;height: 30px">
                                <datalist id="item">
                                    <option>部门</option>
                                    <option>行业组</option>
                                    <option>行业</option>
                                    <option>子行业</option>
                                </datalist>
                            </a>
                        </div>
                        <div class="modal-body">
                            <div id="compare1" style="margin: auto;width:95%">
                                <div class="form-search" id="forms1">
                                    <div style="height:50px" class="input-group">
                                        <input id="stockcodes1" list="itemlists1" type="text"
                                               style="margin-top:0;margin-left:10px;height: 30px">
                                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                        <datalist id="itemlists1">
                                            <option value="10">能源</option>
                                            <option value="15">材料</option>
                                            <option value="20">工业</option>
                                            <option value="25">可选消费</option>
                                            <option value="30">日常消费</option>
                                            <option value="35">医疗保健</option>
                                            <option value="40">金融</option>
                                            <option value="45">信息技术</option>
                                            <option value="50">电信服务</option>
                                            <option value="55">公共事业</option>
                                            <option value="60">房地产</option>
                                        </datalist>
                                        <button id="submits1" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:20px;width:150px;height: 30px"
                                                data-toggle="tooltip"
                                                data-placement="right">添加比较项
                                        </button>
                                        <button id="clear1" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:10px;width:150px;height: 30px">清空比较列表
                                        </button>
                                    </div>
                                </div>
                                <ul id="myTabs1" class="am-nav nav-tabs">
                                    <li class="disabled">
                                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                                    </li>
                                    <li class="active"><a href="#charts1" data-toggle="tab">图表</a>
                                    </li>
                                    <li><a href="#tables1" data-toggle="tab">数据</a>
                                    </li>
                                </ul>
                                <div style="width:18%;height:300px;float:left;">
                                    <div id="myspan1" style="width:100%;height:80px;float:left;overflow-y :auto">
                                        <div id="div_compare1" style="overflow-y: auto"></div>
                                    </div>
                                    <div id="mychoices1"
                                         style="width:100%;height:220px;float:left;margin-top:0;overflow-y :auto">
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton" value="tot_oper_rev"
                                                              checked="checked"
                                                              id="thefirsts1">总营业收入</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton" value="net_profit_is">净利润总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton" value="wgsd_net_inc">股东利润和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton"
                                                              value="tot_assets">总资产总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton"
                                                              value="tot_liab">总负债总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton"
                                                              value="net_assets">净资产总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton" value="wgsd_com_eq">股东权益和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton"
                                                              value="operatecashflow_ttm2">经营性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton"
                                                              value="investcashflow_ttm2">投资性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton"
                                                              value="financecashflow_ttm2">融资性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton" value="cashflow_ttm2">总现金流</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton" value="free_cash_flow">自由现金流</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="choices1" class="tab-content">
                                    <div class="tab-pane fade in active" id="charts1">
                                        <div id="mycharts1" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                    <div class="tab-pane fade" id="tables1">
                                        <div id="mytables1" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                </div>
                                <div style="float:right;width:80%;height:40px;margin-top:10px;border-radius:8px;background-color:#dcdcdc">
                                    <div style="float: left;margin-left:0;margin-top:10px">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c;">起始时间:</a><input size="10"
                                                                                                              type="text"
                                                                                                              value="1991-12-31"
                                                                                                              id="endtimes1"
                                                                                                              readonly
                                                                                                              class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">结束时间:</a><input size="10"
                                                                                                             type="text"
                                                                                                             value="2016-12-31"
                                                                                                             id="starttimes1"
                                                                                                             readonly
                                                                                                             class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">单位:</a>
                                        <select style="width:50px;height:26px;font-size: 10px;" id="units1">
                                            <option value="0" style="font-size: 10px;">亿</option>
                                            <option value="1" style="font-size: 10px;">千亿</option>
                                        </select>
                                    </div>
                                </div>

                                <script>
                                    $("#submits1").click(function () {
                                        thiscodes1 = $("#stockcodes1").val();
                                        var a1 = 1;
                                        for (var i = 0; i < codelists1.length; i++) {
                                            if (thiscodes1 == codelists1[i]) {
                                                alert('已添加，请勿重复添加！')
                                                a1 = 0
                                            }
                                        }
                                        if (a1) {
                                            codelists1.push(thiscodes1);
                                            colorlists1[thiscodes1] = NewColor();
                                            RequestCharts1(codelists1);
                                            creat_compares1(thiscodes1);
                                            RequestTables1(codelists1);
                                        }
                                    });
                                    $("#clear1").click(function () {
                                        codelists1 = [];
                                        $('#div_compare1').empty();
                                        $("#mytables1").empty();
                                        var myCharts1 = echarts.init(document.getElementById('mycharts1'));
                                        myCharts1.clear();
                                    });
                                </script>
                                <!--图表-->
                                <script>
                                    var myCharts1 = echarts.init(document.getElementById('mycharts1'));
                                    var adict = {
                                        '10': '能源',
                                        '15': '材料',
                                        '20': '工业',
                                        '25': '可选消费',
                                        '30': '日常消费',
                                        '35': '医疗保健',
                                        '40': '金融',
                                        '45': '信息技术',
                                        '50': '电信服务',
                                        '55': '公共事业',
                                        '60': '房地产',
                                    };
                                    var Chosenindexe1 = new Array();
                                    Chosenindexe1 = ['tot_oper_rev'];
                                    var colorlists1 = {};
                                    var codelists1 = ['10', '15'];
                                    colorlists1['10'] = '#000000';
                                    colorlists1['15'] = '#028600';
                                    var market_results_ts1;
                                    var invest_results_ts1;

                                    $('#div_compare1').empty();
                                    dataSeries1 = []
                                    $.ajax({
                                        type: 'GET',
                                        url: '{{ url_for("restfulapi.market_status1") }}',
                                        data: {
                                            code: '10',
                                            starttime: '19911231',
                                            endtime: '20161231',
                                            indexes: Chosenindexe1,
                                        },
                                        dataType: 'json',
                                        success: function (data) {
                                            $('#div_compare1').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists1[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                + data.the_code + "-" + adict[data.the_code] + "</span></div>")
                                            for (var i = 0; i < data.indexes.length; i++) {
                                                temp = {
                                                    name: data.the_code,
                                                    type: 'bar',
                                                    itemStyle: {normal: {color: colorlists1[data.the_code]}},
                                                    symbolSize: 8,
                                                    smooth: true,
                                                    data: numfilters1(eval("data." + data.indexes[i])),
                                                };
                                                dataSeries1.push(temp);
                                            }
                                            $.ajax({
                                                type: 'GET',
                                                url: '{{ url_for("restfulapi.market_status1") }}',
                                                data: {
                                                    code: '15',
                                                    starttime: '19911231',
                                                    endtime: '20161231',
                                                    indexes: Chosenindexe1,
                                                },
                                                dataType: 'json',
                                                success: function (data) {
                                                    $('#div_compare1').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists1[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                        + data.the_code + "-" + adict[data.the_code] + "</span></div>")
                                                    for (var i = 0; i < data.indexes.length; i++) {
                                                        temp = {
                                                            name: data.the_code,
                                                            type: 'bar',
                                                            itemStyle: {normal: {color: colorlists1[data.the_code]}},
                                                            symbolSize: 8,
                                                            smooth: true,
                                                            data: numfilters1(eval("data." + data.indexes[i])),
                                                        };
                                                        dataSeries1.push(temp);
                                                    }
                                                    option = {
                                                        title: {
                                                            text: '财务指标分析图',
                                                            left: '45%'
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                return adict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                            }
                                                        },
                                                        legend: {
                                                            data: [],
                                                            orient: 'vertical',
                                                            left: '85%',
                                                            top: '10%',
                                                            formatter: function (name) {
                                                                return adict[name];
                                                            }
                                                        },
                                                        grid: {
                                                            left: '5%',
                                                            top: '10%',
                                                            containLabel: true
                                                        },
                                                        toolbox: {
                                                            feature: {
                                                                magicType: {
                                                                    type: ['line', 'bar']
                                                                }
                                                            }
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                            data: dateformat(data.the_year),
                                                            Interval: 5
                                                        },
                                                        yAxis: {
                                                            type: 'value',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                        },
                                                        dataZoom: [
                                                            {
                                                                type: 'slider',
                                                                xAxisIndex: [0],
                                                                startValue: "2016年Q4",
                                                                endValue: "1991年Q4",
                                                                filterMode: 'filter',
                                                            }
                                                        ],
                                                        series: dataSeries1
                                                    };
                                                    myCharts1.setOption(option, true);
                                                    myCharts1.on('datazoom', function (params) {
                                                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                        var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                        if (Math.ceil(1 - params.end / 100)) {
                                                            var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                        }
                                                        else {
                                                            var starts = '1991-12-31'
                                                        }
                                                        set_timepickers1(starts, ends)
                                                    });
                                                    function set_timepickers1(start, end) {
                                                        document.getElementById('endtimes1').value = start
                                                        document.getElementById('starttimes1').value = end
                                                    }
                                                }
                                            });
                                        }
                                    });
                                    CreateTables1(codelists1);

                                    function RequestCharts1(codelists1) {
                                        dataSeries = [];
                                        for (var k = 0; k < codelists1.length; k++) {
                                            $.ajax({
                                                type: 'GET',
                                                url: '{{ url_for("restfulapi.market_status1") }}',
                                                data: {
                                                    code: codelists1[k],
                                                    starttime: '19911231',
                                                    endtime: '20161231',
                                                    indexes: Chosenindexe1,
                                                },
                                                dataType: 'json',
                                                success: function (data) {
                                                    for (var i = 0; i < data.indexes.length; i++) {
                                                        temp = {
                                                            name: data.the_code,
                                                            type: 'bar',
                                                            itemStyle: {normal: {color: colorlists1[data.the_code]}},
                                                            symbolSize: 8,
                                                            smooth: true,
                                                            data: numfilters1(eval("data." + data.indexes[i])),
                                                        };
                                                        dataSeries.push(temp);
                                                    }
                                                    option = {
                                                        title: {
                                                            text: '财务指标分析图',
                                                            left: '45%'
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                return adict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                            }
                                                        },
                                                        legend: {
                                                            data: [],
                                                            orient: 'vertical',
                                                            left: '85%',
                                                            top: '10%',
                                                            formatter: function (name) {
                                                                return adict[name];
                                                            }
                                                        },
                                                        grid: {
                                                            left: '5%',
                                                            top: '10%',
                                                            containLabel: true
                                                        },
                                                        toolbox: {
                                                            feature: {
                                                                magicType: {
                                                                    type: ['line', 'bar']
                                                                }
                                                            }
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                            data: dateformat(data.the_year),
                                                            Interval: 5
                                                        },
                                                        yAxis: {
                                                            type: 'value',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                        },
                                                        dataZoom: [
                                                            {
                                                                type: 'slider',
                                                                xAxisIndex: [0],
                                                                startValue: "2016年Q4",
                                                                endValue: "1991年Q4",
                                                                filterMode: 'filter',
                                                            }
                                                        ],
                                                        series: dataSeries
                                                    };
                                                    myCharts1.setOption(option, true);
                                                    myCharts1.on('datazoom', function (params) {
                                                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                        var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                        if (Math.ceil(1 - params.end / 100)) {
                                                            var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                        }
                                                        else {
                                                            var starts = '1991-12-31'
                                                        }
                                                        set_timepickers1(starts, ends)
                                                    });
                                                    function set_timepickers1(start, end) {
                                                        document.getElementById('endtimes1').value = start
                                                        document.getElementById('starttimes1').value = end
                                                    }
                                                }
                                            })
                                        }
                                    }
                                    function creat_compares1(thiscodes1) {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status1") }}',
                                            data: {
                                                code: thiscodes1,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexe1,
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                $('#div_compare1').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists1[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                    + data.the_code + "-" + adict[data.the_code] + "</span></div>")
                                            }
                                        });
                                    }
                                    function set_times1() {
                                        document.getElementById('endtimes1').value = "1991-12-31"
                                        document.getElementById('starttimes1').value = "2016-12-31"
                                    }
                                    function RequestTables1(codelists1) {
                                        var opt = myCharts1.getOption();
                                        var dz = opt.dataZoom[0];
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status1")}}',
                                            data: {
                                                code: '10',
                                                starttime: opt.xAxis[0].data[dz.endValue],
                                                endtime: opt.xAxis[0].data[dz.startValue],
                                                indexes: Chosenindexe1
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                console.log(data)
                                                market_results_ts1 = data;
                                                $("#mytables1").empty();
                                                var table = $("<table id=\"temptables1\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                                table.appendTo($("#mytables1"));
                                                th = $("<thead></thead>");
                                                th.appendTo(table);
                                                var tr = $("<tr></tr>");
                                                tr.appendTo(th);
                                                var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                                                td.appendTo(tr);
                                                theyear = dateformat(market_results_ts1.the_year)
                                                for (var j = 0; j < theyear.length; j++) {
                                                    var td = $("<td>" + theyear[j] + "</td>");
                                                    td.appendTo(tr);
                                                }
                                                tb = $("<tbody></tbody>");
                                                tb.appendTo(table);
                                                $("#mytables1").append("</table>");
                                                var mydatatb = $('#temptables1').DataTable({
                                                    "info": false,
                                                    "processing": true,
                                                    "scrollX": true,
                                                    "searching": true,
                                                    "fixedColumns": { //固定列的配置项
                                                        "leftColumns": 1//固定左边第一列
                                                    },
                                                    "language": {
                                                        "emptyTable": "没有数据",
                                                        "loadingRecords": "加载中…",
                                                        "processing": "查询中…",
                                                        "search": "检索:",
                                                        "lengthMenu": "每页 _MENU_ 条",
                                                        "zeroRecords": "没有数据",
                                                        "paginate": {
                                                            "first": "第一页",
                                                            "last": "最后一页",
                                                            "next": "",
                                                            "previous": ""
                                                        },
                                                        "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                        "infoEmpty": "没有数据",
                                                        "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                                    }
                                                });
                                                setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                                for (var k = 0; k < codelists1.length; k++) {
                                                    $.ajax({
                                                        type: 'GET',
                                                        url: '{{url_for("restfulapi.market_status1")}}',
                                                        data: {
                                                            code: codelists1[k],
                                                            starttime: opt.xAxis[0].data[dz.endValue],
                                                            endtime: opt.xAxis[0].data[dz.startValue],
                                                            indexes: Chosenindexe1
                                                        },
                                                        dataType: 'json',
                                                        success: function (data) {
                                                            invest_results_ts1 = '';
                                                            invest_results_ts1 = data;
                                                            for (var i = 0; i < invest_results_ts1.indexes.length; i++) {
                                                                var rowNode = mydatatb
                                                                    .row.add([adict[invest_results_ts1.the_code]].concat(numfilters1(eval("invest_results_ts1." + invest_results_ts1.indexes[i]))))
                                                                    .draw()
                                                                    .node();
                                                                $(rowNode)
                                                                    .attr('id', invest_results_ts1.the_code);
                                                                $(rowNode)
                                                                    .css('color', colorlists1[invest_results_ts1.the_code]);
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        });
                                    }
                                    function CreateTables1(codelists1) {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status1")}}',
                                            data: {
                                                code: '10',
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexe1
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                console.log(data)
                                                market_results_ts1 = data;
                                                $("#mytables1").empty();
                                                var table = $("<table id=\"temptables1\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                                table.appendTo($("#mytables1"));
                                                th = $("<thead></thead>");
                                                th.appendTo(table);
                                                var tr = $("<tr></tr>");
                                                tr.appendTo(th);
                                                var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                                                td.appendTo(tr);
                                                theyear = dateformat(market_results_ts1.the_year)
                                                for (var j = 0; j < theyear.length; j++) {
                                                    var td = $("<td>" + theyear[j] + "</td>");
                                                    td.appendTo(tr);
                                                }
                                                tb = $("<tbody></tbody>");
                                                tb.appendTo(table);
                                                $("#mytables1").append("</table>");
                                                var mydatatb = $('#temptables1').DataTable({
                                                    "info": false,
                                                    "processing": true,
                                                    "scrollX": true,
                                                    "searching": true,
                                                    "fixedColumns": { //固定列的配置项
                                                        "leftColumns": 1//固定左边第一列
                                                    },
                                                    "language": {
                                                        "emptyTable": "没有数据",
                                                        "loadingRecords": "加载中…",
                                                        "processing": "查询中…",
                                                        "search": "检索:",
                                                        "lengthMenu": "每页 _MENU_ 条",
                                                        "zeroRecords": "没有数据",
                                                        "paginate": {
                                                            "first": "第一页",
                                                            "last": "最后一页",
                                                            "next": "",
                                                            "previous": ""
                                                        },
                                                        "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                        "infoEmpty": "没有数据",
                                                        "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                                    }
                                                });
                                                setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                                for (var k = 0; k < codelists1.length; k++) {
                                                    $.ajax({
                                                        type: 'GET',
                                                        url: '{{url_for("restfulapi.market_status1")}}',
                                                        data: {
                                                            code: codelists1[k],
                                                            starttime: '19911231',
                                                            endtime: '20161231',
                                                            indexes: Chosenindexe1
                                                        },
                                                        dataType: 'json',
                                                        success: function (data) {
                                                            invest_results_ts1 = '';
                                                            invest_results_ts1 = data;
                                                            for (var i = 0; i < invest_results_ts1.indexes.length; i++) {
                                                                var rowNode = mydatatb
                                                                    .row.add([adict[invest_results_ts1.the_code]].concat(numfilters1(eval("invest_results_ts1." + invest_results_ts1.indexes[i]))))
                                                                    .draw()
                                                                    .node();
                                                                $(rowNode)
                                                                    .attr('id', invest_results_ts1.the_code);
                                                                $(rowNode)
                                                                    .css('color', colorlists1[invest_results_ts1.the_code]);
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        });
                                    }
                                </script>
                                <!--复选框操作-->
                                <script>
                                    $("div#mychoices1 :radio").change(function () {
                                        indexnames1 = $(this).val();
                                        if ($(this).is(':checked') == true) {
                                            console.log(this);
                                            Chosenindexe1 = [];
                                            Chosenindexe1.push(indexnames1);
                                            console.log(Chosenindexe1);
                                        }
                                        else {
                                            Chosenindexe1.remove(indexnames1);
                                            console.log(Chosenindexe1);
                                        }
                                        RequestCharts1(codelists1);
                                        RequestTables1(codelists1);
                                        set_times1();
                                    });
                                </script>
                                <!--时间控制框-->
                                <script>
                                    var starttimes1 = "19911231";
                                    var endtimes1 = "20161231";
                                    $(".form_datetime").datetimepicker({
                                        format: 'yyyy-mm-dd ',
                                        startView: 4,
                                        minView: 4,
                                        maxView: 4,
                                        autoclose: true,
                                        pickerPosition: 'top-right'
                                    });
                                    $('#starttimes1').datetimepicker('setStartDate', '1991-12-31');
                                    $('#starttimes1').datetimepicker('setEndDate', '2016-12-31');
                                    $('#endtimes1').datetimepicker('setStartDate', '1991-12-31');
                                    $('#endtimes1').datetimepicker('setEndDate', '2016-12-31');
                                    $('#starttimes1')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            starts = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].startValue = starts;
                                            myCharts1.setOption(option);
                                            RequestTables1(codelists1);
                                        });
                                    $('#endtimes1')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            ends = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].endValue = ends;
                                            myCharts1.setOption(option);
                                            RequestTables1(codelists1);
                                        });
                                    Date.prototype.Format = function (fmt) { //author: meizz
                                        var o = {
                                            "M+": this.getMonth() + 1, //月份
                                            "d+": this.getDate(), //日
                                            "h+": this.getHours(), //小时
                                            "m+": this.getMinutes(), //分
                                            "s+": this.getSeconds(), //秒
                                            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                                            "S": this.getMilliseconds() //毫秒
                                        };
                                        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
                                        for (var k in o)
                                            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                                        return fmt;
                                    }
                                    function dateformat(olddate) {
                                        newdate = []
                                        for (i = 0; i < olddate.length; i++) {
                                            var str = olddate[i];
                                            var reg = /1231/g;
                                            str = str.replace(reg, '年Q4');
                                            newdate.push(str)
                                        }
                                        return newdate
                                    }
                                </script>
                                <!--单位转换-->
                                <script>
                                    denominators1 = 1
                                    $("select#units1").change(function () {
                                        flag = $(this).val();
                                        if (flag == "0") {
                                            denominators1 = 1;
                                            RequestCharts1(codelists1);
                                            RequestTables1(codelists1);
                                            set_times1();
                                        }
                                        if (flag == "1") {
                                            denominators1 = 1000;
                                            RequestCharts1(codelists1);
                                            RequestTables1(codelists1);
                                            set_times1();
                                        }
                                    });
                                    function numfilters1(oldnum) {
                                        newnum = []
                                        for (i = 0; i < oldnum.length; i++) {
                                            temp = oldnum[i] / denominators1;
                                            newnum.push(temp.toFixed(2))
                                        }
                                        return newnum;
                                    }
                                </script>
                                <!--面板切换-->
                                <script>
                                    $("#mydropdown").on("click", "[data-stopPropagation]", function (e) {
                                        e.stopPropagation();
                                    })
                                </script>
                                <!--随机生成颜色-->
                                <script>
                                    function NewColor() {
                                        var colorElements = "0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";
                                        var colorArray = colorElements.split(",");
                                        var color = "#";
                                        for (var i = 0; i < 6; i++) {
                                            color += colorArray[Math.floor(Math.random() * 16)];
                                        }
                                        return color;
                                    }
                                </script>
                                <!--删除函数-->
                                <script>
                                    Array.prototype.indexOf = function (val) {
                                        for (var i = 0; i < this.length; i++) {
                                            if (this[i] == val) return i;
                                        }
                                        return -1;
                                    };
                                    Array.prototype.remove = function (val) {
                                        var index = this.indexOf(val);
                                        if (index > -1) {
                                            this.splice(index, 1);
                                        }
                                    };
                                </script>
                            </div>
                        </div>
                    </div>
                </div>

                <!--行业组对比分析-->
                <div class="btn-box-row row-fluid">
                    <div class="module span12">
                        <div class="module-head">
                            <a href="#compare2" aria - expanded="false" data - toggle="collapse"> 行业组对比分析 </a>
                        </div>
                        <div class="modal-body">
                            <div id="compare2" style="margin: auto;width:95%;height:auto">
                                <div class="form-search" id="forms2">
                                    <div style="height:50px" class="input-group">
                                        <input id="stockcodes2" list="itemlists2" type="text"
                                               style="margin-top:0;margin-left:10px;height: 30px">
                                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                        <datalist id="itemlists2">
                                            <option value="1010">能源Ⅱ</option>
                                            <option value="1510">材料Ⅱ</option>
                                            <option value="2010">资本货物</option>
                                            <option value="2020">商业和专业服务</option>
                                            <option value="2030">运输</option>
                                            <option value="2510">汽车与汽车零部件</option>
                                            <option value="2520">耐用消费品与服装</option>
                                            <option value="2530">消费者服务Ⅱ</option>
                                            <option value="2540">媒体Ⅱ</option>
                                            <option value="2550">零售业</option>
                                            <option value="3010">食品与主要用品零售Ⅱ</option>
                                            <option value="3020">食品、饮料与烟草</option>
                                            <option value="3030">家庭与个人用品</option>
                                            <option value="3510">医疗保健设备与服务</option>
                                            <option value="3520">制药、生物科技与生命科学</option>
                                            <option value="4010">银行</option>
                                            <option value="4020">多元金融</option>
                                            <option value="4030">保险Ⅱ</option>
                                            <option value="4510">软件与服务</option>
                                            <option value="4520">技术硬件与设备</option>
                                            <option value="4530">半导体与半导体生产设备</option>
                                            <option value="5010">电信服务Ⅱ</option>
                                            <option value="5510">公用事业Ⅱ</option>
                                            <option value="6010">房地产Ⅱ</option>
                                        </datalist>
                                        <button id="submits2" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:20px;width:150px;height: 30px"
                                                data-toggle="tooltip"
                                                data-placement="right">添加比较项
                                        </button>
                                        <button id="clear2" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:10px;width:150px;height: 30px">清空比较列表
                                        </button>
                                    </div>
                                </div>
                                <ul id="myTabs2" class="am-nav nav-tabs">
                                    <li class="disabled">
                                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                                    </li>
                                    <li class="active"><a href="#charts2" data-toggle="tab">图表</a>
                                    </li>
                                    <li><a href="#tables2" data-toggle="tab">数据</a>
                                    </li>
                                </ul>
                                <div style="width:18%;height:300px;float:left;">
                                    <div id="myspan2" style="width:100%;height:80px;float:left;overflow-y :auto">
                                        <div id="div_compare2" style="overflow-y: auto"></div>
                                    </div>
                                    <div id="mychoices2"
                                         style="width:100%;height:220px;float:left;margin-top:0;overflow-y :auto">
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2" value="tot_oper_rev"
                                                              checked="checked"
                                                              id="thefirsts2">总营业收入</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2" value="net_profit_is">净利润总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2" value="wgsd_net_inc">股东利润和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2"
                                                              value="tot_assets">总资产总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2"
                                                              value="tot_liab">总负债总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2"
                                                              value="net_assets">净资产总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2" value="wgsd_com_eq">股东权益和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2"
                                                              value="operatecashflow_ttm2">经营性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2"
                                                              value="investcashflow_ttm2">投资性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2"
                                                              value="financecashflow_ttm2">融资性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2" value="cashflow_ttm2">总现金流</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton2" value="free_cash_flow">自由现金流</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="choices2" class="tab-content">
                                    <div class="tab-pane fade in active" id="charts2">
                                        <div id="mycharts2" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                    <div class="tab-pane fade" id="tables2">
                                        <div id="mytables2" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                </div>
                                <div style="float:right;width:80%;height:40px;margin-top:10px;border-radius:8px;background-color:#dcdcdc">
                                    <div style="float: left;margin-left:0;margin-top:10px">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c;">起始时间:</a><input size="10"
                                                                                                              type="text"
                                                                                                              value="1991-12-31"
                                                                                                              id="endtimes2"
                                                                                                              readonly
                                                                                                              class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">结束时间:</a><input size="10"
                                                                                                             type="text"
                                                                                                             value="2016-12-31"
                                                                                                             id="starttimes2"
                                                                                                             readonly
                                                                                                             class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">单位:</a>
                                        <select style="width:50px;height:26px;font-size: 10px;" id="units2">
                                            <option value="0" style="font-size: 10px;">亿</option>
                                            <option value="1" style="font-size: 10px;">千亿</option>
                                        </select>
                                    </div>
                                </div>

                                <script>
                                    $("#submits2").click(function () {
                                        thiscodes2 = $("#stockcodes2").val();
                                        var a2 = 1;
                                        for (var i = 0; i < codelists2.length; i++) {
                                            if (thiscodes2 == codelists2[i]) {
                                                alert('已添加，请勿重复添加！')
                                                a2 = 0
                                            }
                                        }
                                        if (a2) {
                                            codelists2.push(thiscodes2);
                                            colorlists2[thiscodes2] = NewColor();
                                            RequestCharts2(codelists2);
                                            creat_compares2(thiscodes2);
                                            RequestTables2(codelists2);
                                        }
                                    });
                                    $("#clear2").click(function () {
                                        codelists2 = [];
                                        $('#div_compare2').empty();
                                        $("#mytables2").empty();
                                        var myCharts2 = echarts.init(document.getElementById('mycharts2'));
                                        myCharts2.clear();
                                    });
                                </script>
                                <!--图表-->
                                <script>
                                    var myCharts2 = echarts.init(document.getElementById('mycharts2'));
                                    var bdict = {
                                        '1010': '能源Ⅱ',
                                        '1510': '材料Ⅱ',
                                        '2010': '资本货物',
                                        '2020': '商业和专业服务',
                                        '2030': '运输',
                                        '2510': '汽车与汽车零部件',
                                        '2520': '耐用消费品与服装',
                                        '2530': '消费者服务Ⅱ',
                                        '2540': '媒体Ⅱ',
                                        '2550': '零售业',
                                        '3010': '食品与主要用品零售Ⅱ',
                                        '3020': '食品、饮料与烟草',
                                        '3030': '家庭与个人用品',
                                        '3510': '医疗保健设备与服务',
                                        '3520': '制药、生物科技与生命科学',
                                        '4010': '银行',
                                        '4020': '多元金融<',
                                        '4030': '保险Ⅱ',
                                        '4510': '软件与服务',
                                        '4520': '技术硬件与设备',
                                        '4530': '半导体与半导体生产设备',
                                        '5010': '电信服务Ⅱ',
                                        '5510': '公用事业Ⅱ',
                                        '6010': '房地产Ⅱ'
                                    };
                                    var Chosenindexe2 = new Array();
                                    Chosenindexe2 = ['tot_oper_rev'];
                                    var colorlists2 = {};
                                    var codelists2 = ['1010', '1510'];
                                    colorlists2['1010'] = '#000000';
                                    colorlists2['1510'] = '#028600';
                                    var market_results_ts2;
                                    var invest_results_ts2;

                                    dataSeries2 = []
                                    $.ajax({
                                        type: 'GET',
                                        url: '{{ url_for("restfulapi.market_status2") }}',
                                        data: {
                                            code: '1010',
                                            starttime: '19911231',
                                            endtime: '20161231',
                                            indexes: Chosenindexe2,
                                        },
                                        dataType: 'json',
                                        success: function (data) {
                                            $('#div_compare2').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists2[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                + data.the_code + "-" + bdict[data.the_code] + "</span></div>")
                                            for (var i = 0; i < data.indexes.length; i++) {
                                                temp = {
                                                    name: data.the_code,
                                                    type: 'bar',
                                                    itemStyle: {normal: {color: colorlists2[data.the_code]}},
                                                    symbolSize: 8,
                                                    smooth: true,
                                                    data: numfilters2(eval("data." + data.indexes[i])),
                                                };
                                                dataSeries2.push(temp);
                                            }
                                            $.ajax({
                                                type: 'GET',
                                                url: '{{ url_for("restfulapi.market_status2") }}',
                                                data: {
                                                    code: '1510',
                                                    starttime: '19911231',
                                                    endtime: '20161231',
                                                    indexes: Chosenindexe2,
                                                },
                                                dataType: 'json',
                                                success: function (data) {
                                                    $('#div_compare2').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists2[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                        + data.the_code + "-" + bdict[data.the_code] + "</span></div>")
                                                    for (var i = 0; i < data.indexes.length; i++) {
                                                        temp = {
                                                            name: data.the_code,
                                                            type: 'bar',
                                                            itemStyle: {normal: {color: colorlists2[data.the_code]}},
                                                            symbolSize: 8,
                                                            smooth: true,
                                                            data: numfilters2(eval("data." + data.indexes[i])),
                                                        };
                                                        dataSeries2.push(temp);
                                                    }
                                                    option = {
                                                        title: {
                                                            text: '财务指标分析图',
                                                            left: '45%'
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                return bdict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                            }
                                                        },
                                                        legend: {
                                                            data: [],
                                                            orient: 'vertical',
                                                            left: '85%',
                                                            top: '10%',
                                                            formatter: function (name) {
                                                                return bdict[name];
                                                            }
                                                        },
                                                        grid: {
                                                            left: '5%',
                                                            top: '10%',
                                                            containLabel: true
                                                        },
                                                        toolbox: {
                                                            feature: {
                                                                magicType: {
                                                                    type: ['line', 'bar']
                                                                }
                                                            }
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                            data: dateformat(data.the_year),
                                                            Interval: 5
                                                        },
                                                        yAxis: {
                                                            type: 'value',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                        },
                                                        dataZoom: [
                                                            {
                                                                type: 'slider',
                                                                xAxisIndex: [0],
                                                                startValue: "2016年Q4",
                                                                endValue: "1991年Q4",
                                                                filterMode: 'filter',
                                                            }
                                                        ],
                                                        series: dataSeries2
                                                    };
                                                    myCharts2.setOption(option, true);
                                                    myCharts2.on('datazoom', function (params) {
                                                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                        var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                        if (Math.ceil(1 - params.end / 100)) {
                                                            var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                        }
                                                        else {
                                                            var starts = '1991-12-31'
                                                        }
                                                        set_timepickers2(starts, ends)
                                                    });
                                                    function set_timepickers2(start, end) {
                                                        document.getElementById('endtimes2').value = start
                                                        document.getElementById('starttimes2').value = end
                                                    }
                                                }
                                            });
                                        }
                                    });
                                    CreateTables2(codelists2)

                                    function RequestCharts2(codelists2) {
                                        dataSeries = [];
                                        for (var k = 0; k < codelists2.length; k++) {
                                            $.ajax({
                                                type: 'GET',
                                                url: '{{ url_for("restfulapi.market_status2") }}',
                                                data: {
                                                    code: codelists2[k],
                                                    starttime: '19911231',
                                                    endtime: '20161231',
                                                    indexes: Chosenindexe2,
                                                },
                                                dataType: 'json',
                                                success: function (data) {
                                                    for (var i = 0; i < data.indexes.length; i++) {
                                                        temp = {
                                                            name: data.the_code,
                                                            type: 'bar',
                                                            itemStyle: {normal: {color: colorlists2[data.the_code]}},
                                                            symbolSize: 8,
                                                            smooth: true,
                                                            data: numfilters2(eval("data." + data.indexes[i])),
                                                        };
                                                        dataSeries.push(temp);
                                                    }
                                                    option = {
                                                        title: {
                                                            text: '财务指标分析图',
                                                            left: '45%'
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                return bdict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                            }
                                                        },
                                                        legend: {
                                                            data: [],
                                                            orient: 'vertical',
                                                            left: '85%',
                                                            top: '10%',
                                                            formatter: function (name) {
                                                                return bdict[name];
                                                            }
                                                        },
                                                        grid: {
                                                            left: '5%',
                                                            top: '10%',
                                                            containLabel: true
                                                        },
                                                        toolbox: {
                                                            feature: {
                                                                magicType: {
                                                                    type: ['line', 'bar']
                                                                }
                                                            }
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                            data: dateformat(data.the_year),
                                                            Interval: 5
                                                        },
                                                        yAxis: {
                                                            type: 'value',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                        },
                                                        dataZoom: [
                                                            {
                                                                type: 'slider',
                                                                xAxisIndex: [0],
                                                                startValue: "2016年Q4",
                                                                endValue: "1991年Q4",
                                                                filterMode: 'filter',
                                                            }
                                                        ],
                                                        series: dataSeries
                                                    };
                                                    myCharts2.setOption(option, true);
                                                    myCharts2.on('datazoom', function (params) {
                                                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                        var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                        if (Math.ceil(1 - params.end / 100)) {
                                                            var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                        }
                                                        else {
                                                            var starts = '1991-12-31'
                                                        }
                                                        set_timepickers2(starts, ends)
                                                    });
                                                    function set_timepickers2(start, end) {
                                                        document.getElementById('endtimes2').value = start
                                                        document.getElementById('starttimes2').value = end
                                                    }
                                                }
                                            })
                                        }
                                    }
                                    function creat_compares2(thiscodes2) {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status2") }}',
                                            data: {
                                                code: thiscodes2,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexe2,
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                $('#div_compare2').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists2[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                    + data.the_code + "-" + bdict[data.the_code] + "</span></div>")
                                            }
                                        });
                                    }
                                    function set_times2() {
                                        document.getElementById('endtimes2').value = "1991-12-31"
                                        document.getElementById('starttimes2').value = "2016-12-31"
                                    }
                                    function RequestTables2(codelists2) {
                                        var opt = myCharts2.getOption();
                                        var dz = opt.dataZoom[0];
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status2")}}',
                                            data: {
                                                code: '1010',
                                                starttime: opt.xAxis[0].data[dz.endValue],
                                                endtime: opt.xAxis[0].data[dz.startValue],
                                                indexes: Chosenindexe2
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                console.log(data)
                                                market_results_ts2 = data;
                                                $("#mytables2").empty();
                                                var table = $("<table id=\"temptables2\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                                table.appendTo($("#mytables2"));
                                                th = $("<thead></thead>");
                                                th.appendTo(table);
                                                var tr = $("<tr></tr>");
                                                tr.appendTo(th);
                                                var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                                                td.appendTo(tr);
                                                theyear = dateformat(market_results_ts2.the_year)
                                                for (var j = 0; j < theyear.length; j++) {
                                                    var td = $("<td>" + theyear[j] + "</td>");
                                                    td.appendTo(tr);
                                                }
                                                tb = $("<tbody></tbody>");
                                                tb.appendTo(table);
                                                $("#mytables2").append("</table>");
                                                var mydatatb = $('#temptables2').DataTable({
                                                    "info": false,
                                                    "processing": true,
                                                    "scrollX": true,
                                                    "searching": true,
                                                    "fixedColumns": { //固定列的配置项
                                                        "leftColumns": 1//固定左边第一列
                                                    },
                                                    "language": {
                                                        "emptyTable": "没有数据",
                                                        "loadingRecords": "加载中…",
                                                        "processing": "查询中…",
                                                        "search": "检索:",
                                                        "lengthMenu": "每页 _MENU_ 条",
                                                        "zeroRecords": "没有数据",
                                                        "paginate": {
                                                            "first": "第一页",
                                                            "last": "最后一页",
                                                            "next": "",
                                                            "previous": ""
                                                        },
                                                        "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                        "infoEmpty": "没有数据",
                                                        "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                                    }
                                                });
                                                setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                                for (var k = 0; k < codelists2.length; k++) {
                                                    $.ajax({
                                                        type: 'GET',
                                                        url: '{{url_for("restfulapi.market_status2")}}',
                                                        data: {
                                                            code: codelists2[k],
                                                            starttime: opt.xAxis[0].data[dz.endValue],
                                                            endtime: opt.xAxis[0].data[dz.startValue],
                                                            indexes: Chosenindexe2
                                                        },
                                                        dataType: 'json',
                                                        success: function (data) {
                                                            invest_results_ts2 = '';
                                                            invest_results_ts2 = data;
                                                            for (var i = 0; i < invest_results_ts2.indexes.length; i++) {
                                                                var rowNode = mydatatb
                                                                    .row.add([bdict[invest_results_ts2.the_code]].concat(numfilters2(eval("invest_results_ts2." + invest_results_ts2.indexes[i]))))
                                                                    .draw()
                                                                    .node();
                                                                $(rowNode)
                                                                    .attr('id', invest_results_ts2.the_code);
                                                                $(rowNode)
                                                                    .css('color', colorlists2[invest_results_ts2.the_code]);
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        });
                                    }
                                    function CreateTables2(codelists2) {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status2")}}',
                                            data: {
                                                code: '1010',
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexe2
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                console.log(data)
                                                market_results_ts2 = data;
                                                $("#mytables2").empty();
                                                var table = $("<table id=\"temptables2\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                                table.appendTo($("#mytables2"));
                                                th = $("<thead></thead>");
                                                th.appendTo(table);
                                                var tr = $("<tr></tr>");
                                                tr.appendTo(th);
                                                var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                                                td.appendTo(tr);
                                                theyear = dateformat(market_results_ts2.the_year)
                                                for (var j = 0; j < theyear.length; j++) {
                                                    var td = $("<td>" + theyear[j] + "</td>");
                                                    td.appendTo(tr);
                                                }
                                                tb = $("<tbody></tbody>");
                                                tb.appendTo(table);
                                                $("#mytables2").append("</table>");
                                                var mydatatb = $('#temptables2').DataTable({
                                                    "info": false,
                                                    "processing": true,
                                                    "scrollX": true,
                                                    "searching": true,
                                                    "fixedColumns": { //固定列的配置项
                                                        "leftColumns": 1//固定左边第一列
                                                    },
                                                    "language": {
                                                        "emptyTable": "没有数据",
                                                        "loadingRecords": "加载中…",
                                                        "processing": "查询中…",
                                                        "search": "检索:",
                                                        "lengthMenu": "每页 _MENU_ 条",
                                                        "zeroRecords": "没有数据",
                                                        "paginate": {
                                                            "first": "第一页",
                                                            "last": "最后一页",
                                                            "next": "",
                                                            "previous": ""
                                                        },
                                                        "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                        "infoEmpty": "没有数据",
                                                        "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                                    }
                                                });
                                                setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                                for (var k = 0; k < codelists2.length; k++) {
                                                    $.ajax({
                                                        type: 'GET',
                                                        url: '{{url_for("restfulapi.market_status2")}}',
                                                        data: {
                                                            code: codelists2[k],
                                                            starttime: '19911231',
                                                            endtime: '20161231',
                                                            indexes: Chosenindexe2
                                                        },
                                                        dataType: 'json',
                                                        success: function (data) {
                                                            invest_results_ts2 = '';
                                                            invest_results_ts2 = data;
                                                            for (var i = 0; i < invest_results_ts2.indexes.length; i++) {
                                                                var rowNode = mydatatb
                                                                    .row.add([bdict[invest_results_ts2.the_code]].concat(numfilters2(eval("invest_results_ts2." + invest_results_ts2.indexes[i]))))
                                                                    .draw()
                                                                    .node();
                                                                $(rowNode)
                                                                    .attr('id', invest_results_ts2.the_code);
                                                                $(rowNode)
                                                                    .css('color', colorlists2[invest_results_ts2.the_code]);
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        });
                                    }
                                </script>
                                <!--复选框操作-->
                                <script>
                                    $("div#mychoices2 :radio").change(function () {
                                        indexnames2 = $(this).val();
                                        if ($(this).is(':checked') == true) {
                                            console.log(this);
                                            Chosenindexe2 = [];
                                            Chosenindexe2.push(indexnames2);
                                            console.log(Chosenindexe2);
                                        }
                                        else {
                                            Chosenindexe2.remove(indexnames2);
                                            console.log(Chosenindexe2);
                                        }
                                        RequestCharts2(codelists2);
                                        RequestTables2(codelists2);
                                        set_times2();
                                    });
                                </script>
                                <!--时间控制框-->
                                <script>
                                    var starttimes2 = "19911231";
                                    var endtimes2 = "20161231";
                                    $(".form_datetime").datetimepicker({
                                        format: 'yyyy-mm-dd ',
                                        startView: 4,
                                        minView: 4,
                                        maxView: 4,
                                        autoclose: true,
                                        pickerPosition: 'top-right'
                                    });
                                    $('#starttimes2').datetimepicker('setStartDate', '1991-12-31');
                                    $('#starttimes2').datetimepicker('setEndDate', '2016-12-31');
                                    $('#endtimes2').datetimepicker('setStartDate', '1991-12-31');
                                    $('#endtimes2').datetimepicker('setEndDate', '2016-12-31');
                                    $('#starttimes2')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            starts = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].startValue = starts;
                                            myCharts2.setOption(option);
                                            RequestTables2(codelists2);
                                        });
                                    $('#endtimes2')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            ends = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].endValue = ends;
                                            myCharts2.setOption(option);
                                            RequestTables2(codelists2);
                                        });
                                    Date.prototype.Format = function (fmt) { //author: meizz
                                        var o = {
                                            "M+": this.getMonth() + 1, //月份
                                            "d+": this.getDate(), //日
                                            "h+": this.getHours(), //小时
                                            "m+": this.getMinutes(), //分
                                            "s+": this.getSeconds(), //秒
                                            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                                            "S": this.getMilliseconds() //毫秒
                                        };
                                        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 -
                                            RegExp.$1.length));
                                        for (var k in o)
                                            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length
                                            == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                                        return fmt;
                                    }
                                    function dateformat(olddate) {
                                        newdate = []
                                        for (i = 0; i < olddate.length; i++) {
                                            var str = olddate[i];
                                            var reg = /1231/g;
                                            str = str.replace(reg, '年Q4');
                                            newdate.push(str)
                                        }
                                        return newdate
                                    }
                                </script>
                                <!--单位转换-->
                                <script>
                                    denominators2 = 1
                                    $("select#units2").change(function () {
                                        flag = $(this).val();
                                        if (flag == "0") {
                                            denominators2 = 1;
                                            RequestCharts2(codelists2);
                                            RequestTables2(codelists2);
                                            set_times2();
                                        }
                                        if (flag == "1") {
                                            denominators2 = 1000;
                                            RequestCharts2(codelists2);
                                            RequestTables2(codelists2);
                                            set_times2();
                                        }
                                    });
                                    function numfilters2(oldnum) {
                                        newnum = []
                                        for (i = 0; i < oldnum.length; i++) {
                                            temp = oldnum[i] / denominators2;
                                            newnum.push(temp.toFixed(2))
                                        }
                                        return newnum;
                                    }
                                </script>
                                <!--面板切换-->
                                <script>
                                    $("#mydropdown").on("click", "[data-stopPropagation]", function (e) {
                                        e.stopPropagation();
                                    })
                                </script>
                                <!--随机生成颜色-->
                                <script>
                                    function NewColor() {
                                        var colorElements = "0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";
                                        var colorArray = colorElements.split(",");
                                        var color = "#";
                                        for (var i = 0; i < 6; i++) {
                                            color += colorArray[Math.floor(Math.random() * 16)];
                                        }
                                        return color;
                                    }
                                </script>
                                <!--删除函数-->
                                <script>
                                    Array.prototype.indexOf = function (val) {
                                        for (var i = 0; i < this.length; i++) {
                                            if (this[i] == val) return i;
                                        }
                                        return -1;
                                    };
                                    Array.prototype.remove = function (val) {
                                        var index = this.indexOf(val);
                                        if (index > -1) {
                                            this.splice(index, 1);
                                        }
                                    };
                                </script>
                            </div>
                        </div>
                    </div>
                </div>

                <!--行业对比分析-->
                <div class="btn-box-row row-fluid">
                    <div class="module span12">
                        <div class="module-head">
                            <a href="#compare3" aria - expanded="false" data - toggle="collapse"> 行业对比分析 </a>
                        </div>
                        <div class="modal-body">
                            <div id="compare3" style="margin: auto;width:95%;height:auto">
                                <div class="form-search" id="forms3">
                                    <div style="height:50px" class="input-group">
                                        <input id="stockcodes3" list="itemlists3" type="text"
                                               style="margin-top:0;margin-left:10px;height: 30px">
                                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                        <datalist id="itemlists3">
                                            <option value="101010">能源设备与服务</option>
                                            <option value="101020">石油、天然气与供消费用燃料</option>
                                            <option value="151010">化工</option>
                                            <option value="151020">建材Ⅲ</option>
                                            <option value="151030">容器与包装</option>
                                            <option value="151040">金属、非金属与采矿</option>
                                            <option value="151050">纸与林木产品</option>
                                            <option value="201010">航空航天与国防Ⅲ</option>
                                            <option value="201020">建筑产品Ⅲ</option>
                                            <option value="201030">建筑与工程Ⅲ</option>
                                            <option value="201040">电气设备</option>
                                            <option value="201050">综合类Ⅲ</option>
                                            <option value="201060">机械</option>
                                            <option value="201070">贸易公司与工业品经销商Ⅲ</option>
                                            <option value="202010">商业服务与用品</option>
                                            <option value="202020">专业服务</option>
                                            <option value="203010">航空货运与物流Ⅲ</option>
                                            <option value="203020">航空Ⅲ</option>
                                            <option value="203030">海运Ⅲ</option>
                                            <option value="203040">公路与铁路运输</option>
                                            <option value="203050">交通基础设施</option>
                                            <option value="251010">汽车零配件</option>
                                            <option value="251020">汽车</option>
                                            <option value="252010">家庭耐用消费品</option>
                                            <option value="252020">休闲设备与用品</option>
                                            <option value="252030">纺织品、服装与奢侈品</option>
                                            <option value="253010">酒店、餐馆与休闲Ⅲ</option>
                                            <option value="253020">综合消费者服务Ⅲ</option>
                                            <option value="254010">媒体Ⅲ</option>
                                            <option value="255010">消费品经销商Ⅲ</option>
                                            <option value="255020">互联网与售货目录零售</option>
                                            <option value="255030">多元化零售</option>
                                            <option value="255040">专营零售</option>
                                            <option value="301010">食品与主要用品零售Ⅲ</option>
                                            <option value="302010">饮料</option>
                                            <option value="302020">食品</option>
                                            <option value="303010">家庭用品Ⅲ</option>
                                            <option value="303020">个人用品Ⅲ</option>
                                            <option value="351010">医疗保健设备与用品</option>
                                            <option value="351020">医疗保健提供商与服务</option>
                                            <option value="351030">医疗保健技术Ⅲ</option>
                                            <option value="352010">生物科技Ⅲ</option>
                                            <option value="352020">制药</option>
                                            <option value="352030">生命科学工具和服务Ⅲ</option>
                                            <option value="401010">商业银行</option>
                                            <option value="402010">多元金融服务</option>
                                            <option value="402030">资本市场</option>
                                            <option value="403010">保险Ⅲ</option>
                                            <option value="451010">互联网软件与服务Ⅲ</option>
                                            <option value="451020">信息技术服务</option>
                                            <option value="451030">软件</option>
                                            <option value="452010">通信设备Ⅲ</option>
                                            <option value="452020">电脑与外围设备</option>
                                            <option value="452030">电子设备、仪器和元件</option>
                                            <option value="453010">半导体产品与半导体设备</option>
                                            <option value="501010">多元电信服务</option>
                                            <option value="501020">无线电信业务Ⅲ</option>
                                            <option value="551010">电力Ⅲ</option>
                                            <option value="551020">燃气Ⅲ</option>
                                            <option value="551030">复合型公用事业Ⅲ</option>
                                            <option value="551040">水务Ⅲ</option>
                                            <option value="551050">独立电力生产商与能源贸易商Ⅲ</option>
                                            <option value="601020">房地产管理和开发</option>
                                        </datalist>
                                        <button id="submits3" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:20px;width:150px;height: 30px"
                                                data-toggle="tooltip"
                                                data-placement="right">添加比较项
                                        </button>
                                        <button id="clear3" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:10px;width:150px;height: 30px">清空比较列表
                                        </button>
                                    </div>
                                </div>
                                <ul id="myTabs3" class="am-nav nav-tabs">
                                    <li class="disabled">
                                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                                    </li>
                                    <li class="active"><a href="#charts3" data-toggle="tab">图表</a>
                                    </li>
                                    <li><a href="#tables3" data-toggle="tab">数据</a>
                                    </li>
                                </ul>
                                <div style="width:18%;height:300px;float:left;">
                                    <div id="myspan3" style="width:100%;height:80px;float:left;overflow-y :auto">
                                        <div id="div_compare3" style="overflow-y: auto"></div>
                                    </div>
                                    <div id="mychoices3"
                                         style="width:100%;height:220px;float:left;margin-top:0;overflow-y :auto">
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3" value="tot_oper_rev"
                                                              checked="checked"
                                                              id="thefirsts3">总营业收入</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3" value="net_profit_is">净利润总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3" value="wgsd_net_inc">股东利润和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3"
                                                              value="tot_assets">总资产总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3"
                                                              value="tot_liab">总负债总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3"
                                                              value="net_assets">净资产总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3" value="wgsd_com_eq">股东权益和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3"
                                                              value="operatecashflow_ttm2">经营性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3"
                                                              value="investcashflow_ttm2">投资性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3"
                                                              value="financecashflow_ttm2">融资性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3" value="cashflow_ttm2">总现金流</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton3" value="free_cash_flow">自由现金流</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="choices3" class="tab-content">
                                    <div class="tab-pane fade in active" id="charts3">
                                        <div id="mycharts3" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                    <div class="tab-pane fade" id="tables3">
                                        <div id="mytables3" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                </div>
                                <div style="float:right;width:80%;height:40px;margin-top:10px;border-radius:8px;background-color:#dcdcdc">
                                    <div style="float: left;margin-left:0;margin-top:10px">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c;">起始时间:</a><input size="10"
                                                                                                              type="text"
                                                                                                              value="1991-12-31"
                                                                                                              id="endtimes3"
                                                                                                              readonly
                                                                                                              class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">结束时间:</a><input size="10"
                                                                                                             type="text"
                                                                                                             value="2016-12-31"
                                                                                                             id="starttimes3"
                                                                                                             readonly
                                                                                                             class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">单位:</a>
                                        <select style="width:50px;height:26px;font-size: 10px;" id="units3">
                                            <option value="0" style="font-size: 10px;">亿</option>
                                            <option value="1" style="font-size: 10px;">千亿</option>
                                        </select>
                                    </div>
                                </div>

                                <script>
                                    $("#submits3").click(function () {
                                        thiscodes3 = $("#stockcodes3").val();
                                        var a3 = 1;
                                        for (var i = 0; i < codelists3.length; i++) {
                                            if (thiscodes3 == codelists3[i]) {
                                                alert('已添加，请勿重复添加！')
                                                a3 = 0
                                            }
                                        }
                                        if (a3) {
                                            codelists3.push(thiscodes3);
                                            colorlists3[thiscodes3] = NewColor();
                                            RequestCharts3(codelists3);
                                            creat_compares3(thiscodes3);
                                            RequestTables3(codelists3);
                                        }
                                    });
                                    $("#clear3").click(function () {
                                        codelists3 = [];
                                        $('#div_compare3').empty();
                                        $("#mytables3").empty();
                                        var myCharts3 = echarts.init(document.getElementById('mycharts3'));
                                        myCharts3.clear();
                                    });
                                </script>
                                <!--图表-->
                                <script>
                                    var myCharts3 = echarts.init(document.getElementById('mycharts3'));
                                    var cdict = {
                                        '101010': '能源设备与服务',
                                        '101020': '石油、天然气与供消费用燃料',
                                        '151010': '化工',
                                        '151020': '建材Ⅲ',
                                        '151030': '容器与包装',
                                        '151040': '金属、非金属与采矿',
                                        '151050': '纸与林木产品',
                                        '201010': '航空航天与国防Ⅲ',
                                        '201020': '建筑产品Ⅲ',
                                        '201030': '建筑与工程Ⅲ',
                                        '201040': '电气设备',
                                        '201050': '综合类Ⅲ',
                                        '201060': '机械',
                                        '201070': '贸易公司与工业品经销商Ⅲ ',
                                        '202010': '商业服务与用品',
                                        '202020': '专业服务',
                                        '203010': '航空货运与物流Ⅲ',
                                        '203020': '航空Ⅲ',
                                        '203030': '海运Ⅲ',
                                        '203040': '公路与铁路运输',
                                        '203050': '交通基础设施',
                                        '251010': '汽车零配件',
                                        '251020': '汽车',
                                        '252010': '家庭耐用消费品',
                                        '252020': '休闲设备与用品',
                                        '252030': '纺织品、服装与奢侈品',
                                        '253010': '酒店、餐馆与休闲Ⅲ',
                                        '253020': '综合消费者服务Ⅲ',
                                        '254010': '媒体Ⅲ',
                                        '255010': '消费品经销商Ⅲ',
                                        '255020': '互联网与售货目录零售',
                                        '255030': '多元化零售',
                                        '255040': '专营零售',
                                        '301010': '食品与主要用品零售Ⅲ',
                                        '302010': '饮料',
                                        '302020': '食品',
                                        '303010': '家庭用品Ⅲ',
                                        '303020': '个人用品Ⅲ ',
                                        '351010': '医疗保健设备与用品',
                                        '351020': '医疗保健提供商与服务',
                                        '351030': '医疗保健技术Ⅲ',
                                        '352010': '生物科技Ⅲ',
                                        '352020': '制药',
                                        '352030': '生命科学工具和服务Ⅲ',
                                        '401010': '商业银行',
                                        '402010': '多元金融服务',
                                        '402030': '资本市场',
                                        '403010': '保险Ⅲ',
                                        '451010': '互联网软件与服务Ⅲ',
                                        '451020': '信息技术服务',
                                        '451030': '软件',
                                        '452010': '通信设备Ⅲ',
                                        '452020': '电脑与外围设备',
                                        '452030': '电子设备、仪器和元件',
                                        '453010': '半导体产品与半导体设备',
                                        '501010': '多元电信服务',
                                        '501020': '无线电信业务Ⅲ',
                                        '551010': '电力Ⅲ',
                                        '551020': '燃气Ⅲ',
                                        '551030': '复合型公用事业Ⅲ ',
                                        '551040': '水务Ⅲ',
                                        '551050': '独立电力生产商与能源贸易商Ⅲ',
                                        '601020': '房地产管理和开发',
                                    };
                                    var Chosenindexe3 = new Array();
                                    Chosenindexe3 = ['tot_oper_rev'];
                                    var colorlists3 = {};
                                    var codelists3 = ['101010', '101020'];
                                    colorlists3['101010'] = '#000000';
                                    colorlists3['101020'] = '#028600';
                                    var market_results_ts3;
                                    var invest_results_ts3;

                                    dataSeries3 = []
                                    $.ajax({
                                        type: 'GET',
                                        url: '{{ url_for("restfulapi.market_status3") }}',
                                        data: {
                                            code: '101010',
                                            starttime: '19911231',
                                            endtime: '20161231',
                                            indexes: Chosenindexe3,
                                        },
                                        dataType: 'json',
                                        success: function (data) {
                                            $('#div_compare3').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists3[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                + data.the_code + "-" + cdict[data.the_code] + "</span></div>")
                                            for (var i = 0; i < data.indexes.length; i++) {
                                                temp = {
                                                    name: data.the_code,
                                                    type: 'bar',
                                                    itemStyle: {normal: {color: colorlists3[data.the_code]}},
                                                    symbolSize: 8,
                                                    smooth: true,
                                                    data: numfilters3(eval("data." + data.indexes[i])),
                                                };
                                                dataSeries3.push(temp);
                                            }
                                            $.ajax({
                                                type: 'GET',
                                                url: '{{ url_for("restfulapi.market_status3") }}',
                                                data: {
                                                    code: '101020',
                                                    starttime: '19911231',
                                                    endtime: '20161231',
                                                    indexes: Chosenindexe3,
                                                },
                                                dataType: 'json',
                                                success: function (data) {
                                                    $('#div_compare3').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists3[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                        + data.the_code + "-" + cdict[data.the_code] + "</span></div>")
                                                    for (var i = 0; i < data.indexes.length; i++) {
                                                        temp = {
                                                            name: data.the_code,
                                                            type: 'bar',
                                                            itemStyle: {normal: {color: colorlists3[data.the_code]}},
                                                            symbolSize: 8,
                                                            smooth: true,
                                                            data: numfilters3(eval("data." + data.indexes[i])),
                                                        };
                                                        dataSeries3.push(temp);
                                                    }
                                                    option = {
                                                        title: {
                                                            text: '财务指标分析图',
                                                            left: '45%'
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                return cdict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                            }
                                                        },
                                                        legend: {
                                                            data: [],
                                                            orient: 'vertical',
                                                            left: '85%',
                                                            top: '10%',
                                                            formatter: function (name) {
                                                                return cdict[name];
                                                            }
                                                        },
                                                        grid: {
                                                            left: '5%',
                                                            top: '10%',
                                                            containLabel: true
                                                        },
                                                        toolbox: {
                                                            feature: {
                                                                magicType: {
                                                                    type: ['line', 'bar']
                                                                }
                                                            }
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                            data: dateformat(data.the_year),
                                                            Interval: 5
                                                        },
                                                        yAxis: {
                                                            type: 'value',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                        },
                                                        dataZoom: [
                                                            {
                                                                type: 'slider',
                                                                xAxisIndex: [0],
                                                                startValue: "2016年Q4",
                                                                endValue: "1991年Q4",
                                                                filterMode: 'filter',
                                                            }
                                                        ],
                                                        series: dataSeries3
                                                    };
                                                    myCharts3.setOption(option, true);
                                                    myCharts3.on('datazoom', function (params) {
                                                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                        var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                        if (Math.ceil(1 - params.end / 100)) {
                                                            var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                        }
                                                        else {
                                                            var starts = '1991-12-31'
                                                        }
                                                        set_timepickers3(starts, ends)
                                                    });
                                                    function set_timepickers3(start, end) {
                                                        document.getElementById('endtimes3').value = start
                                                        document.getElementById('starttimes3').value = end
                                                    }
                                                }
                                            });
                                        }
                                    });
                                    CreateTables3(codelists3);

                                    function RequestCharts3(codelists3) {
                                        dataSeries = [];
                                        for (var k = 0; k < codelists3.length; k++) {
                                            $.ajax({
                                                type: 'GET',
                                                url: '{{ url_for("restfulapi.market_status3") }}',
                                                data: {
                                                    code: codelists3[k],
                                                    starttime: '19911231',
                                                    endtime: '20161231',
                                                    indexes: Chosenindexe3,
                                                },
                                                dataType: 'json',
                                                success: function (data) {
                                                    for (var i = 0; i < data.indexes.length; i++) {
                                                        temp = {
                                                            name: data.the_code,
                                                            type: 'bar',
                                                            itemStyle: {normal: {color: colorlists3[data.the_code]}},
                                                            symbolSize: 8,
                                                            smooth: true,
                                                            data: numfilters3(eval("data." + data.indexes[i])),
                                                        };
                                                        dataSeries.push(temp);
                                                    }
                                                    option = {
                                                        title: {
                                                            text: '财务指标分析图',
                                                            left: '45%'
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                return cdict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                            }
                                                        },
                                                        legend: {
                                                            data: [],
                                                            orient: 'vertical',
                                                            left: '85%',
                                                            top: '10%',
                                                            formatter: function (name) {
                                                                return cdict[name];
                                                            }
                                                        },
                                                        grid: {
                                                            left: '5%',
                                                            top: '10%',
                                                            containLabel: true
                                                        },
                                                        toolbox: {
                                                            feature: {
                                                                magicType: {
                                                                    type: ['line', 'bar']
                                                                }
                                                            }
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                            data: dateformat(data.the_year),
                                                            Interval: 5
                                                        },
                                                        yAxis: {
                                                            type: 'value',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                        },
                                                        dataZoom: [
                                                            {
                                                                type: 'slider',
                                                                xAxisIndex: [0],
                                                                startValue: "2016年Q4",
                                                                endValue: "1991年Q4",
                                                                filterMode: 'filter',
                                                            }
                                                        ],
                                                        series: dataSeries
                                                    };
                                                    myCharts3.setOption(option, true);
                                                    myCharts3.on('datazoom', function (params) {
                                                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                        var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                        if (Math.ceil(1 - params.end / 100)) {
                                                            var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                        }
                                                        else {
                                                            var starts = '1991-12-31'
                                                        }
                                                        set_timepickers3(starts, ends)
                                                    });
                                                    function set_timepickers3(start, end) {
                                                        document.getElementById('endtimes3').value = start
                                                        document.getElementById('starttimes3').value = end
                                                    }
                                                }
                                            })
                                        }
                                    }
                                    function creat_compares3(thiscodes3) {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status3") }}',
                                            data: {
                                                code: thiscodes3,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexe3,
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                $('#div_compare3').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists3[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                    + data.the_code + "-" + cdict[data.the_code] + "</span></div>")
                                            }
                                        });
                                    }
                                    function set_times3() {
                                        document.getElementById('endtimes3').value = "1991-12-31"
                                        document.getElementById('starttimes3').value = "2016-12-31"
                                    }
                                    function RequestTables3(codelists3) {
                                        var opt = myCharts3.getOption();
                                        var dz = opt.dataZoom[0];
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status3")}}',
                                            data: {
                                                code: '101010',
                                                starttime: opt.xAxis[0].data[dz.endValue],
                                                endtime: opt.xAxis[0].data[dz.startValue],
                                                indexes: Chosenindexe3
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                console.log(data)
                                                market_results_ts3 = data;
                                                $("#mytables3").empty();
                                                var table = $("<table id=\"temptables3\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                                table.appendTo($("#mytables3"));
                                                th = $("<thead></thead>");
                                                th.appendTo(table);
                                                var tr = $("<tr></tr>");
                                                tr.appendTo(th);
                                                var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                                                td.appendTo(tr);
                                                theyear = dateformat(market_results_ts3.the_year)
                                                for (var j = 0; j < theyear.length; j++) {
                                                    var td = $("<td>" + theyear[j] + "</td>");
                                                    td.appendTo(tr);
                                                }
                                                tb = $("<tbody></tbody>");
                                                tb.appendTo(table);
                                                $("#mytables3").append("</table>");
                                                var mydatatb = $('#temptables3').DataTable({
                                                    "info": false,
                                                    "processing": true,
                                                    "scrollX": true,
                                                    "searching": true,
                                                    "fixedColumns": { //固定列的配置项
                                                        "leftColumns": 1//固定左边第一列
                                                    },
                                                    "language": {
                                                        "emptyTable": "没有数据",
                                                        "loadingRecords": "加载中…",
                                                        "processing": "查询中…",
                                                        "search": "检索:",
                                                        "lengthMenu": "每页 _MENU_ 条",
                                                        "zeroRecords": "没有数据",
                                                        "paginate": {
                                                            "first": "第一页",
                                                            "last": "最后一页",
                                                            "next": "",
                                                            "previous": ""
                                                        },
                                                        "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                        "infoEmpty": "没有数据",
                                                        "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                                    }
                                                });
                                                setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                                for (var k = 0; k < codelists3.length; k++) {
                                                    $.ajax({
                                                        type: 'GET',
                                                        url: '{{url_for("restfulapi.market_status3")}}',
                                                        data: {
                                                            code: codelists3[k],
                                                            starttime: opt.xAxis[0].data[dz.endValue],
                                                            endtime: opt.xAxis[0].data[dz.startValue],
                                                            indexes: Chosenindexe3
                                                        },
                                                        dataType: 'json',
                                                        success: function (data) {
                                                            invest_results_ts3 = '';
                                                            invest_results_ts3 = data;
                                                            for (var i = 0; i < invest_results_ts3.indexes.length; i++) {
                                                                var rowNode = mydatatb
                                                                    .row.add([cdict[invest_results_ts3.the_code]].concat(numfilters3(eval("invest_results_ts3." + invest_results_ts3.indexes[i]))))
                                                                    .draw()
                                                                    .node();
                                                                $(rowNode)
                                                                    .attr('id', invest_results_ts3.the_code);
                                                                $(rowNode)
                                                                    .css('color', colorlists3[invest_results_ts3.the_code]);
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        });
                                    }
                                    function CreateTables3(codelists3) {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status3")}}',
                                            data: {
                                                code: '101010',
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexe3
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                console.log(data)
                                                market_results_ts3 = data;
                                                $("#mytables3").empty();
                                                var table = $("<table id=\"temptables3\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                                table.appendTo($("#mytables3"));
                                                th = $("<thead></thead>");
                                                th.appendTo(table);
                                                var tr = $("<tr></tr>");
                                                tr.appendTo(th);
                                                var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                                                td.appendTo(tr);
                                                theyear = dateformat(market_results_ts3.the_year)
                                                for (var j = 0; j < theyear.length; j++) {
                                                    var td = $("<td>" + theyear[j] + "</td>");
                                                    td.appendTo(tr);
                                                }
                                                tb = $("<tbody></tbody>");
                                                tb.appendTo(table);
                                                $("#mytables3").append("</table>");
                                                var mydatatb = $('#temptables3').DataTable({
                                                    "info": false,
                                                    "processing": true,
                                                    "scrollX": true,
                                                    "searching": true,
                                                    "fixedColumns": { //固定列的配置项
                                                        "leftColumns": 1//固定左边第一列
                                                    },
                                                    "language": {
                                                        "emptyTable": "没有数据",
                                                        "loadingRecords": "加载中…",
                                                        "processing": "查询中…",
                                                        "search": "检索:",
                                                        "lengthMenu": "每页 _MENU_ 条",
                                                        "zeroRecords": "没有数据",
                                                        "paginate": {
                                                            "first": "第一页",
                                                            "last": "最后一页",
                                                            "next": "",
                                                            "previous": ""
                                                        },
                                                        "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                        "infoEmpty": "没有数据",
                                                        "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                                    }
                                                });
                                                setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                                for (var k = 0; k < codelists3.length; k++) {
                                                    $.ajax({
                                                        type: 'GET',
                                                        url: '{{url_for("restfulapi.market_status3")}}',
                                                        data: {
                                                            code: codelists3[k],
                                                            starttime: '19911231',
                                                            endtime: '20161231',
                                                            indexes: Chosenindexe3
                                                        },
                                                        dataType: 'json',
                                                        success: function (data) {
                                                            invest_results_ts3 = '';
                                                            invest_results_ts3 = data;
                                                            for (var i = 0; i < invest_results_ts3.indexes.length; i++) {
                                                                var rowNode = mydatatb
                                                                    .row.add([cdict[invest_results_ts3.the_code]].concat(numfilters3(eval("invest_results_ts3." + invest_results_ts3.indexes[i]))))
                                                                    .draw()
                                                                    .node();
                                                                $(rowNode)
                                                                    .attr('id', invest_results_ts3.the_code);
                                                                $(rowNode)
                                                                    .css('color', colorlists3[invest_results_ts3.the_code]);
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        });
                                    }
                                </script>
                                <!--复选框操作-->
                                <script>
                                    $("div#mychoices3 :radio").change(function () {
                                        indexnames3 = $(this).val();
                                        if ($(this).is(':checked') == true) {
                                            console.log(this);
                                            Chosenindexe3 = [];
                                            Chosenindexe3.push(indexnames3);
                                            console.log(Chosenindexe3);
                                        }
                                        else {
                                            Chosenindexe3.remove(indexnames3);
                                            console.log(Chosenindexe3);
                                        }
                                        RequestCharts3(codelists3);
                                        RequestTables3(codelists3);
                                        set_times3();
                                    });
                                </script>
                                <!--时间控制框-->
                                <script>
                                    var starttimes3 = "19911231";
                                    var endtimes3 = "20161231";
                                    $(".form_datetime").datetimepicker({
                                        format: 'yyyy-mm-dd ',
                                        startView: 4,
                                        minView: 4,
                                        maxView: 4,
                                        autoclose: true,
                                        pickerPosition: 'top-right'
                                    });
                                    $('#starttimes3').datetimepicker('setStartDate', '1991-12-31');
                                    $('#starttimes3').datetimepicker('setEndDate', '2016-12-31');
                                    $('#endtimes3').datetimepicker('setStartDate', '1991-12-31');
                                    $('#endtimes3').datetimepicker('setEndDate', '2016-12-31');
                                    $('#starttimes3')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            starts = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].startValue = starts;
                                            myCharts3.setOption(option);
                                            RequestTables3(codelists3);
                                        });
                                    $('#endtimes3')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            ends = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].endValue = ends;
                                            myCharts3.setOption(option);
                                            RequestTables3(codelists3);
                                        });
                                    Date.prototype.Format = function (fmt) { //author: meizz
                                        var o = {
                                            "M+": this.getMonth() + 1, //月份
                                            "d+": this.getDate(), //日
                                            "h+": this.getHours(), //小时
                                            "m+": this.getMinutes(), //分
                                            "s+": this.getSeconds(), //秒
                                            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                                            "S": this.getMilliseconds() //毫秒
                                        };
                                        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 -
                                            RegExp.$1.length));
                                        for (var k in o)
                                            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length
                                            == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                                        return fmt;
                                    }
                                    function dateformat(olddate) {
                                        newdate = []
                                        for (i = 0; i < olddate.length; i++) {
                                            var str = olddate[i];
                                            var reg = /1231/g;
                                            str = str.replace(reg, '年Q4');
                                            newdate.push(str)
                                        }
                                        return newdate
                                    }
                                </script>
                                <!--单位转换-->
                                <script>
                                    denominators3 = 1
                                    $("select#units3").change(function () {
                                        flag = $(this).val();
                                        if (flag == "0") {
                                            denominators3 = 1;
                                            RequestCharts3(codelists3);
                                            RequestTables3(codelists3);
                                            set_times3();
                                        }
                                        if (flag == "1") {
                                            denominators3 = 1000;
                                            RequestCharts3(codelists3);
                                            RequestTables3(codelists3);
                                            set_times3();
                                        }
                                    });
                                    function numfilters3(oldnum) {
                                        newnum = []
                                        for (i = 0; i < oldnum.length; i++) {
                                            temp = oldnum[i] / denominators3;
                                            newnum.push(temp.toFixed(2))
                                        }
                                        return newnum;
                                    }
                                </script>
                                <!--面板切换-->
                                <script>
                                    $("#mydropdown").on("click", "[data-stopPropagation]", function (e) {
                                        e.stopPropagation();
                                    })
                                </script>
                                <!--随机生成颜色-->
                                <script>
                                    function NewColor() {
                                        var colorElements = "0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";
                                        var colorArray = colorElements.split(",");
                                        var color = "#";
                                        for (var i = 0; i < 6; i++) {
                                            color += colorArray[Math.floor(Math.random() * 16)];
                                        }
                                        return color;
                                    }
                                </script>
                                <!--删除函数-->
                                <script>
                                    Array.prototype.indexOf = function (val) {
                                        for (var i = 0; i < this.length; i++) {
                                            if (this[i] == val) return i;
                                        }
                                        return -1;
                                    };
                                    Array.prototype.remove = function (val) {
                                        var index = this.indexOf(val);
                                        if (index > -1) {
                                            this.splice(index, 1);
                                        }
                                    };
                                </script>
                            </div>
                        </div>
                    </div>
                </div>

                <!--子行业对比分析-->
                <div class="btn-box-row row-fluid">
                    <div class="module span12">
                        <div class="module-head">
                            <a href="#compare4" aria - expanded="false" data - toggle="collapse"> 子行业对比分析 </a>
                        </div>
                        <div class="modal-body">
                            <div id="compare4" style="margin: auto;width:95%;height:auto">
                                <div class="form-search" id="forms4">
                                    <div style="height:50px" class="input-group">
                                        <input id="stockcodes4" list="itemlists4" type="text"
                                               style="margin-top:0;margin-left:10px;height: 30px">
                                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                        <datalist id="itemlists4">
                                            <option value="10101010">石油天然气钻井</option>
                                            <option value="10101020">石油天然气设备与服务</option>
                                            <option value="10102010">综合性石油天然气</option>
                                            <option value="10102020">石油天然气勘探与生产</option>
                                            <option value="10102030">石油与天然气的炼制和销售</option>
                                            <option value="10102040">石油与天然气的储存和运输</option>
                                            <option value="10102050">煤炭与消费用燃料</option>
                                            <option value="15101010">基础化工</option>
                                            <option value="15101011">化纤</option>
                                            <option value="15101020">多元化工</option>
                                            <option value="15101030">化肥与农用化工</option>
                                            <option value="15101040">工业气体</option>
                                            <option value="15101050">特种化工</option>
                                            <option value="15102010">建材</option>
                                            <option value="15103010">金属与玻璃容器</option>
                                            <option value="15103020">纸包装</option>
                                            <option value="15104010">铝</option>
                                            <option value="15104020">金属非金属</option>
                                            <option value="15104030">黄金</option>
                                            <option value="15104040">贵金属与矿石</option>
                                            <option value="15104045">白银</option>
                                            <option value="15104050">钢铁</option>
                                            <option value="15105010">林木产品</option>
                                            <option value="15105020">纸制品</option>
                                            <option value="20101010">航天航空与国防</option>
                                            <option value="20102010">建筑产品</option>
                                            <option value="20103010">建筑与工程</option>
                                            <option value="20104010">电气部件与设备</option>
                                            <option value="20104020">重型电气设备</option>
                                            <option value="20105010">综合类行业</option>
                                            <option value="20106010">建筑机械与重型卡车</option>
                                            <option value="20106015">农用农业机械</option>
                                            <option value="20106020">工业机械</option>
                                            <option value="20107010">贸易公司与工业品经销商</option>
                                            <option value="20201010">商业印刷</option>
                                            <option value="20201050">环境与设施服务</option>
                                            <option value="20201060">办公服务与用品</option>
                                            <option value="20201070">综合支持服务</option>
                                            <option value="20202020">调查和咨询服务</option>
                                            <option value="20301010">航空货运与物流</option>
                                            <option value="20302010">航空</option>
                                            <option value="20303010">海运</option>
                                            <option value="20304010">铁路运输</option>
                                            <option value="20304020">公路运输</option>
                                            <option value="20305010">机场服务</option>
                                            <option value="20305020">公路与铁路</option>
                                            <option value="20305030">海港与服务</option>
                                            <option value="25101010">汽车零配件</option>
                                            <option value="25101020">轮胎与橡胶</option>
                                            <option value="25102010">汽车制造</option>
                                            <option value="25102020">摩托车制造</option>
                                            <option value="25201010">消费电子产品</option>
                                            <option value="25201020">家庭装饰品</option>
                                            <option value="25201030">住宅建筑</option>
                                            <option value="25201040">家用电器</option>
                                            <option value="25201050">家用器具与特殊消费品</option>
                                            <option value="25202010">休闲用品</option>
                                            <option value="25202020">摄影用品</option>
                                            <option value="25203010">服装、服饰与奢侈品</option>
                                            <option value="25203020">鞋类</option>
                                            <option value="25203030">纺织品</option>
                                            <option value="25301020">酒店、度假村与豪华游轮</option>
                                            <option value="25301030">休闲设施</option>
                                            <option value="25301040">餐馆</option>
                                            <option value="25302010">教育服务</option>
                                            <option value="25401010">广告</option>
                                            <option value="25401020">有线和卫星电视</option>
                                            <option value="25401030">电影与娱乐</option>
                                            <option value="25401040">出版</option>
                                            <option value="25501010">消费品经销商</option>
                                            <option value="25502010">售货目录零售</option>
                                            <option value="25502020">互联网零售</option>
                                            <option value="25503010">百货商店</option>
                                            <option value="25503020">综合货品商店</option>
                                            <option value="25504020">电脑与电子产品零售</option>
                                            <option value="25504040">专卖店</option>
                                            <option value="25504050">汽车零售</option>
                                            <option value="30101010">药品零售</option>
                                            <option value="30101020">食品分销商</option>
                                            <option value="30101030">食品零售</option>
                                            <option value="30101040">大卖场与超市</option>
                                            <option value="30201010">啤酒</option>
                                            <option value="30201020">白酒与葡萄酒</option>
                                            <option value="30201030">软饮料</option>
                                            <option value="30201010">农产品</option>
                                            <option value="30201030">食品加工与肉类</option>
                                            <option value="30301010">家庭用品</option>
                                            <option value="30302010">个人用品</option>
                                            <option value="35101010">医疗保健设备</option>
                                            <option value="35101020">医疗保健用品</option>
                                            <option value="35102015">保健护理服务</option>
                                            <option value="35102020">保健护理设施</option>
                                            <option value="35103010">医疗保健技术</option>
                                            <option value="35201010">生物科技</option>
                                            <option value="35202010">西药</option>
                                            <option value="35202011">中药</option>
                                            <option value="35203010">生命科学工具和服务</option>
                                            <option value="40101010">多元化银行</option>
                                            <option value="40101015">区域性银行</option>
                                            <option value="40201020">其他多元金融服务</option>
                                            <option value="40201030">多领域控股</option>
                                            <option value="40203010">资产管理与托管银行</option>
                                            <option value="40203020">投资银行业与经纪业</option>
                                            <option value="40203030">多元资本市场</option>
                                            <option value="40301020">人寿与健康保险</option>
                                            <option value="40301030">多元化保险</option>
                                            <option value="40301040">财产与意外伤害保险</option>
                                            <option value="45101010">互联网软件与服务</option>
                                            <option value="45102010">信息科技咨询与其它服务</option>
                                            <option value="45102020">数据处理与外包服务</option>
                                            <option value="45103010">应用软件</option>
                                            <option value="45103020">系统软件</option>
                                            <option value="45103030">家庭娱乐软件</option>
                                            <option value="45201020">通信设备</option>
                                            <option value="45202010">电脑硬件</option>
                                            <option value="45202020">电脑存储与外围设备</option>
                                            <option value="45203010">电子元件</option>
                                            <option value="45203015">电子设备和仪器</option>
                                            <option value="45203020">电子制造服务</option>
                                            <option value="45303030">技术产品经销商</option>
                                            <option value="45301010">半导体设备</option>
                                            <option value="45301020">半导体产品</option>
                                            <option value="50101010">非传统电信运营商</option>
                                            <option value="50101020">综合电信服务</option>
                                            <option value="50102010">无线电信业务</option>
                                            <option value="55101010">电力</option>
                                            <option value="55102010">燃气</option>
                                            <option value="55103010">复合型公用事业</option>
                                            <option value="55104010">水务</option>
                                            <option value="55105010">独立电力生产商与能源贸易商</option>
                                            <option value="55105020">新能源发电业者</option>
                                            <option value="60102020">房地产经营公司</option>
                                            <option value="60102030">房地产开发</option>
                                            <option value="60102040">房地产服务</option>
                                        </datalist>
                                        <button id="submits4" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:20px;width:150px;height: 30px"
                                                data-toggle="tooltip"
                                                data-placement="right">添加比较项
                                        </button>
                                        <button id="clear4" type="submit" class="btn btn-default"
                                                style="margin-top:0;margin-left:10px;width:150px;height: 30px">清空比较列表
                                        </button>
                                    </div>
                                </div>
                                <ul id="myTabs4" class="am-nav nav-tabs">
                                    <li class="disabled">
                                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                                    </li>
                                    <li class="active"><a href="#charts4" data-toggle="tab">图表</a>
                                    </li>
                                    <li><a href="#tables4" data-toggle="tab">数据</a>
                                    </li>
                                </ul>
                                <div style="width:18%;height:300px;float:left;">
                                    <div id="myspan4" style="width:100%;height:80px;float:left;overflow-y :auto">
                                        <div id="div_compare4" style="overflow-y: auto"></div>
                                    </div>
                                    <div id="mychoices4"
                                         style="width:100%;height:220px;float:left;margin-top:0;overflow-y :auto">
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4" value="tot_oper_rev"
                                                              checked="checked"
                                                              id="thefirsts4">总营业收入</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4" value="net_profit_is">净利润总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4" value="wgsd_net_inc">股东利润和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4"
                                                              value="tot_assets">总资产总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4"
                                                              value="tot_liab">总负债总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4"
                                                              value="net_assets">净资产总和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4" value="wgsd_com_eq">股东权益和</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4"
                                                              value="operatecashflow_ttm2">经营性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4"
                                                              value="investcashflow_ttm2">投资性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4"
                                                              value="financecashflow_ttm2">融资性现金</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4" value="cashflow_ttm2">总现金流</label>
                                            </div>
                                        </div>
                                        <div class="thediv"
                                             style="width:100%;height:30px;margin-top:10px;border-radius:20px;">
                                            <div class="radio"
                                                 style="width:60%;height:20px;float:left;margin-top:10px;margin-left:5px">
                                                <label><input type="radio" name="radiobutton4" value="free_cash_flow">自由现金流</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="choices4" class="tab-content">
                                    <div class="tab-pane fade in active" id="charts4">
                                        <div id="mycharts4" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                    <div class="tab-pane fade" id="tables4">
                                        <div id="mytables4" style="width:100%;height:250px;float:right"></div>
                                    </div>
                                </div>
                                <div style="float:right;width:80%;height:40px;margin-top:10px;border-radius:8px;background-color:#dcdcdc">
                                    <div style="float: left;margin-left:0;margin-top:10px">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c;">起始时间:</a><input size="10"
                                                                                                              type="text"
                                                                                                              value="1991-12-31"
                                                                                                              id="endtimes4"
                                                                                                              readonly
                                                                                                              class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">结束时间:</a><input size="10"
                                                                                                             type="text"
                                                                                                             value="2016-12-31"
                                                                                                             id="starttimes4"
                                                                                                             readonly
                                                                                                             class="form_datetime">
                                        <a style="width:20px;margin-left:5px;color: #0c0c0c">单位:</a>
                                        <select style="width:50px;height:26px;font-size: 10px;" id="units4">
                                            <option value="0" style="font-size: 10px;">亿</option>
                                            <option value="1" style="font-size: 10px;">千亿</option>
                                        </select>
                                    </div>
                                </div>

                                <script>
                                    $("#submits4").click(function () {
                                        thiscodes4 = $("#stockcodes4").val();
                                        var a4 = 1;
                                        for (var i = 0; i < codelists4.length; i++) {
                                            if (thiscodes4 == codelists4[i]) {
                                                alert('已添加，请勿重复添加！')
                                                a4 = 0
                                            }
                                        }
                                        if (a4) {
                                            codelists4.push(thiscodes4);
                                            colorlists4[thiscodes4] = NewColor();
                                            RequestCharts4(codelists4);
                                            creat_compares4(thiscodes4);
                                            RequestTables4(codelists4);
                                        }
                                    });
                                    $("#clear4").click(function () {
                                        codelists4 = [];
                                        $('#div_compare4').empty();
                                        $("#mytables4").empty();
                                        var myCharts4 = echarts.init(document.getElementById('mycharts4'));
                                        myCharts4.clear();
                                    });
                                </script>
                                <!--图表-->
                                <script>
                                    var myCharts4 = echarts.init(document.getElementById('mycharts4'));
                                    var ddict = {
                                        '10101010': '石油天然气钻井',
                                        '10101020': '石油天然气设备与服务',
                                        '10102010': '综合性石油天然气',
                                        '10102020': '石油天然气勘探与生产',
                                        '10102030': '石油与天然气的炼制和销售',
                                        '10102040': '石油与天然气的储存和运输',
                                        '10102050': '煤炭与消费用燃料',
                                        '15101010': '基础化工',
                                        '15101011': '化纤',
                                        '15101020': '多元化工',
                                        '15101030': '化肥与农用化工',
                                        '15101040': '工业气体',
                                        '15101050': '特种化工',
                                        '15102010': '建材 ',
                                        '15103010': '金属与玻璃容器',
                                        '15103020': '纸包装',
                                        '15104010': '铝',
                                        '15104020': '金属非金属',
                                        '15104030': '黄金',
                                        '15104040': '贵金属与矿石',
                                        '15104045': '白银',
                                        '15104050': '钢铁',
                                        '15105010': '林木产品',
                                        '15105020': '纸制品',
                                        '20101010': '航天航空与国防',
                                        '20102010': '建筑产品',
                                        '20103010': '建筑与工程',
                                        '20104010': '电气部件与设备',
                                        '20104020': '重型电气设备',
                                        '20105010': '综合类行业',
                                        '20106010': '建筑机械与重型卡车',
                                        '20106015': '农用农业机械',
                                        '20106020': '工业机械',
                                        '20107010': '贸易公司与工业品经销商',
                                        '20201070': '综合支持服务',
                                        '20202020': '调查和咨询服务',
                                        '20301010': '航空货运与物流',
                                        '20302010': '航空 ',
                                        '20303010': '海运',
                                        '20304010': '铁路运输',
                                        '20304020': '公路运输',
                                        '20305010': '机场服务',
                                        '20305020': '公路与铁路',
                                        '20305030': '海港与服务',
                                        '25101010': '汽车零配件',
                                        '25101020': '轮胎与橡胶',
                                        '25102010': '汽车制造',
                                        '25102020': '摩托车制造',
                                        '25201010': '消费电子产品',
                                        '25201020': '家庭装饰品',
                                        '25201030': '住宅建筑',
                                        '25201040': '家用电器',
                                        '25201050': '家用器具与特殊消费品',
                                        '25202010': '休闲用品',
                                        '25202020': '摄影用品',
                                        '25203010': '服装、服饰与奢侈品',
                                        '25203020': '鞋类',
                                        '25203030': '纺织品',
                                        '25301020': '酒店、度假村与豪华游轮',
                                        '25301030': '休闲设施',
                                        '25301040': '餐馆',
                                        '25302010': '教育服务',
                                        '25401010': '广告',
                                        '25401020': '有线和卫星电视',
                                        '25401030': '电影与娱乐',
                                        '25401040': '出版',
                                        '25501010': '消费品经销商',
                                        '25502010': '售货目录零售',
                                        '25502020': '互联网零售',
                                        '25503010': '百货商店',
                                        '25503020': '综合货品商店',
                                        '25504020': '电脑与电子产品零售',
                                        '25504030': '专卖店',
                                        '25504050': '汽车零售',
                                        '30101010': '药品零售',
                                        '30101020': '食品分销商',
                                        '30101030': '食品零售',
                                        '30101040': '大卖场与超市',
                                        '30201010': '啤酒',
                                        '30201020': '白酒与葡萄酒',
                                        '30201030': '软饮料',
                                        '30202010': '农产品',
                                        '30202030': '食品加工与肉类',
                                        '30301010': '家庭用品',
                                        '30302010': '个人用品',
                                        '35101010': '医疗保健设备',
                                        '35101020': '医疗保健用品',
                                        '35102015': '保健护理服务',
                                        '35102020': '保健护理设施',
                                        '35103010': '医疗保健技术',
                                        '35201010': '生物科技',
                                        '35202010': '西药',
                                        '35202011': '中药',
                                        '35203010': '生命科学工具和服务',
                                        '40101010': '多元化银行',
                                        '40101015': '区域性银行',
                                        '40201020': '其他多元金融服务',
                                        '40201030': '多领域控股',
                                        '40203010': '资产管理与托管银行',
                                        '40203020': '投资银行业与经纪业',
                                        '40203030': '多元资本市场',
                                        '40301020': '人寿与健康保险',
                                        '40301030': '多元化保险',
                                        '40301040': '财产与意外伤害保险',
                                        '45101010': '互联网软件与服务',
                                        '45102010': '信息科技咨询与其它服务',
                                        '45102020': '数据处理与外包服务',
                                        '45103010': '应用软件',
                                        '45103020': '系统软件',
                                        '45103030': '家庭娱乐软件',
                                        '45202010': '通信设备',
                                        '45201020': '电脑硬件',
                                        '45202020': '电脑存储与外围设备',
                                        '45203010': '电子元件',
                                        '45203015': '电子设备和仪器',
                                        '45203020': '电子制造服务',
                                        '45303030': '技术产品经销商',
                                        '45301010': '半导体设备',
                                        '45301020': '半导体产品',
                                        '50101010': '非传统电信运营商',
                                        '50101020': '综合电信服务',
                                        '50102010': '无线电信业务',
                                        '55101010': '电力',
                                        '55102010': '燃气',
                                        '55103010': '复合型公用事业',
                                        '55104010': '水务',
                                        '55105010': '独立电力生产商与能源贸易商',
                                        '55105020': '新能源发电业者',
                                        '60102020': '房地产经营公司',
                                        '60102030': '房地产开发',
                                        '60102040': '房地产服务',
                                    };
                                    var Chosenindexe4 = new Array();
                                    Chosenindexe4 = ['tot_oper_rev'];
                                    var colorlists4 = {};
                                    var codelists4 = ['10101010', '10101020'];
                                    colorlists4['10101010'] = '#000000';
                                    colorlists4['10101020'] = '#028600';
                                    var market_results_ts4;
                                    var invest_results_ts4;

                                    dataSeries4 = []
                                    $.ajax({
                                        type: 'GET',
                                        url: '{{ url_for("restfulapi.market_status4") }}',
                                        data: {
                                            code: '10101010',
                                            starttime: '19911231',
                                            endtime: '20161231',
                                            indexes: Chosenindexe4,
                                        },
                                        dataType: 'json',
                                        success: function (data) {
                                            $('#div_compare4').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists4[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                + data.the_code + "-" + ddict[data.the_code] + "</span></div>")
                                            for (var i = 0; i < data.indexes.length; i++) {
                                                temp = {
                                                    name: data.the_code,
                                                    type: 'bar',
                                                    itemStyle: {normal: {color: colorlists4[data.the_code]}},
                                                    symbolSize: 8,
                                                    smooth: true,
                                                    data: numfilters4(eval("data." + data.indexes[i])),
                                                };
                                                dataSeries4.push(temp);
                                            }
                                            $.ajax({
                                                type: 'GET',
                                                url: '{{ url_for("restfulapi.market_status4") }}',
                                                data: {
                                                    code: '10101020',
                                                    starttime: '19911231',
                                                    endtime: '20161231',
                                                    indexes: Chosenindexe4,
                                                },
                                                dataType: 'json',
                                                success: function (data) {
                                                    $('#div_compare4').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists4[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                        + data.the_code + "-" + ddict[data.the_code] + "</span></div>")
                                                    for (var i = 0; i < data.indexes.length; i++) {
                                                        temp = {
                                                            name: data.the_code,
                                                            type: 'bar',
                                                            itemStyle: {normal: {color: colorlists4[data.the_code]}},
                                                            symbolSize: 8,
                                                            smooth: true,
                                                            data: numfilters4(eval("data." + data.indexes[i])),
                                                        };
                                                        dataSeries4.push(temp);
                                                    }
                                                    option = {
                                                        title: {
                                                            text: '财务指标分析图',
                                                            left: '45%'
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                return ddict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                            }
                                                        },
                                                        legend: {
                                                            data: [],
                                                            orient: 'vertical',
                                                            left: '85%',
                                                            top: '10%',
                                                            formatter: function (name) {
                                                                return ddict[name];
                                                            }
                                                        },
                                                        grid: {
                                                            left: '5%',
                                                            top: '10%',
                                                            containLabel: true
                                                        },
                                                        toolbox: {
                                                            feature: {
                                                                magicType: {
                                                                    type: ['line', 'bar']
                                                                }
                                                            }
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                            data: dateformat(data.the_year),
                                                            Interval: 5
                                                        },
                                                        yAxis: {
                                                            type: 'value',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                        },
                                                        dataZoom: [
                                                            {
                                                                type: 'slider',
                                                                xAxisIndex: [0],
                                                                startValue: "2016年Q4",
                                                                endValue: "1991年Q4",
                                                                filterMode: 'filter',
                                                            }
                                                        ],
                                                        series: dataSeries4
                                                    };
                                                    myCharts4.setOption(option, true);
                                                    myCharts4.on('datazoom', function (params) {
                                                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                        var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                        if (Math.ceil(1 - params.end / 100)) {
                                                            var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                        }
                                                        else {
                                                            var starts = '1991-12-31'
                                                        }
                                                        set_timepickers4(starts, ends)
                                                    });
                                                    function set_timepickers4(start, end) {
                                                        document.getElementById('endtimes4').value = start
                                                        document.getElementById('starttimes4').value = end
                                                    }
                                                }
                                            });
                                        }
                                    });
                                    CreateTables4(codelists4);

                                    function RequestCharts4(codelists4) {
                                        dataSeries = [];
                                        for (var k = 0; k < codelists4.length; k++) {
                                            $.ajax({
                                                type: 'GET',
                                                url: '{{ url_for("restfulapi.market_status4") }}',
                                                data: {
                                                    code: codelists4[k],
                                                    starttime: '19911231',
                                                    endtime: '20161231',
                                                    indexes: Chosenindexe4,
                                                },
                                                dataType: 'json',
                                                success: function (data) {
                                                    for (var i = 0; i < data.indexes.length; i++) {
                                                        temp = {
                                                            name: data.the_code,
                                                            type: 'bar',
                                                            itemStyle: {normal: {color: colorlists4[data.the_code]}},
                                                            symbolSize: 8,
                                                            smooth: true,
                                                            data: numfilters4(eval("data." + data.indexes[i])),
                                                        };
                                                        dataSeries.push(temp);
                                                    }
                                                    option = {
                                                        title: {
                                                            text: '财务指标分析图',
                                                            left: '45%'
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                return ddict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                                            }
                                                        },
                                                        legend: {
                                                            data: [],
                                                            orient: 'vertical',
                                                            left: '85%',
                                                            top: '10%',
                                                            formatter: function (name) {
                                                                return ddict[name];
                                                            }
                                                        },
                                                        grid: {
                                                            left: '5%',
                                                            top: '10%',
                                                            containLabel: true
                                                        },
                                                        toolbox: {
                                                            feature: {
                                                                magicType: {
                                                                    type: ['line', 'bar']
                                                                }
                                                            }
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                            data: dateformat(data.the_year),
                                                            Interval: 5
                                                        },
                                                        yAxis: {
                                                            type: 'value',
                                                            axisTick: {
                                                                show: false
                                                            },
                                                        },
                                                        dataZoom: [
                                                            {
                                                                type: 'slider',
                                                                xAxisIndex: [0],
                                                                startValue: "2016年Q4",
                                                                endValue: "1991年Q4",
                                                                filterMode: 'filter',
                                                            }
                                                        ],
                                                        series: dataSeries
                                                    };
                                                    myCharts4.setOption(option, true);
                                                    myCharts4.on('datazoom', function (params) {
                                                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                                        var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                                        if (Math.ceil(1 - params.end / 100)) {
                                                            var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                                        }
                                                        else {
                                                            var starts = '1991-12-31'
                                                        }
                                                        set_timepickers4(starts, ends)
                                                    });
                                                    function set_timepickers4(start, end) {
                                                        document.getElementById('endtimes4').value = start
                                                        document.getElementById('starttimes4').value = end
                                                    }
                                                }
                                            })
                                        }
                                    }
                                    function creat_compares4(thiscodes4) {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{ url_for("restfulapi.market_status4") }}',
                                            data: {
                                                code: thiscodes4,
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexe4,
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                $('#div_compare4').append("<div class='thedivs' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlists4[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                                    + data.the_code + "-" + ddict[data.the_code] + "</span></div>")
                                            }
                                        });
                                    }
                                    function set_times4() {
                                        document.getElementById('endtimes4').value = "1991-12-31"
                                        document.getElementById('starttimes4').value = "2016-12-31"
                                    }
                                    function RequestTables4(codelists4) {
                                        var opt = myCharts4.getOption();
                                        var dz = opt.dataZoom[0];
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status4")}}',
                                            data: {
                                                code: '10101010',
                                                starttime: opt.xAxis[0].data[dz.endValue],
                                                endtime: opt.xAxis[0].data[dz.startValue],
                                                indexes: Chosenindexe4
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                console.log(data)
                                                market_results_ts4 = data;
                                                $("#mytables4").empty();
                                                var table = $("<table id=\"temptables4\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                                table.appendTo($("#mytables4"));
                                                th = $("<thead></thead>");
                                                th.appendTo(table);
                                                var tr = $("<tr></tr>");
                                                tr.appendTo(th);
                                                var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                                                td.appendTo(tr);
                                                theyear = dateformat(market_results_ts4.the_year)
                                                for (var j = 0; j < theyear.length; j++) {
                                                    var td = $("<td>" + theyear[j] + "</td>");
                                                    td.appendTo(tr);
                                                }
                                                tb = $("<tbody></tbody>");
                                                tb.appendTo(table);
                                                $("#mytables4").append("</table>");
                                                var mydatatb = $('#temptables4').DataTable({
                                                    "info": false,
                                                    "processing": true,
                                                    "scrollX": true,
                                                    "searching": true,
                                                    "fixedColumns": { //固定列的配置项
                                                        "leftColumns": 1//固定左边第一列
                                                    },
                                                    "language": {
                                                        "emptyTable": "没有数据",
                                                        "loadingRecords": "加载中…",
                                                        "processing": "查询中…",
                                                        "search": "检索:",
                                                        "lengthMenu": "每页 _MENU_ 条",
                                                        "zeroRecords": "没有数据",
                                                        "paginate": {
                                                            "first": "第一页",
                                                            "last": "最后一页",
                                                            "next": "",
                                                            "previous": ""
                                                        },
                                                        "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                        "infoEmpty": "没有数据",
                                                        "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                                    }
                                                });
                                                setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                                for (var k = 0; k < codelists4.length; k++) {
                                                    $.ajax({
                                                        type: 'GET',
                                                        url: '{{url_for("restfulapi.market_status4")}}',
                                                        data: {
                                                            code: codelists4[k],
                                                            starttime: opt.xAxis[0].data[dz.endValue],
                                                            endtime: opt.xAxis[0].data[dz.startValue],
                                                            indexes: Chosenindexe4
                                                        },
                                                        dataType: 'json',
                                                        success: function (data) {
                                                            invest_results_ts4 = '';
                                                            invest_results_ts4 = data;
                                                            for (var i = 0; i < invest_results_ts4.indexes.length; i++) {
                                                                var rowNode = mydatatb
                                                                    .row.add([ddict[invest_results_ts4.the_code]].concat(numfilters4(eval("invest_results_ts4." + invest_results_ts4.indexes[i]))))
                                                                    .draw()
                                                                    .node();
                                                                $(rowNode)
                                                                    .attr('id', invest_results_ts4.the_code);
                                                                $(rowNode)
                                                                    .css('color', colorlists4[invest_results_ts4.the_code]);
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        });
                                    }
                                    function CreateTables4(codelists4) {
                                        $.ajax({
                                            type: 'GET',
                                            url: '{{url_for("restfulapi.market_status4")}}',
                                            data: {
                                                code: '10101010',
                                                starttime: '19911231',
                                                endtime: '20161231',
                                                indexes: Chosenindexe4
                                            },
                                            dataType: 'json',
                                            success: function (data) {
                                                console.log(data)
                                                market_results_ts4 = data;
                                                $("#mytables4").empty();
                                                var table = $("<table id=\"temptables4\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                                                table.appendTo($("#mytables4"));
                                                th = $("<thead></thead>");
                                                th.appendTo(table);
                                                var tr = $("<tr></tr>");
                                                tr.appendTo(th);
                                                var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                                                td.appendTo(tr);
                                                theyear = dateformat(market_results_ts4.the_year)
                                                for (var j = 0; j < theyear.length; j++) {
                                                    var td = $("<td>" + theyear[j] + "</td>");
                                                    td.appendTo(tr);
                                                }
                                                tb = $("<tbody></tbody>");
                                                tb.appendTo(table);
                                                $("#mytables4").append("</table>");
                                                var mydatatb = $('#temptables4').DataTable({
                                                    "info": false,
                                                    "processing": true,
                                                    "scrollX": true,
                                                    "searching": true,
                                                    "fixedColumns": { //固定列的配置项
                                                        "leftColumns": 1//固定左边第一列
                                                    },
                                                    "language": {
                                                        "emptyTable": "没有数据",
                                                        "loadingRecords": "加载中…",
                                                        "processing": "查询中…",
                                                        "search": "检索:",
                                                        "lengthMenu": "每页 _MENU_ 条",
                                                        "zeroRecords": "没有数据",
                                                        "paginate": {
                                                            "first": "第一页",
                                                            "last": "最后一页",
                                                            "next": "",
                                                            "previous": ""
                                                        },
                                                        "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                                        "infoEmpty": "没有数据",
                                                        "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                                    }
                                                });
                                                setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                                                for (var k = 0; k < codelists4.length; k++) {
                                                    $.ajax({
                                                        type: 'GET',
                                                        url: '{{url_for("restfulapi.market_status4")}}',
                                                        data: {
                                                            code: codelists4[k],
                                                            starttime: '19911231',
                                                            endtime: '20161231',
                                                            indexes: Chosenindexe4
                                                        },
                                                        dataType: 'json',
                                                        success: function (data) {
                                                            invest_results_ts4 = '';
                                                            invest_results_ts4 = data;
                                                            for (var i = 0; i < invest_results_ts4.indexes.length; i++) {
                                                                var rowNode = mydatatb
                                                                    .row.add([ddict[invest_results_ts4.the_code]].concat(numfilters4(eval("invest_results_ts4." + invest_results_ts4.indexes[i]))))
                                                                    .draw()
                                                                    .node();
                                                                $(rowNode)
                                                                    .attr('id', invest_results_ts4.the_code);
                                                                $(rowNode)
                                                                    .css('color', colorlists4[invest_results_ts4.the_code]);
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        });
                                    }
                                </script>
                                <!--复选框操作-->
                                <script>
                                    $("div#mychoices4 :radio").change(function () {
                                        indexnames4 = $(this).val();
                                        if ($(this).is(':checked') == true) {
                                            console.log(this);
                                            Chosenindexe4 = [];
                                            Chosenindexe4.push(indexnames4);
                                            console.log(Chosenindexe4);
                                        }
                                        else {
                                            Chosenindexe4.remove(indexnames4);
                                            console.log(Chosenindexe4);
                                        }
                                        RequestCharts4(codelists4);
                                        RequestTables4(codelists4);
                                        set_times4();
                                    });
                                </script>
                                <!--时间控制框-->
                                <script>
                                    var starttimes4 = "19911231";
                                    var endtimes4 = "20161231";
                                    $(".form_datetime").datetimepicker({
                                        format: 'yyyy-mm-dd ',
                                        startView: 4,
                                        minView: 4,
                                        maxView: 4,
                                        autoclose: true,
                                        pickerPosition: 'top-right'
                                    });
                                    $('#starttimes4').datetimepicker('setStartDate', '1991-12-31');
                                    $('#starttimes4').datetimepicker('setEndDate', '2016-12-31');
                                    $('#endtimes4').datetimepicker('setStartDate', '1991-12-31');
                                    $('#endtimes4').datetimepicker('setEndDate', '2016-12-31');
                                    $('#starttimes4')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            starts = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].startValue = starts;
                                            myCharts4.setOption(option);
                                            RequestTables4(codelists4);
                                        });
                                    $('#endtimes4')
                                        .datetimepicker()
                                        .on('changeDate', function (ev) {
                                            ends = ev.date.Format("yyyy年Q4");
                                            option.dataZoom[0].endValue = ends;
                                            myCharts4.setOption(option);
                                            RequestTables4(codelists4);
                                        });
                                    Date.prototype.Format = function (fmt) { //author: meizz
                                        var o = {
                                            "M+": this.getMonth() + 1, //月份
                                            "d+": this.getDate(), //日
                                            "h+": this.getHours(), //小时
                                            "m+": this.getMinutes(), //分
                                            "s+": this.getSeconds(), //秒
                                            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                                            "S": this.getMilliseconds() //毫秒
                                        };
                                        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 -
                                            RegExp.$1.length));
                                        for (var k in o)
                                            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length
                                            == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                                        return fmt;
                                    }
                                    function dateformat(olddate) {
                                        newdate = []
                                        for (i = 0; i < olddate.length; i++) {
                                            var str = olddate[i];
                                            var reg = /1231/g;
                                            str = str.replace(reg, '年Q4');
                                            newdate.push(str)
                                        }
                                        return newdate
                                    }
                                </script>
                                <!--单位转换-->
                                <script>
                                    denominators4 = 1
                                    $("select#units4").change(function () {
                                        flag = $(this).val();
                                        if (flag == "0") {
                                            denominators4 = 1;
                                            RequestCharts4(codelists4);
                                            RequestTables4(codelists4);
                                            set_times4();
                                        }
                                        if (flag == "1") {
                                            denominators4 = 1000;
                                            RequestCharts4(codelists4);
                                            RequestTables4(codelists4);
                                            set_times4();
                                        }
                                    });
                                    function numfilters4(oldnum) {
                                        newnum = []
                                        for (i = 0; i < oldnum.length; i++) {
                                            temp = oldnum[i] / denominators4;
                                            newnum.push(temp.toFixed(2))
                                        }
                                        return newnum;
                                    }
                                </script>
                                <!--面板切换-->
                                <script>
                                    $("#mydropdown").on("click", "[data-stopPropagation]", function (e) {
                                        e.stopPropagation();
                                    })
                                </script>
                                <!--随机生成颜色-->
                                <script>
                                    function NewColor() {
                                        var colorElements = "0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";
                                        var colorArray = colorElements.split(",");
                                        var color = "#";
                                        for (var i = 0; i < 6; i++) {
                                            color += colorArray[Math.floor(Math.random() * 16)];
                                        }
                                        return color;
                                    }
                                </script>
                                <!--删除函数-->
                                <script>
                                    Array.prototype.indexOf = function (val) {
                                        for (var i = 0; i < this.length; i++) {
                                            if (this[i] == val) return i;
                                        }
                                        return -1;
                                    };
                                    Array.prototype.remove = function (val) {
                                        var index = this.indexOf(val);
                                        if (index > -1) {
                                            this.splice(index, 1);
                                        }
                                    };
                                </script>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    </div>
    <script>
        var province = '辽宁'
        $("#province_selected").text('当前选中:' + province)
        function creatmap() {
            var myChart = echarts.init(document.getElementById('map'));
            var option1 = {
                title: {
                    text: '',
                    subtext: '',
                    x: 'center'
                },
                tooltip: {//提示框组件。
                    trigger: 'item'//数据项图形触发，主要在散点图，饼图等无类目轴的图表中使用。
                },
                legend: {
                    orient: 'horizontal',//图例的排列方向
                    x: 'left',//图例的位置
                    {#            data:['订单量']#}
                },
                toolbox: {//工具栏
                    show: true,
                    orient: 'vertical',//工具栏 icon 的布局朝向
                    x: 'right',
                    y: 'center',
                    feature: {//各工具配置项。
                        mark: {show: true},
                        dataView: {show: true, readOnly: false},//数据视图工具，可以展现当前图表所用的数据，编辑后可以动态更新。
                        restore: {show: true},//配置项还原。
                        saveAsImage: {show: true}//保存为图片。
                    }
                },
                roamController: {//控制地图的上下左右放大缩小 图上没有显示
                    show: true,
                    x: 'right',
                    mapTypeControl: {
                        'china': true
                    }
                },
                series: [
                    {
                        {#                name: '订单量',#}
                        type: 'map',
                        mapType: 'china',
                        roam: false,//是否开启鼠标缩放和平移漫游
                        itemStyle: {//地图区域的多边形 图形样式
                            normal: {//是图形在默认状态下的样式
                                label: {
                                    show: true,//是否显示标签
                                    textStyle: {
                                        color: "rgb(249, 249, 249)"
                                    }
                                }
                            },
                            emphasis: {//是图形在高亮状态下的样式,比如在鼠标悬浮或者图例联动高亮时
                                label: {show: true}
                            }
                        },
                        top: "3%",//组件距离容器的距离
                        data: [
                            {name: '北京'},
                            {name: '天津'},
                            {name: '上海'},
                            {name: '重庆'},
                            {name: '河北'},
                            {name: '河南'},
                            {name: '云南'},
                            {name: '辽宁'},
                            {name: '黑龙江'},
                            {name: '湖南'},
                            {name: '安徽'},
                            {name: '山东'},
                            {name: '新疆'},
                            {name: '江苏'},
                            {name: '浙江'},
                            {name: '江西'},
                            {name: '湖北'},
                            {name: '广西'},
                            {name: '甘肃'},
                            {name: '山西'},
                            {name: '内蒙古'},
                            {name: '陕西'},
                            {name: '吉林'},
                            {name: '福建'},
                            {name: '贵州'},
                            {name: '广东'},
                            {name: '青海'},
                            {name: '西藏'},
                            {name: '四川'},
                            {name: '宁夏'},
                            {name: '海南'},
                            {name: '台湾'},
                            {name: '香港'},
                            {name: '澳门'}
                        ]
                    }
                ]
            };
            var option = {
                tooltip: {
//                    show: false //不显示提示标签
                    formatter: '{b}', //提示标签格式
                    backgroundColor: "#585eaa",//提示标签背景颜色
                    textStyle: {color: "#feeeed"} //提示标签字体颜色
                },
                series: [{
                    type: 'map',
                    mapType: 'china',
                    label: {
                        normal: {
                            show: true,//显示省份标签
                            textStyle: {color: "#fffef9"}//省份标签字体颜色
                        },
                        emphasis: {//对应的鼠标悬浮效果
                            show: true,
                            textStyle: {color: "#800080"}
                        }
                    },
                    itemStyle: {
                        normal: {
                            borderWidth: .5,//区域边框宽度
                            borderColor: '#102b6a',//区域边框颜色
                            areaColor: "#426ab3",//区域颜色
                        },
                        emphasis: {
                            borderWidth: .5,
                            borderColor: '#4b0082',
                            areaColor: "#ffdead",
                        }
                    },
                    selectedMode: 'single',
                    data: [
                        {name: '辽宁', selected: true}//福建为选中状态
                    ]
                }],
            };
            myChart.setOption(option);
            myChart.on('mouseover', function (params) {
                {#            var dataIndex = params.dataIndex;#}
                {#            console.log(params);#}
            });
            myChart.on('click', function (params) {//点击事件
                var dataIndex = params.dataIndex;
                console.log(params.name);
                province = params.name
                $("#province_selected").text('当前选中:' + province)
                {#                params.selected = 'true'#}
                CreateChart(province)
                creat_industry_pie()
            })
            {#            myChart.on(ecConfig.EVENT.MAP_SELECTED, function (param) {#}
            {#                var selected = param.selected;#}
            {#            })#}
        }
        $("#all_province").click(function(){
            province = 'all'
            $("#province_selected").text('当前选中:全国')
            CreateChart(province)
                creat_industry_pie()
        })
        <!--面板切换-->
        $("#mydropdown").on("click", "[data-stopPropagation]", function (e) {
            e.stopPropagation();
        })

        <!--复选框操作-->
        var Chosenindexes = new Array();
        Chosenindexes = ['tot_oper_rev'];
        Chosenindexes['tot_oper_rev'] = "#000000";

        $(document).ready(function () {

        });
        $("div#mychoice :checkbox").change(function () {
            indexname = $(this).val();
            if ($(this).is(':checked') == true) {
                colorname = NewColor();
                console.log(this);
                Chosenindexes.push(indexname);
                Chosenindexes[indexname] = colorname;
                $("#i_" + indexname).css("background-color", colorname);
                console.log(Chosenindexes);
            }
            else {
                delete Chosenindexes[indexname]
                $("#i_" + indexname).css("background-color", "white");
                console.log(Chosenindexes);
            }
            $("div#unselected").empty();
            $("div#selected").empty();
            $("input[type=checkbox]").each(function () {//each()方法遍历所有的复选框
                if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                    var tempspan = $("<span class=\"label label-default\" data-stopPropagation=\"true\"id =\"" + indexname + "\">" + dict[indexname] + "</span>")
                    tempspan.appendTo($("div#unselected"));
                    $("div#unselected").append(" ");
                }
            })
            CreateChart(province);
            CreateTable();
            set_time();
        });

        <!--搜索事件-->
        function selectline(linename) {
            for (var line in option.series) {
                l = parseInt(line);
                if (option.series[l].name == linename) {
                    tempcolor = NewColor();
                    option.series[l].lineStyle.normal.color = tempcolor;
                    option.series[l].itemStyle.normal.color = tempcolor;
                    $("span#" + linename).css('color', tempcolor);
                    selectedindexes.push(l);
                    selectedindexname.push(option.series[l].name);
                    option.legend.data = selectedindexname;
                    myChart.setOption(option);
                }
            }
        }
        function unselectline(linename) {
            for (var line in option.series) {
                l = parseInt(line);
                if (option.series[l].name == linename) {
                    option.series[l].lineStyle.normal.color = '#C4D2DB';
                    option.series[l].itemStyle.normal.color = '#C4D2DB';
                    $("span#" + linename).css('color', 'white');
                    selectedindexes.splice(selectedindexes.indexOf(l), 1);
                    selectedindexname.splice(selectedindexname.indexOf(option.series[l].name), 1);
                    option.legend.data = selectedindexname;
                    myChart.setOption(option);

                }
            }

        }

        <!--随机生成颜色-->
        function NewColor() {
            var colorElements = "0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";
            var colorArray = colorElements.split(",");
            var color = "#";
            for (var i = 0; i < 6; i++) {
                color += colorArray[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        <!--时间控制框-->
        var starttime = "20071231";
        var endtime = "20161231";
        $(".form_datetime").datetimepicker({
            format: 'yyyy-mm-dd ',
            startView: 4,
            minView: 4,
            maxView: 4,
            autoclose: true,
            pickerPosition: 'top-right'
        });
        $('#starttime').datetimepicker('setStartDate', '2007-12-31');
        $('#starttime').datetimepicker('setEndDate', '2016-12-31');
        $('#endtime').datetimepicker('setStartDate', '2007-12-31');
        $('#endtime').datetimepicker('setEndDate', '2016-12-31');
        $('#starttime')
            .datetimepicker()
            .on('changeDate', function (ev) {
                starts = ev.date.Format("yyyy年Q4");
                option.dataZoom[0].startValue = starts;
                myChart.setOption(option);
                RequestTable();
            });
        $('#endtime')
            .datetimepicker()
            .on('changeDate', function (ev) {
                ends = ev.date.Format("yyyy年Q4");
                option.dataZoom[0].endValue = ends;
                myChart.setOption(option);
                RequestTable();
            });
        Date.prototype.Format = function (fmt) { //author: meizz
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        }
        function dateformat(olddate) {
            newdate = []
            for (i = 0; i < olddate.length; i++) {
                var str = olddate[i];
                var reg = /1231/g;
                str = str.replace(reg, '年Q4');
                newdate.push(str)
            }
            return newdate
        }
        function datefor(olddate) {
            newdate = []
            for (i = 0; i < olddate.length; i++) {
                var str = olddate[i];
                var reg = /年Q4/g;
                str = str.replace(reg, '1231');
                newdate.push(str)
            }
            return newdate
        }

        <!--单位转换-->
        denominator = 1
        $("select#unit").change(function () {
            flag = $(this).val();
            if (flag == "0") {
                denominator = 1;
                CreateChart(province);
                CreateTable();
                set_time();
            }
            if (flag == "1") {
                denominator = 10000;
                CreateChart(province);
                CreateTable();
                set_time();
            }
        });
        function numfilter(oldnum) {
            newnum = []
            for (i = 0; i < oldnum.length; i++) {
                temp = oldnum[i] / denominator;
                newnum.push(temp.toFixed(2))
            }
            return newnum;
        }

        <!--建图-->
        var myChart = echarts.init(document.getElementById('mychart'));

        function CreateChart(province) {
            var market_results;
            var dict = {
                'tot_oper_rev': '总营业收入',
                'net_profit_is': '净利润总和',
                'wgsd_net_inc': '归属股东利润总和',
                'tot_assets': '总资产总和',
                'tot_liab': '总负债总和',
                'net_assets': '净资产总和',
                'wgsd_com_eq': '股东权益总和',
                'operatecashflow_ttm2': '经营性现金流总和',
                'investcashflow_ttm2': '投资性现金流总和',
                'financecashflow_ttm2': '融资性现金流总和',
                'cashflow_ttm2': '总现金流总和',
                'free_cash_flow': '自由现金流估计',
            };
            $.ajax({
                type: 'GET',
                url: '{{ url_for("restfulapi.market_value") }}',
                data: {
                    province: province,
                    starttime: '20071231',
                    endtime: '20161231',
                    indexes: ['tot_oper_rev', 'net_profit_is', 'wgsd_net_inc', 'tot_assets', 'tot_liab', 'net_assets', 'wgsd_com_eq', 'operatecashflow_ttm2', 'investcashflow_ttm2', 'financecashflow_ttm2', 'cashflow_ttm2', 'free_cash_flow']
                },
                dataType: 'json',
                success: function (data) {
                    market_results = data;
                    dataSeries = [];
                    for (var i = 0; i < market_results.indexes.length; i++) {
                        if (Chosenindexes.hasOwnProperty(market_results.indexes[i])) {
                            temp = {
                                name: market_results.indexes[i],
                                type: 'bar',

                                itemStyle: {normal: {color: Chosenindexes[market_results.indexes[i]]}},

                                smooth: true,
                                data: numfilter(eval("market_results." + market_results.indexes[i]))
                            };
                            dataSeries.push(temp);
                        }
                    }
                    option = {
                        title: {
                            text: '财务指标分析图',
                            left: '45%'
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: function (params) {
                                return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                            }
                        },
                        legend: {
                            data: [],
                            orient: 'vertical',
                            left: '85%',
                            top: '10%',
                            formatter: function (name) {
                                return dict[name];
                            }
                        },
                        grid: {
                            left: '5%',
                            top: '10%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                magicType: {
                                    type: ['line', 'bar']
                                }
                            }
                        },
                        xAxis: {
                            type: 'category',

                            axisTick: {
                                show: false
                            },
                            data: dateformat(market_results.the_year),
                            Interval: 5
                        },
                        yAxis: {
                            type: 'value',
                            axisTick: {
                                show: false
                            },
                        },
                        dataZoom: [
                            {
                                type: 'slider',
                                xAxisIndex: [0],
                                startValue: "2016年Q4",
                                endValue: "2007年Q4",
                                filterMode: 'filter',
                            }
                        ],
                        series: dataSeries
                    };
                    myChart.setOption(option, true);
                    myChart.on('datazoom', function (params) {
                        option.xAxis.interval = 10 * (params.end - params.start) / 100;
                        var ends = (2016 - Math.ceil(params.start / 100 * 9)) + '-12-31'
                        if (Math.ceil(1 - params.end / 100)) {
                            var starts = (2016 - Math.ceil(params.end / 100 * 9)) + '-12-31'
                        }
                        else {
                            var starts = '2007-12-31'
                        }
                        set_timepicker(starts, ends)
                    });
                    function set_timepicker(start, end) {
                        document.getElementById('endtime').value = start
                        document.getElementById('starttime').value = end
                    }
                }
            });

        }
        function set_time() {
            document.getElementById('endtime').value = "2007-12-31"
            document.getElementById('starttime').value = "2016-12-31"
        }

        <!--建表-->
        var market_results_t;
        var invest_results_t;
        function RequestTable() {
            var opt = myChart.getOption();
            var dz = opt.dataZoom[0];
            {#            alert(province)#}
            $.ajax({
                type: 'GET',
                url: '{{url_for("restfulapi.market_value")}}',
                data: {
                    province: province,
                    starttime: opt.xAxis[0].data[dz.endValue],
                    endtime: opt.xAxis[0].data[dz.startValue],
                    indexes: ['tot_oper_rev', 'net_profit_is', 'wgsd_net_inc', 'tot_assets', 'tot_liab', 'net_assets', 'wgsd_com_eq', 'operatecashflow_ttm2', 'investcashflow_ttm2', 'financecashflow_ttm2', 'cashflow_ttm2', 'free_cash_flow']
                },
                dataType: 'json',//希望服务器返回json格式的数据
                success: function (data) {
                    market_results_t = data;
                    invest_results_t = data;
                    CreateTable();
                }
            })
        }
        function CreateTable() {
            $("#mytable").empty();
            var table = $("<table id=\"temptable\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
            table.appendTo($("#mytable"));
            th = $("<thead></thead>");
            th.appendTo(table);
            var tr = $("<tr></tr>");
            tr.appendTo(th);
            var td = $("<td id=\"subject\">" + "项目" + "</td>");
            td.appendTo(tr);
            theyear = dateformat(market_results_t.the_year)
            for (var j = 0; j < theyear.length; j++) {
                var td = $("<td>" + theyear[j] + "</td>");
                td.appendTo(tr);
            }
            tb = $("<tbody></tbody>");
            tb.appendTo(table);
            $("#mytable").append("</table>");
            var mydatatb = $('#temptable').DataTable({
                "info": false,
                "processing": true,
                "scrollX": true,
                "searching": true,
                "fixedColumns": { //固定列的配置项
                    "leftColumns": 1//固定左边第一列
                },
                "language": {
                    "emptyTable": "没有数据",
                    "loadingRecords": "加载中…",
                    "processing": "查询中…",
                    "search": "检索:",
                    "lengthMenu": "每页 _MENU_ 条",
                    "zeroRecords": "没有数据",
                    "paginate": {
                        "first": "第一页",
                        "last": "最后一页",
                        "next": "",
                        "previous": ""
                    },
                    "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                    "infoEmpty": "没有数据",
                    "infoFiltered": "(过滤总件数 _MAX_ 条)"
                }
            });
            setTimeout("$(\"#subject\").trigger(\"click\")", 100);
            for (var i = 0; i < market_results_t.indexes.length; i++) {
                if (Chosenindexes.hasOwnProperty(market_results_t.indexes[i])) {
                    var rowNode = mydatatb
                        .row.add([dict[market_results_t.indexes[i]]].concat(numfilter(eval("market_results_t." + market_results_t.indexes[i]))))
                        .draw()
                        .node();
                    $(rowNode)
                        .attr('id', market_results_t.indexes[i]);
                }
            }
            for (var key in Chosenindexes) {
                $('tr#' + key).css('color', Chosenindexes[key])
            }
        }
        {#行业状况建图#}
        var myChart11 = echarts.init(document.getElementById('one'));
        var myChart12 = echarts.init(document.getElementById('two'));
        var myChart13 = echarts.init(document.getElementById('three'));
        var myChart14 = echarts.init(document.getElementById('four'));


        function creat_industry_pie() {

            indexes = ['tot_oper_rev','tot_assets','tot_liab','wgsd_com_eq']
            var dact = {
                '10': '能源',
                '15': '材料',
                '20': '工业',
                '25': '可选消费',
                '30': '日常消费',
                '35': '医疗保健',
                '40': '金融',
                '45': '信息技术',
                '55': '公用事业',
                '60': '房地产',
            };
            $.ajax({
                type: 'GET',
                url: '{{ url_for("restfulapi.market_one") }}',
                data: {
                    province: province,
                    time: '20161231',
                    indexes: indexes,
                },
                dataType: 'json',
                async: false,
                success: function (data) {
                    console.log(data)
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            value: data.tot_oper_rev_list[i].toFixed(2)
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '营业收入',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },

                                data: dataSeries
                            }
                        ]
                    };
                    myChart11.setOption(option, true);
{#                    2#}
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            value: data.tot_assets_list[i].toFixed(2)
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '总资产',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },
                                data: dataSeries
                            }
                        ]
                    };
                    myChart12.setOption(option, true);
{#3#}
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            value: data.tot_liab_list[i].toFixed(2)
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '总负债',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },
                                data: dataSeries
                            }
                        ]
                    };
                    myChart13.setOption(option, true);
{#4#}
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            value: data.wgsd_com_eq_list[i].toFixed(2)
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '股东权益',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },
                                data: dataSeries
                            }
                        ]
                    };
                    myChart14.setOption(option, true);
                }
            });



        }
        var myChart111 = echarts.init(document.getElementById('one1'));
        var myChart121 = echarts.init(document.getElementById('two1'));
        var myChart131 = echarts.init(document.getElementById('three1'));
        var myChart141 = echarts.init(document.getElementById('four1'));
        function creat_industry_pie_test() {

            indexes = ['tot_oper_rev','tot_assets','tot_liab','wgsd_com_eq']
            var dact = {
                '10': '能源',
                '15': '材料',
                '20': '工业',
                '25': '可选消费',
                '30': '日常消费',
                '35': '医疗保健',
                '40': '金融',
                '45': '信息技术',
                '55': '公用事业',
                '60': '房地产',
            };
            $.ajax({
                type: 'GET',
                url: '{{ url_for("restfulapi.market_one") }}',
                data: {
                    province: '西藏',
                    time: '20161231',
                    indexes: indexes,
                },
                dataType: 'json',
                async: false,
                success: function (data) {
                    console.log(data)
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            value: data.tot_oper_rev_list[i].toFixed(2)
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '营业收入',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },

                                data: dataSeries
                            }
                        ]
                    };
                    myChart111.setOption(option, true);
{#                    2#}
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            value: data.tot_assets_list[i].toFixed(2)
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '总资产',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },
                                data: dataSeries
                            }
                        ]
                    };
                    myChart121.setOption(option, true);
{#3#}
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            value: data.tot_liab_list[i].toFixed(2)
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '总负债',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },
                                data: dataSeries
                            }
                        ]
                    };
                    myChart131.setOption(option, true);
{#4#}
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            value: data.wgsd_com_eq_list[i].toFixed(2)
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '股东权益',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },
                                data: dataSeries
                            }
                        ]
                    };
                    myChart141.setOption(option, true);
                }
            });



        }
        function test(){
             indexes = ['tot_oper_rev','tot_assets','tot_liab','wgsd_com_eq']
            var dact = {
                '10': '能源',
                '15': '材料',
                '20': '工业',
                '25': '可选消费',
                '30': '日常消费',
                '35': '医疗保健',
                '40': '金融',
                '45': '信息技术',
                '55': '公用事业',
                '60': '房地产',
            };
            $.ajax({
                type: 'GET',
                url: '{{ url_for("restfulapi.market_one") }}',
                data: {
                    province: province,
                    time: '20161231',
                    indexes: indexes,
                },
                dataType: 'json',
                async: false,
                success: function (data) {
                    console.log(data)
                    var dataSeries = [];
                    var option = {}
                    for (var i = 0; i < data.my_code.length; i++) {
                        temp = {
                            name: dact[data.my_code[i]],
                            {#                            value: data.tot_oper_rev_list[i].toFixed(2)#}
                            value: 1
                        };
                        dataSeries.push(temp);
                    }
                    option = {
                        title: {
                            text: '营业收入',
                            left: '30%'
                        },
                        tooltip: {
                            trigger: 'item',
                        },
                        series: [
                            {
                                type: 'pie',
                                radius: ['50%', '70%'],
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: false,
                                        position: 'center'
                                    },
                                    emphasis: {
                                        show: true,
                                        textStyle: {
                                            fontSize: '25',
                                            fontWeight: 'bold'
                                        }
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    }
                                },

                                data: dataSeries
                            }
                        ]
                    };
                    myChart11.setOption(option, true);
                }
            })
        }
        $("#test").click(function(){
            test()
        })
        function firstvisit() {
            creatmap()
            CreateChart(province)
            creat_industry_pie()
            creat_industry_pie_test()
        }
        firstvisit()
    </script>
{% endblock %}

{% block map %}

    <div id="cityDist" style="width:100%;height:260px">

    </div>

{% endblock %}
{% block scripts %}

{% endblock %}
