{% extends "industry_analysis/industry_analysis_base.html" %}

{% block styles %}
    <style>
        .divcheckbox {
            margin-left: 3px;
            margin-top: 3px;
        }

        .checkbox {
            float: left;

        }

        .options {
            margin-top: 3px;
        }

        .selected {
            border: 1px solid #5e5e5e;
            background-color: #f9f9f9;
            margin-top: 3px;
            display: block;

        }

        .thediv:hover {
            background-color: #a5b2cb;
        }

        .thediv {
            background-color: #d3d3d3;
        }
    </style>
{% endblock %}

{% block tab %}
    <ul class="nav nav-pills">
        <li><a href="{{ url_for('.market_value') }}">市场分析</a></li>
        <li class="dropdown"> <!--tip 可以同时写两个属性-->
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                行业状况 <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li><a href="{{ url_for('.industry_status',parameter=1) }}">部门</a></li>
                <li><a href="{{ url_for('.industry_status',parameter=2) }}">行业组</a></li>
                <li><a href="{{ url_for('.industry_status',parameter=3) }}">行业</a></li>
                <li><a href="{{ url_for('.industry_status',parameter=4) }}">子行业</a></li>
            </ul>
        </li>
        <li class="dropdown active"> <!--tip 可以同时写两个属性-->
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                对比分析 <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li><a href="{{ url_for('.industry_compare',param=1) }}">部门</a></li>
                <li><a href="{{ url_for('.industry_compare',param=2) }}">行业组</a></li>
                <li><a href="{{ url_for('.industry_compare',param=3) }}">行业</a></li>
                <li><a href="{{ url_for('.industry_compare',param=4) }}">子行业</a></li>
            </ul>
        </li>
        <li><a href="{{ url_for('.cns_home') }}">上市公司名单</a></li>
        <li><a href="{{ url_for('.annual_table') }}">年度表A</a></li>
        <li class="dropdown"> <!--tip 可以同时写两个属性-->
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                年度表B <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li><a href="{{ url_for('.annual_table_b',parameter=1) }}">部门</a></li>
                <li><a href="{{ url_for('.annual_table_b',parameter=2) }}">行业组</a></li>
                <li><a href="{{ url_for('.annual_table_b',parameter=3) }}">行业</a></li>
                <li><a href="{{ url_for('.annual_table_b',parameter=4) }}">子行业</a></li>
            </ul>
        </li>
    </ul>
{% endblock %}

{% block form %}
    {% if param==1 %}
        <div class="form-search" id="form1">
            <div style="height:50px" class="input-group">
                <input id="stockcode1" list="itemlist1" name="stockcode" type="text"
                       style="margin-top:10px;margin-left:10px;height: 30px">
                <datalist id="itemlist1">
                    <option value="10">能源</option>
                    <option value="15">材料</option>
                    <option value="20">工业</option>
                    <option value="25">可选消费</option>
                    <option value="30">日常消费</option>
                    <option value="35">医疗保健</option>
                    <option value="40">金融</option>
                    <option value="45">信息技术</option>
                    <option value="50">电信服务</option>
                    <option value="55">公共事业</option>
                    <option value="60">房地产</option>
                </datalist>
                <button id="submit1" type="submit" class="btn btn-default"
                        style="margin-top:0;margin-left:20px;width:150px;height: 30px" data-toggle="tooltip"
                        title="点击添加"
                        data-placement="right">添加比较项
                </button>
                <button id="clear1" type="submit" class="btn btn-default"
                        style="margin-top:0;margin-left:10px;width:150px;height: 30px">清空比较列表
                </button>
                <div>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                </div>
            </div>
        </div>
    {% elif param==2 %}
        <div class="form-search" id="form2">
            <div style="height:50px" class="input-group">
                <input id="stockcode2" list="itemlist2" name="stockcode" type="text"
                       style="margin-top:10px;margin-left:10px;height: 30px">
                <datalist id="itemlist2">
                    <option value="1010">能源Ⅱ</option>
                    <option value="1510">材料Ⅱ</option>
                    <option value="2010">资本货物</option>
                    <option value="2020">商业和专业服务</option>
                    <option value="2030">运输</option>
                    <option value="2510">汽车与汽车零部件</option>
                    <option value="2520">耐用消费品与服装</option>
                    <option value="2530">消费者服务Ⅱ</option>
                    <option value="2540">媒体Ⅱ</option>
                    <option value="2550">零售业</option>
                    <option value="3010">食品与主要用品零售Ⅱ</option>
                    <option value="3020">食品、饮料与烟草</option>
                    <option value="3030">家庭与个人用品</option>
                    <option value="3510">医疗保健设备与服务</option>
                    <option value="3520">制药、生物科技与生命科学</option>
                    <option value="4010">银行</option>
                    <option value="4020">多元金融</option>
                    <option value="4030">保险Ⅱ</option>
                    <option value="4510">软件与服务</option>
                    <option value="4520">技术硬件与设备</option>
                    <option value="4530">半导体与半导体生产设备</option>
                    <option value="5010">电信服务Ⅱ</option>
                    <option value="5510">公用事业Ⅱ</option>
                    <option value="6010">房地产Ⅱ</option>
                </datalist>
                <button id="submit2" type="submit" class="btn btn-default"
                        style="margin-top:0;margin-left:20px;width:150px;height: 30px" data-toggle="tooltip"
                        title="点击添加"
                        data-placement="right">添加比较项
                </button>
                <button id="clear2" type="submit" class="btn btn-default"
                        style="margin-top:0;margin-left:10px;width:150px;height: 30px">清空比较列表
                </button>
                <div>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                </div>
            </div>
        </div>
    {% elif param==3 %}
        <div class="form-search" id="form3">
            <div style="height:50px" class="input-group">
                <input id="stockcode3" list="itemlist3" name="stockcode" type="text"
                       style="margin-top:10px;margin-left:10px;height: 30px">
                <datalist id="itemlist3">
                    <option value="101010">能源设备与服务</option>
                    <option value="101020">石油、天然气与供消费用燃料</option>
                    <option value="151010">化工</option>
                    <option value="151020">建材Ⅲ</option>
                    <option value="151030">容器与包装</option>
                    <option value="151040">金属、非金属与采矿</option>
                    <option value="151050">纸与林木产品</option>
                    <option value="201010">航空航天与国防Ⅲ</option>
                    <option value="201020">建筑产品Ⅲ</option>
                    <option value="201030">建筑与工程Ⅲ</option>
                    <option value="201040">电气设备</option>
                    <option value="201050">综合类Ⅲ</option>
                    <option value="201060">机械</option>
                    <option value="201070">贸易公司与工业品经销商Ⅲ</option>
                    <option value="202010">商业服务与用品</option>
                    <option value="202020">专业服务</option>
                    <option value="203010">航空货运与物流Ⅲ</option>
                    <option value="203020">航空Ⅲ</option>
                    <option value="203030">海运Ⅲ</option>
                    <option value="203040">公路与铁路运输</option>
                    <option value="203050">交通基础设施</option>
                    <option value="251010">汽车零配件</option>
                    <option value="251020">汽车</option>
                    <option value="252010">家庭耐用消费品</option>
                    <option value="252020">休闲设备与用品</option>
                    <option value="252030">纺织品、服装与奢侈品</option>
                    <option value="253010">酒店、餐馆与休闲Ⅲ</option>
                    <option value="253020">综合消费者服务Ⅲ</option>
                    <option value="254010">媒体Ⅲ</option>
                    <option value="255010">消费品经销商Ⅲ</option>
                    <option value="255020">互联网与售货目录零售</option>
                    <option value="255030">多元化零售</option>
                    <option value="255040">专营零售</option>
                    <option value="301010">食品与主要用品零售Ⅲ</option>
                    <option value="302010">饮料</option>
                    <option value="302020">食品</option>
                    <option value="303010">家庭用品Ⅲ</option>
                    <option value="303020">个人用品Ⅲ</option>
                    <option value="351010">医疗保健设备与用品</option>
                    <option value="351020">医疗保健提供商与服务</option>
                    <option value="351030">医疗保健技术Ⅲ</option>
                    <option value="352010">生物科技Ⅲ</option>
                    <option value="352020">制药</option>
                    <option value="352030">生命科学工具和服务Ⅲ</option>
                    <option value="401010">商业银行</option>
                    <option value="402010">多元金融服务</option>
                    <option value="402030">资本市场</option>
                    <option value="403010">保险Ⅲ</option>
                    <option value="451010">互联网软件与服务Ⅲ</option>
                    <option value="451020">信息技术服务</option>
                    <option value="451030">软件</option>
                    <option value="452010">通信设备Ⅲ</option>
                    <option value="452020">电脑与外围设备</option>
                    <option value="452030">电子设备、仪器和元件</option>
                    <option value="453010">半导体产品与半导体设备</option>
                    <option value="501010">多元电信服务</option>
                    <option value="501020">无线电信业务Ⅲ</option>
                    <option value="551010">电力Ⅲ</option>
                    <option value="551020">燃气Ⅲ</option>
                    <option value="551030">复合型公用事业Ⅲ</option>
                    <option value="551040">水务Ⅲ</option>
                    <option value="551050">独立电力生产商与能源贸易商Ⅲ</option>
                    <option value="601020">房地产管理和开发</option>
                </datalist>
                <button id="submit3" type="submit" class="btn btn-default"
                        style="margin-top:0;margin-left:20px;width:150px;height: 30px" data-toggle="tooltip"
                        title="点击添加"
                        data-placement="right">添加比较项
                </button>
                <button id="clear3" type="submit" class="btn btn-default"
                        style="margin-top:0;margin-left:10px;width:150px;height: 30px">清空比较列表
                </button>
                <div>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                </div>
            </div>
        </div>
    {% elif param==4 %}
        <div class="form-search" id="form4">
            <div style="height:50px" class="input-group">
                <input id="stockcode4" list="itemlist4" name="stockcode" type="text"
                       style="margin-top:10px;margin-left:10px;height: 30px">
                <datalist id="itemlist4">
                    <option value="10101010">石油天然气钻井</option>
                    <option value="10101020">石油天然气设备与服务</option>
                    <option value="10102010">综合性石油天然气</option>
                    <option value="10102020">石油天然气勘探与生产</option>
                    <option value="10102030">石油与天然气的炼制和销售</option>
                    <option value="10102040">石油与天然气的储存和运输</option>
                    <option value="10102050">煤炭与消费用燃料</option>
                    <option value="15101010">基础化工</option>
                    <option value="15101011">化纤</option>
                    <option value="15101020">多元化工</option>
                    <option value="15101030">化肥与农用化工</option>
                    <option value="15101040">工业气体</option>
                    <option value="15101050">特种化工</option>
                    <option value="15102010">建材</option>
                    <option value="15103010">金属与玻璃容器</option>
                    <option value="15103020">纸包装</option>
                    <option value="15104010">铝</option>
                    <option value="15104020">金属非金属</option>
                    <option value="15104030">黄金</option>
                    <option value="15104040">贵金属与矿石</option>
                    <option value="15104045">白银</option>
                    <option value="15104050">钢铁</option>
                    <option value="15105010">林木产品</option>
                    <option value="15105020">纸制品</option>
                    <option value="20101010">航天航空与国防</option>
                    <option value="20102010">建筑产品</option>
                    <option value="20103010">建筑与工程</option>
                    <option value="20104010">电气部件与设备</option>
                    <option value="20104020">重型电气设备</option>
                    <option value="20105010">综合类行业</option>
                    <option value="20106010">建筑机械与重型卡车</option>
                    <option value="20106015">农用农业机械</option>
                    <option value="20106020">工业机械</option>
                    <option value="20107010">贸易公司与工业品经销商</option>
                    <option value="20201010">商业印刷</option>
                    <option value="20201050">环境与设施服务</option>
                    <option value="20201060">办公服务与用品</option>
                    <option value="20201070">综合支持服务</option>
                    <option value="20202020">调查和咨询服务</option>
                    <option value="20301010">航空货运与物流</option>
                    <option value="20302010">航空</option>
                    <option value="20303010">海运</option>
                    <option value="20304010">铁路运输</option>
                    <option value="20304020">公路运输</option>
                    <option value="20305010">机场服务</option>
                    <option value="20305020">公路与铁路</option>
                    <option value="20305030">海港与服务</option>
                    <option value="25101010">汽车零配件</option>
                    <option value="25101020">轮胎与橡胶</option>
                    <option value="25102010">汽车制造</option>
                    <option value="25102020">摩托车制造</option>
                    <option value="25201010">消费电子产品</option>
                    <option value="25201020">家庭装饰品</option>
                    <option value="25201030">住宅建筑</option>
                    <option value="25201040">家用电器</option>
                    <option value="25201050">家用器具与特殊消费品</option>
                    <option value="25202010">休闲用品</option>
                    <option value="25202020">摄影用品</option>
                    <option value="25203010">服装、服饰与奢侈品</option>
                    <option value="25203020">鞋类</option>
                    <option value="25203030">纺织品</option>
                    <option value="25301020">酒店、度假村与豪华游轮</option>
                    <option value="25301030">休闲设施</option>
                    <option value="25301040">餐馆</option>
                    <option value="25302010">教育服务</option>
                    <option value="25401010">广告</option>
                    <option value="25401020">有线和卫星电视</option>
                    <option value="25401030">电影与娱乐</option>
                    <option value="25401040">出版</option>
                    <option value="25501010">消费品经销商</option>
                    <option value="25502010">售货目录零售</option>
                    <option value="25502020">互联网零售</option>
                    <option value="25503010">百货商店</option>
                    <option value="25503020">综合货品商店</option>
                    <option value="25504020">电脑与电子产品零售</option>
                    <option value="25504040">专卖店</option>
                    <option value="25504050">汽车零售</option>
                    <option value="30101010">药品零售</option>
                    <option value="30101020">食品分销商</option>
                    <option value="30101030">食品零售</option>
                    <option value="30101040">大卖场与超市</option>
                    <option value="30201010">啤酒</option>
                    <option value="30201020">白酒与葡萄酒</option>
                    <option value="30201030">软饮料</option>
                    <option value="30201010">农产品</option>
                    <option value="30201030">食品加工与肉类</option>
                    <option value="30301010">家庭用品</option>
                    <option value="30302010">个人用品</option>
                    <option value="35101010">医疗保健设备</option>
                    <option value="35101020">医疗保健用品</option>
                    <option value="35102015">保健护理服务</option>
                    <option value="35102020">保健护理设施</option>
                    <option value="35103010">医疗保健技术</option>
                    <option value="35201010">生物科技</option>
                    <option value="35202010">西药</option>
                    <option value="35202011">中药</option>
                    <option value="35203010">生命科学工具和服务</option>
                    <option value="40101010">多元化银行</option>
                    <option value="40101015">区域性银行</option>
                    <option value="40201020">其他多元金融服务</option>
                    <option value="40201030">多领域控股</option>
                    <option value="40203010">资产管理与托管银行</option>
                    <option value="40203020">投资银行业与经纪业</option>
                    <option value="40203030">多元资本市场</option>
                    <option value="40301020">人寿与健康保险</option>
                    <option value="40301030">多元化保险</option>
                    <option value="40301040">财产与意外伤害保险</option>
                    <option value="45101010">互联网软件与服务</option>
                    <option value="45102010">信息科技咨询与其它服务</option>
                    <option value="45102020">数据处理与外包服务</option>
                    <option value="45103010">应用软件</option>
                    <option value="45103020">系统软件</option>
                    <option value="45103030">家庭娱乐软件</option>
                    <option value="45201020">通信设备</option>
                    <option value="45202010">电脑硬件</option>
                    <option value="45202020">电脑存储与外围设备</option>
                    <option value="45203010">电子元件</option>
                    <option value="45203015">电子设备和仪器</option>
                    <option value="45203020">电子制造服务</option>
                    <option value="45303030">技术产品经销商</option>
                    <option value="45301010">半导体设备</option>
                    <option value="45301020">半导体产品</option>
                    <option value="50101010">非传统电信运营商</option>
                    <option value="50101020">综合电信服务</option>
                    <option value="50102010">无线电信业务</option>
                    <option value="55101010">电力</option>
                    <option value="55102010">燃气</option>
                    <option value="55103010">复合型公用事业</option>
                    <option value="55104010">水务</option>
                    <option value="55105010">独立电力生产商与能源贸易商</option>
                    <option value="55105020">新能源发电业者</option>
                    <option value="60102020">房地产经营公司</option>
                    <option value="60102030">房地产开发</option>
                    <option value="60102040">房地产服务</option>
                </datalist>
                <button id="submit4" type="submit" class="btn btn-default"
                        style="margin-top:0;margin-left:20px;width:150px;height: 30px" data-toggle="tooltip"
                        title="点击添加"
                        data-placement="right">添加比较项
                </button>
                <button id="clear4" type="submit" class="btn btn-default"
                        style="margin-top:0;margin-left:10px;width:150px;height: 30px">清空比较列表
                </button>
                <div>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}

{% block container %}
    <div id="basics" style="height:auto">
        {% if param==1 %}
            <div id="myTabChoice1" style="width: 100%;height:600px;margin:auto ">
                <ul id="myTab" class="nav nav-tabs">
                    <li class="disabled">
                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                    </li>
                    <li class="active"><a href="#chart" data-toggle="tab">图表</a></li>
                    <li><a href="#table" data-toggle="tab" onclick="RequestTable1(codelist)">数据</a></li>
                </ul>
                <div id="choice" class="tab-content">
                    <div class="tab-pane fade in active" id="chart">
                        <div id="mychart" style="width:85%;height:60%;;float:right"></div>
                        <div id="myspan" style="width:15%;height:25%;float:left;overflow-y:auto">
                            <legend>比较列表</legend>
                            <div id="div_compare1" style="overflow-y: auto"></div>
                        </div>
                        <div id="mychoice" style="width:15%;height:47%;float:left;overflow-y:auto">
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_oper_rev" checked="checked"
                                                  id="first_check">总营业收入</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="net_profit_is">净利润总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="wgsd_net_inc">归属股东利润总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_assets">总资产总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_liab">总负债总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="net_assets">净资产总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="wgsd_com_eq">股东权益总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="operatecashflow_ttm2">经营性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton"
                                                  value="investcashflow_ttm2">投资性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="financecashflow_ttm2">融资性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="cashflow_ttm2">总现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="free_cash_flow">自由现金流估计</label>
                                </div>
                            </div>
                        </div>
                        <div style="float:right;width:81.5%;height:10%;margin-top:1%;border-radius:8px;background-color:#dcdcdc">
                            <div style="float: left;margin-left: 20px;margin-top:20px">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">起始时间:</a><input size="16"
                                                                                                      type="text"
                                                                                                      value="1991-12-31"
                                                                                                      id="endtime"
                                                                                                      readonly
                                                                                                      class="form_datetime">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">结束时间:</a><input size="16"
                                                                                                      type="text"
                                                                                                      value="2016-12-31"
                                                                                                      id="starttime"
                                                                                                      readonly
                                                                                                      class="form_datetime">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">单位:</a>
                                <select id="unit">
                                    <option value="0">亿</option>
                                    <option value="1">千亿</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="table">
                        <div id="mytable" style="width: 100%;height:100%;overflow-y:scroll;overflow-x:scroll"></div>
                    </div>
                </div>
            </div>
            <script>
                $("#submit1").click(function () {
                    thiscode = $("#stockcode1").val();
                    var a = 1;
                    for (var i = 0; i < codelist.length; i++) {
                        if (thiscode == codelist[i]) {
                            alert('已添加，请勿重复添加！')
                            a = 0
                        }
                    }
                    if (a) {
                        codelist.push(thiscode);
                        colorlist[thiscode] = NewColor();
                        RequestChart1(codelist);
                        creat_compare(thiscode);
                        RequestTable1(codelist);
                    }
                });
                $("#clear1").click(function () {
                    codelist = [];
                    $('#div_compare1').empty();
                    $("#mytable").empty();
                    var myChart = echarts.init(document.getElementById('mychart'));
                    myChart.clear();
                });
            </script>
            <!--图表-->
            <script>
                var myChart = echarts.init(document.getElementById('mychart'));
                var dict = {
                    '10': '能源',
                    '15': '材料',
                    '20': '工业',
                    '25': '可选消费',
                    '30': '日常消费',
                    '35': '医疗保健',
                    '40': '金融',
                    '45': '信息技术',
                    '50': '电信服务',
                    '55': '公共事业',
                    '60': '房地产',
                };

                var colorlist = {};
                var codelist = ['10', '15'];
                colorlist['10'] = '#000000';
                colorlist['15'] = '#028600'
                var market_results_t1;
                var invest_results_t1;

                $(document).ready(function () {
                    creat_compare_option();
                    RequestChart1(codelist);
                    RequestTable1(codelist);
                });
                function RequestChart1(codelist) {
                    dataSeries = [];
                    for (var k = 0; k < codelist.length; k++) {
                        $.ajax({
                            type: 'GET',
                            url: '{{ url_for("restfulapi.market_status1") }}',
                            data: {
                                code: codelist[k],
                                starttime: '19911231',
                                endtime: '20161231',
                                indexes: Chosenindexes,
                            },
                            dataType: 'json',
                            success: function (data) {
                                for (var i = 0; i < data.indexes.length; i++) {
                                    temp = {
                                        name: data.the_code,
                                        type: 'line',
                                        lineStyle: {normal: {width: 2}},
                                        itemStyle: {normal: {color: colorlist[data.the_code]}},
                                        symbolSize: 8,
                                        smooth: true,
                                        data: numfilter(eval("data." + data.indexes[i])),
                                    };
                                    dataSeries.push(temp);
                                }
                                option = {
                                    title: {
                                        text: '财务指标分析图',
                                        left: '45%'
                                    },
                                    tooltip: {
                                        trigger: 'item',
                                        formatter: function (params) {
                                            return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                        }
                                    },
                                    legend: {
                                        data: [],
                                        orient: 'vertical',
                                        left: '85%',
                                        top: '10%',
                                        formatter: function (name) {
                                            return dict[name];
                                        }
                                    },
                                    grid: {
                                        left: '5%',
                                        top: '10%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            magicType: {
                                                type: ['line', 'bar']
                                            }
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        axisTick: {
                                            show: false
                                        },
                                        data: dateformat(data.the_year),
                                        Interval: 5
                                    },
                                    yAxis: {
                                        type: 'value',
                                        axisTick: {
                                            show: false
                                        },
                                    },
                                    dataZoom: [
                                        {
                                            type: 'slider',
                                            xAxisIndex: [0],
                                            startValue: "2016年Q4",
                                            endValue: "1991年Q4",
                                            filterMode: 'filter',
                                        }
                                    ],
                                    series: dataSeries
                                };
                                myChart.setOption(option, true);
                                myChart.on('datazoom', function (params) {
                                    option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                    var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                    if (Math.ceil(1 - params.end / 100)) {
                                        var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                    }
                                    else {
                                        var starts = '1991-12-31'
                                    }
                                    set_timepicker(starts, ends)
                                });
                                function set_timepicker(start, end) {
                                    document.getElementById('endtime').value = start
                                    document.getElementById('starttime').value = end
                                }
                            }
                        })
                    }
                }
                function creat_compare_option() {
                    $('#div_compare1').empty();
                    for (var x = 0; x < codelist.length; x++) {
                        $.ajax({
                            type: 'GET',
                            url: '{{ url_for("restfulapi.market_status1") }}',
                            data: {
                                code: codelist[x],
                                starttime: '19911231',
                                endtime: '20161231',
                                indexes: Chosenindexes,
                            },
                            dataType: 'json',
                            success: function (data) {
                                $('#div_compare1').append("<div class='thediv' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlist[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                    + data.the_code + "-" + dict[data.the_code] + "</span></div>")
                            }
                        });
                    }
                }
                function creat_compare(thiscode) {
                    $.ajax({
                        type: 'GET',
                        url: '{{ url_for("restfulapi.market_status1") }}',
                        data: {
                            code: thiscode,
                            starttime: '19911231',
                            endtime: '20161231',
                            indexes: Chosenindexes,
                        },
                        dataType: 'json',
                        success: function (data) {
                            $('#div_compare1').append("<div class='thediv' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlist[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                + data.the_code + "-" + dict[data.the_code] + "</span></div>")
                        }
                    });
                }
                function set_time() {
                    document.getElementById('endtime').value = "1991-12-31"
                    document.getElementById('starttime').value = "2016-12-31"
                }
                function RequestTable1(codelist) {
                    var opt = myChart.getOption();
                    var dz = opt.dataZoom[0];
                    $.ajax({
                        type: 'GET',
                        url: '{{url_for("restfulapi.market_status1")}}',
                        data: {
                            code: '10',
                            starttime: opt.xAxis[0].data[dz.endValue],
                            endtime: opt.xAxis[0].data[dz.startValue],
                            indexes: Chosenindexes
                        },
                        dataType: 'json',
                        success: function (data) {
                            console.log(data)
                            market_results_t1 = data;
                            $("#mytable").empty();
                            var table = $("<table id=\"temptable\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                            table.appendTo($("#mytable"));
                            th = $("<thead></thead>");
                            th.appendTo(table);
                            var tr = $("<tr></tr>");
                            tr.appendTo(th);
                            var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                            td.appendTo(tr);
                            theyear = dateformat(market_results_t1.the_year)
                            for (var j = 0; j < theyear.length; j++) {
                                var td = $("<td>" + theyear[j] + "</td>");
                                td.appendTo(tr);
                            }
                            tb = $("<tbody></tbody>");
                            tb.appendTo(table);
                            $("#mytable").append("</table>");
                            var mydatatb = $('#temptable').DataTable({
                                "info": false,
                                "processing": true,
                                "scrollX": true,
                                "searching": true,
                                "fixedColumns": { //固定列的配置项
                                    "leftColumns": 1//固定左边第一列
                                },
                                "language": {
                                    "emptyTable": "没有数据",
                                    "loadingRecords": "加载中…",
                                    "processing": "查询中…",
                                    "search": "检索:",
                                    "lengthMenu": "每页 _MENU_ 条",
                                    "zeroRecords": "没有数据",
                                    "paginate": {
                                        "first": "第一页",
                                        "last": "最后一页",
                                        "next": "",
                                        "previous": ""
                                    },
                                    "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                    "infoEmpty": "没有数据",
                                    "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                }
                            });
                            setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                            for (var k = 0; k < codelist.length; k++) {
                                $.ajax({
                                    type: 'GET',
                                    url: '{{url_for("restfulapi.market_status1")}}',
                                    data: {
                                        code: codelist[k],
                                        starttime: opt.xAxis[0].data[dz.endValue],
                                        endtime: opt.xAxis[0].data[dz.startValue],
                                        indexes: Chosenindexes
                                    },
                                    dataType: 'json',
                                    success: function (data) {
                                        invest_results_t1 = '';
                                        invest_results_t1 = data;
                                        for (var i = 0; i < invest_results_t1.indexes.length; i++) {
                                            var rowNode = mydatatb
                                                .row.add([dict[invest_results_t1.the_code]].concat(numfilter(eval("invest_results_t1." + invest_results_t1.indexes[i]))))
                                                .draw()
                                                .node();
                                            $(rowNode)
                                                .attr('id', invest_results_t1.the_code);
                                            $(rowNode)
                                                .css('color', colorlist[invest_results_t1.the_code]);
                                        }
                                    }
                                });
                            }
                        }
                    });
                }
            </script>
            <!--复选框操作-->
            <script>
                var Chosenindexes = new Array();
                Chosenindexes = ['tot_oper_rev'];
                $(document).ready(function () {

                });
                $(":radio").change(function () {
                    indexname = $(this).val();
                    if ($(this).is(':checked') == true) {
                        console.log(this);
                        Chosenindexes = [];
                        Chosenindexes.push(indexname);
                        console.log(Chosenindexes);
                    }
                    else {
                        Chosenindexes.remove(indexname);
                        console.log(Chosenindexes);
                    }

                    $("div#unselected").empty();
                    $("div#selected").empty();
                    $("input[type=radio]").each(function () {//each()方法遍历所有的复选框
                        if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                            var tempspan = $("<span class=\"label label-default\" data-stopPropagation=\"true\"id =\"" + indexname + "\">" + dict[indexname] + "</span>")
                            tempspan.appendTo($("div#unselected"));
                            $("div#unselected").append(" ");
                        }
                    })
                    RequestChart1(codelist);
                    RequestTable1(codelist);
                    set_time();
                });
            </script>
            <!--时间控制框-->
            <script>
                var starttime = "19911231";
                var endtime = "20161231";
                $(".form_datetime").datetimepicker({
                    format: 'yyyy-mm-dd ',
                    startView: 4,
                    minView: 4,
                    maxView: 4,
                    autoclose: true,
                    pickerPosition: 'top-right'
                });
                $('#starttime').datetimepicker('setStartDate', '1991-12-31');
                $('#starttime').datetimepicker('setEndDate', '2016-12-31');
                $('#endtime').datetimepicker('setStartDate', '1991-12-31');
                $('#endtime').datetimepicker('setEndDate', '2016-12-31');
                $('#starttime')
                    .datetimepicker()
                    .on('changeDate', function (ev) {
                        starts = ev.date.Format("yyyy年Q4");
                        option.dataZoom[0].startValue = starts;
                        myChart.setOption(option);
                        RequestTable1(codelist);
                    });
                $('#endtime')
                    .datetimepicker()
                    .on('changeDate', function (ev) {
                        ends = ev.date.Format("yyyy年Q4");
                        option.dataZoom[0].endValue = ends;
                        myChart.setOption(option);
                        RequestTable1(codelist);
                    });
                Date.prototype.Format = function (fmt) { //author: meizz
                    var o = {
                        "M+": this.getMonth() + 1, //月份
                        "d+": this.getDate(), //日
                        "h+": this.getHours(), //小时
                        "m+": this.getMinutes(), //分
                        "s+": this.getSeconds(), //秒
                        "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                        "S": this.getMilliseconds() //毫秒
                    };
                    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
                    for (var k in o)
                        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                    return fmt;
                }
                function dateformat(olddate) {
                    newdate = []
                    for (i = 0; i < olddate.length; i++) {
                        var str = olddate[i];
                        var reg = /1231/g;
                        str = str.replace(reg, '年Q4');
                        newdate.push(str)
                    }
                    return newdate
                }
            </script>
            <!--单位转换-->
            <script>
                denominator = 1
                $("select#unit").change(function () {
                    flag = $(this).val();
                    if (flag == "0") {
                        denominator = 1;
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                        set_time();
                    }
                    if (flag == "1") {
                        denominator = 1000;
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                        set_time();
                    }
                });
                function numfilter(oldnum) {
                    newnum = []
                    for (i = 0; i < oldnum.length; i++) {
                        temp = oldnum[i] / denominator;
                        newnum.push(temp.toFixed(2))
                    }
                    return newnum;
                }
            </script>

        {% elif param==2 %}
            <div id="myTabChoice2" style="width: 100%;height:600px;margin:auto ">
                <ul id="myTab" class="nav nav-tabs">
                    <li class="disabled">
                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                    </li>
                    <li class="active"><a href="#chart" data-toggle="tab">图表</a></li>
                    <li><a href="#table" data-toggle="tab" onclick="RequestTable1(codelist)">数据</a></li>
                </ul>
                <div id="choice" class="tab-content">
                    <div class="tab-pane fade in active" id="chart">
                        <div id="mychart" style="width:85%;height:60%;;float:right"></div>
                        <div id="myspan" style="width:15%;height:25%;float:left;overflow-y:auto">
                            <legend>比较列表</legend>
                            <div id="div_compare1" style="overflow-y: auto"></div>
                        </div>
                        <div id="mychoice" style="width:15%;height:47%;float:left;overflow-y:auto">
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_oper_rev" checked="checked"
                                                  id="first_check">总营业收入</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="net_profit_is">净利润总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="wgsd_net_inc">归属股东利润总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_assets">总资产总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_liab">总负债总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="net_assets">净资产总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="wgsd_com_eq">股东权益总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="operatecashflow_ttm2">经营性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton"
                                                  value="investcashflow_ttm2">投资性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="financecashflow_ttm2">融资性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="cashflow_ttm2">总现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="free_cash_flow">自由现金流估计</label>
                                </div>
                            </div>
                        </div>
                        <div style="float:right;width:81.5%;height:10%;margin-top:1%;border-radius:8px;background-color:#dcdcdc">
                            <div style="float: left;margin-left: 20px;margin-top:20px">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">起始时间:</a><input size="16"
                                                                                                      type="text"
                                                                                                      value="1991-12-31"
                                                                                                      id="endtime"
                                                                                                      readonly
                                                                                                      class="form_datetime">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">结束时间:</a><input size="16"
                                                                                                      type="text"
                                                                                                      value="2016-12-31"
                                                                                                      id="starttime"
                                                                                                      readonly
                                                                                                      class="form_datetime">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">单位:</a>
                                <select id="unit">
                                    <option value="0">亿</option>
                                    <option value="1">千亿</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="table">
                        <div id="mytable" style="width: 100%;height:100%;overflow-y:scroll;overflow-x:scroll"></div>
                    </div>
                </div>
            </div>
            <script>
                $("#submit2").click(function () {
                    thiscode = $("#stockcode2").val();
                    var a = 1;
                    for (var i = 0; i < codelist.length; i++) {
                        if (thiscode == codelist[i]) {
                            alert('已添加，请勿重复添加！')
                            a = 0
                        }
                    }
                    if (a) {
                        codelist.push(thiscode);
                        colorlist[thiscode] = NewColor();
                        creat_compare(thiscode)
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                    }
                });
                $("#clear2").click(function () {
                    codelist = [];
                    $('#div_compare1').empty();
                    $("#mytable").empty();
                    var myChart = echarts.init(document.getElementById('mychart'));
                    myChart.clear();
                });
            </script>
            <!--图表-->
            <script>
                var myChart = echarts.init(document.getElementById('mychart'));
                var dict = {
                    '1010': '能源Ⅱ',
                    '1510': '材料Ⅱ',
                    '2010': '资本货物',
                    '2020': '商业和专业服务',
                    '2030': '运输',
                    '2510': '汽车与汽车零部件',
                    '2520': '耐用消费品与服装',
                    '2530': '消费者服务Ⅱ',
                    '2540': '媒体Ⅱ',
                    '2550': '零售业',
                    '3010': '食品与主要用品零售Ⅱ',
                    '3020': '食品、饮料与烟草',
                    '3030': '家庭与个人用品',
                    '3510': '医疗保健设备与服务',
                    '3520': '制药、生物科技与生命科学',
                    '4010': '银行',
                    '4020': '多元金融<',
                    '4030': '保险Ⅱ',
                    '4510': '软件与服务',
                    '4520': '技术硬件与设备',
                    '4530': '半导体与半导体生产设备',
                    '5010': '电信服务Ⅱ',
                    '5510': '公用事业Ⅱ',
                    '6010': '房地产Ⅱ'
                };
                var colorlist = {};
                var codelist = ['1010', '1510'];
                colorlist['1010'] = '#000000';
                colorlist['1510'] = '#028600';
                var market_results_t1;
                var invest_results_t1;

                $(document).ready(function () {
                    creat_compare_option();
                    RequestChart1(codelist);
                    RequestTable1(codelist);
                });
                function creat_compare_option() {
                    $('#div_compare1').empty();
                    for (var x = 0; x < codelist.length; x++) {
                        $.ajax({
                            type: 'GET',
                            url: '{{ url_for("restfulapi.market_status2") }}',
                            data: {
                                code: codelist[x],
                                starttime: '19911231',
                                endtime: '20161231',
                                indexes: Chosenindexes,
                            },
                            dataType: 'json',
                            success: function (data) {
                                $('#div_compare1').append("<div class='thediv' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlist[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                    + data.the_code + "-" + dict[data.the_code] + "</span></div>")
                            }
                        });
                    }
                }
                function RequestChart1(codelist) {
                    dataSeries = [];
                    for (var k = 0; k < codelist.length; k++) {
                        $.ajax({
                            type: 'GET',
                            url: '{{ url_for("restfulapi.market_status2") }}',
                            data: {
                                code: codelist[k],
                                starttime: '19911231',
                                endtime: '20161231',
                                indexes: Chosenindexes,
                            },
                            dataType: 'json',
                            success: function (data) {
                                for (var i = 0; i < data.indexes.length; i++) {
                                    temp = {
                                        name: data.the_code,
                                        type: 'line',
                                        lineStyle: {normal: {width: 2}},
                                        itemStyle: {normal: {color: colorlist[data.the_code]}},
                                        symbolSize: 8,
                                        smooth: true,
                                        data: numfilter(eval("data." + data.indexes[i])),
                                    };
                                    dataSeries.push(temp);
                                }
                                option = {
                                    title: {
                                        text: '财务指标分析图',
                                        left: '45%'
                                    },
                                    tooltip: {
                                        trigger: 'item',
                                        formatter: function (params) {
                                            return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                        }
                                    },
                                    legend: {
                                        data: [],
                                        orient: 'vertical',
                                        left: '85%',
                                        top: '10%',
                                        formatter: function (name) {
                                            return dict[name];
                                        }
                                    },
                                    grid: {
                                        left: '5%',
                                        top: '10%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            magicType: {
                                                type: ['line', 'bar']
                                            }
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        axisTick: {
                                            show: false
                                        },
                                        data: dateformat(data.the_year),
                                        Interval: 5
                                    },
                                    yAxis: {
                                        type: 'value',
                                        axisTick: {
                                            show: false
                                        },
                                    },
                                    dataZoom: [
                                        {
                                            type: 'slider',
                                            xAxisIndex: [0],
                                            startValue: "2016年Q4",
                                            endValue: "1991年Q4",
                                            filterMode: 'filter',
                                        }
                                    ],
                                    series: dataSeries
                                };
                                myChart.setOption(option, true);
                                myChart.on('datazoom', function (params) {
                                    option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                    var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                    if (Math.ceil(1 - params.end / 100)) {
                                        var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                    }
                                    else {
                                        var starts = '1991-12-31'
                                    }
                                    set_timepicker(starts, ends)
                                });
                                function set_timepicker(start, end) {
                                    document.getElementById('endtime').value = start
                                    document.getElementById('starttime').value = end
                                }
                            }
                        })
                    }
                }
                function creat_compare(thiscode) {
                    $.ajax({
                        type: 'GET',
                        url: '{{ url_for("restfulapi.market_status2") }}',
                        data: {
                            code: thiscode,
                            starttime: '19911231',
                            endtime: '20161231',
                            indexes: Chosenindexes,
                        },
                        dataType: 'json',
                        success: function (data) {
                            $('#div_compare1').append("<div class='thediv' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlist[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                + data.the_code + "-" + dict[data.the_code] + "</span></div>")
                        }
                    })
                }
                function set_time() {
                    document.getElementById('endtime').value = "1991-12-31"
                    document.getElementById('starttime').value = "2016-12-31"
                }
                function RequestTable1(codelist) {
                    var opt = myChart.getOption();
                    var dz = opt.dataZoom[0];
                    $.ajax({
                        type: 'GET',
                        url: '{{url_for("restfulapi.market_status2")}}',
                        data: {
                            code: '10',
                            starttime: opt.xAxis[0].data[dz.endValue],
                            endtime: opt.xAxis[0].data[dz.startValue],
                            indexes: Chosenindexes
                        },
                        dataType: 'json',
                        success: function (data) {
                            console.log(data)
                            market_results_t1 = data;
                            $("#mytable").empty();
                            var table = $("<table id=\"temptable\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                            table.appendTo($("#mytable"));
                            th = $("<thead></thead>");
                            th.appendTo(table);
                            var tr = $("<tr></tr>");
                            tr.appendTo(th);
                            var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                            td.appendTo(tr);
                            theyear = dateformat(market_results_t1.the_year)
                            for (var j = 0; j < theyear.length; j++) {
                                var td = $("<td>" + theyear[j] + "</td>");
                                td.appendTo(tr);
                            }
                            tb = $("<tbody></tbody>");
                            tb.appendTo(table);
                            $("#mytable").append("</table>");
                            var mydatatb = $('#temptable').DataTable({
                                "info": false,
                                "processing": true,
                                "scrollX": true,
                                "searching": true,
                                "fixedColumns": { //固定列的配置项
                                    "leftColumns": 1//固定左边第一列
                                },
                                "language": {
                                    "emptyTable": "没有数据",
                                    "loadingRecords": "加载中…",
                                    "processing": "查询中…",
                                    "search": "检索:",
                                    "lengthMenu": "每页 _MENU_ 条",
                                    "zeroRecords": "没有数据",
                                    "paginate": {
                                        "first": "第一页",
                                        "last": "最后一页",
                                        "next": "",
                                        "previous": ""
                                    },
                                    "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                    "infoEmpty": "没有数据",
                                    "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                }
                            });
                            setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                            for (var k = 0; k < codelist.length; k++) {
                                $.ajax({
                                    type: 'GET',
                                    url: '{{url_for("restfulapi.market_status2")}}',
                                    data: {
                                        code: codelist[k],
                                        starttime: opt.xAxis[0].data[dz.endValue],
                                        endtime: opt.xAxis[0].data[dz.startValue],
                                        indexes: Chosenindexes
                                    },
                                    dataType: 'json',
                                    success: function (data) {
                                        invest_results_t1 = '';
                                        invest_results_t1 = data;
                                        for (var i = 0; i < invest_results_t1.indexes.length; i++) {
                                            var rowNode = mydatatb
                                                .row.add([dict[invest_results_t1.the_code]].concat(numfilter(eval("invest_results_t1." + invest_results_t1.indexes[i]))))
                                                .draw()
                                                .node();
                                            $(rowNode)
                                                .attr('id', invest_results_t1.the_code);
                                            $(rowNode)
                                                .css('color', colorlist[invest_results_t1.the_code]);
                                        }
                                    }
                                });
                            }
                        }
                    });
                }
            </script>
            <!--复选框操作-->
            <script>
                var Chosenindexes = new Array();
                Chosenindexes = ['tot_oper_rev'];
                $(document).ready(function () {

                });
                $(":radio").change(function () {
                    indexname = $(this).val();
                    if ($(this).is(':checked') == true) {
                        console.log(this);
                        Chosenindexes = [];
                        Chosenindexes.push(indexname);
                        console.log(Chosenindexes);
                    }
                    else {
                        Chosenindexes.remove(indexname);
                        console.log(Chosenindexes);
                    }

                    $("div#unselected").empty();
                    $("div#selected").empty();
                    $("input[type=radio]").each(function () {//each()方法遍历所有的复选框
                        if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                            var tempspan = $("<span class=\"label label-default\" data-stopPropagation=\"true\"id =\"" + indexname + "\">" + dict[indexname] + "</span>")
                            tempspan.appendTo($("div#unselected"));
                            $("div#unselected").append(" ");
                        }
                    })
                    RequestChart1(codelist);
                    RequestTable1(codelist);
                    set_time();
                });
            </script>
            <!--时间控制框-->
            <script>
                var starttime = "19911231";
                var endtime = "20161231";
                $(".form_datetime").datetimepicker({
                    format: 'yyyy-mm-dd ',
                    startView: 4,
                    minView: 4,
                    maxView: 4,
                    autoclose: true,
                    pickerPosition: 'top-right'
                });
                $('#starttime').datetimepicker('setStartDate', '1991-12-31');
                $('#starttime').datetimepicker('setEndDate', '2016-12-31');
                $('#endtime').datetimepicker('setStartDate', '1991-12-31');
                $('#endtime').datetimepicker('setEndDate', '2016-12-31');
                $('#starttime')
                    .datetimepicker()
                    .on('changeDate', function (ev) {
                        starts = ev.date.Format("yyyy年Q4");
                        option.dataZoom[0].startValue = starts;
                        myChart.setOption(option);
                        RequestTable1(codelist);
                    });
                $('#endtime')
                    .datetimepicker()
                    .on('changeDate', function (ev) {
                        ends = ev.date.Format("yyyy年Q4");
                        option.dataZoom[0].endValue = ends;
                        myChart.setOption(option);
                        RequestTable1(codelist);
                    });
                Date.prototype.Format = function (fmt) { //author: meizz
                    var o = {
                        "M+": this.getMonth() + 1, //月份
                        "d+": this.getDate(), //日
                        "h+": this.getHours(), //小时
                        "m+": this.getMinutes(), //分
                        "s+": this.getSeconds(), //秒
                        "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                        "S": this.getMilliseconds() //毫秒
                    };
                    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
                    for (var k in o)
                        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                    return fmt;
                }
                function dateformat(olddate) {
                    newdate = []
                    for (i = 0; i < olddate.length; i++) {
                        var str = olddate[i];
                        var reg = /1231/g;
                        str = str.replace(reg, '年Q4');
                        newdate.push(str)
                    }
                    return newdate
                }
            </script>
            <!--单位转换-->
            <script>
                denominator = 1
                $("select#unit").change(function () {
                    flag = $(this).val();
                    if (flag == "0") {
                        denominator = 1;
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                        set_time();
                    }
                    if (flag == "1") {
                        denominator = 1000;
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                        set_time();
                    }
                });
                function numfilter(oldnum) {
                    newnum = []
                    for (i = 0; i < oldnum.length; i++) {
                        temp = oldnum[i] / denominator;
                        newnum.push(temp.toFixed(2))
                    }
                    return newnum;
                }
            </script>

        {% elif param==3 %}
            <div id="myTabChoice3" style="width: 100%;height:600px;margin:auto ">
                <ul id="myTab" class="nav nav-tabs">
                    <li class="disabled">
                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                    </li>
                    <li class="active"><a href="#chart" data-toggle="tab">图表</a></li>
                    <li><a href="#table" data-toggle="tab" onclick="RequestTable1(codelist)">数据</a></li>
                </ul>
                <div id="choice" class="tab-content">
                    <div class="tab-pane fade in active" id="chart">
                        <div id="mychart" style="width:85%;height:60%;float:right"></div>
                        <div id="myspan" style="width:15%;height:25%;float:left;overflow-y:auto">
                            <legend>比较列表</legend>
                            <div id="div_compare1" style="overflow-y: auto"></div>
                        </div>
                        <div id="mychoice" style="width:15%;height:47%;float:left;overflow-y:auto">
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_oper_rev" checked="checked"
                                                  id="first_check">总营业收入</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="net_profit_is">净利润总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="wgsd_net_inc">归属股东利润总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_assets">总资产总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_liab">总负债总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="net_assets">净资产总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="wgsd_com_eq">股东权益总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="operatecashflow_ttm2">经营性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton"
                                                  value="investcashflow_ttm2">投资性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="financecashflow_ttm2">融资性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="cashflow_ttm2">总现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="free_cash_flow">自由现金流估计</label>
                                </div>
                            </div>
                        </div>
                        <div style="float:right;width:81.5%;height:10%;margin-top:1%;border-radius:8px;background-color:#dcdcdc">
                            <div style="float: left;margin-left: 20px;margin-top:20px">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">起始时间:</a><input size="16"
                                                                                                      type="text"
                                                                                                      value="1991-12-31"
                                                                                                      id="endtime"
                                                                                                      readonly
                                                                                                      class="form_datetime">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">结束时间:</a><input size="16"
                                                                                                      type="text"
                                                                                                      value="2016-12-31"
                                                                                                      id="starttime"
                                                                                                      readonly
                                                                                                      class="form_datetime">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">单位:</a>
                                <select id="unit">
                                    <option value="0">亿</option>
                                    <option value="1">千亿</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="table">
                        <div id="mytable" style="width: 100%;height:100%;overflow-y:scroll;overflow-x:scroll"></div>
                    </div>
                </div>
            </div>
            <script>
                $("#submit3").click(function () {
                    thiscode = $("#stockcode3").val();
                    var a = 1;
                    for (var i = 0; i < codelist.length; i++) {
                        if (thiscode == codelist[i]) {
                            alert('已添加，请勿重复添加！')
                            a = 0
                        }
                    }
                    if (a) {
                        codelist.push(thiscode);
                        colorlist[thiscode] = NewColor();
                        RequestChart1(codelist);
                        creat_compare(thiscode);
                        RequestTable1(codelist);
                    }
                });
                $("#clear3").click(function () {
                    codelist = [];
                    $('#div_compare1').empty();
                    $("#mytable").empty();
                    var myChart = echarts.init(document.getElementById('mychart'));
                    myChart.clear();
                });
            </script>
            <!--图表-->
            <script>
                var myChart = echarts.init(document.getElementById('mychart'));
                var dict = {
                    '101010': '能源设备与服务',
                    '101020': '石油、天然气与供消费用燃料',
                    '151010': '化工',
                    '151020': '建材Ⅲ',
                    '151030': '容器与包装',
                    '151040': '金属、非金属与采矿',
                    '151050': '纸与林木产品',
                    '201010': '航空航天与国防Ⅲ',
                    '201020': '建筑产品Ⅲ',
                    '201030': '建筑与工程Ⅲ',
                    '201040': '电气设备',
                    '201050': '综合类Ⅲ',
                    '201060': '机械',
                    '201070': '贸易公司与工业品经销商Ⅲ ',
                    '202010': '商业服务与用品',
                    '202020': '专业服务',
                    '203010': '航空货运与物流Ⅲ',
                    '203020': '航空Ⅲ',
                    '203030': '海运Ⅲ',
                    '203040': '公路与铁路运输',
                    '203050': '交通基础设施',
                    '251010': '汽车零配件',
                    '251020': '汽车',
                    '252010': '家庭耐用消费品',
                    '252020': '休闲设备与用品',
                    '252030': '纺织品、服装与奢侈品',
                    '253010': '酒店、餐馆与休闲Ⅲ',
                    '253020': '综合消费者服务Ⅲ',
                    '254010': '媒体Ⅲ',
                    '255010': '消费品经销商Ⅲ',
                    '255020': '互联网与售货目录零售',
                    '255030': '多元化零售',
                    '255040': '专营零售',
                    '301010': '食品与主要用品零售Ⅲ',
                    '302010': '饮料',
                    '302020': '食品',
                    '303010': '家庭用品Ⅲ',
                    '303020': '个人用品Ⅲ ',
                    '351010': '医疗保健设备与用品',
                    '351020': '医疗保健提供商与服务',
                    '351030': '医疗保健技术Ⅲ',
                    '352010': '生物科技Ⅲ',
                    '352020': '制药',
                    '352030': '生命科学工具和服务Ⅲ',
                    '401010': '商业银行',
                    '402010': '多元金融服务',
                    '402030': '资本市场',
                    '403010': '保险Ⅲ',
                    '451010': '互联网软件与服务Ⅲ',
                    '451020': '信息技术服务',
                    '451030': '软件',
                    '452010': '通信设备Ⅲ',
                    '452020': '电脑与外围设备',
                    '452030': '电子设备、仪器和元件',
                    '453010': '半导体产品与半导体设备',
                    '501010': '多元电信服务',
                    '501020': '无线电信业务Ⅲ',
                    '551010': '电力Ⅲ',
                    '551020': '燃气Ⅲ',
                    '551030': '复合型公用事业Ⅲ ',
                    '551040': '水务Ⅲ',
                    '551050': '独立电力生产商与能源贸易商Ⅲ',
                    '601020': '房地产管理和开发',
                };
                var colorlist = {};
                var codelist = ['101010', '101020'];
                colorlist['101010'] = '#000000';
                colorlist['101020'] = '#028600';
                var market_results_t1;
                var invest_results_t1;

                $(document).ready(function () {
                    creat_compare_option();
                    RequestChart1(codelist);
                    RequestTable1(codelist);
                });
                function RequestChart1(codelist) {
                    dataSeries = [];
                    for (var k = 0; k < codelist.length; k++) {
                        $.ajax({
                            type: 'GET',
                            url: '{{ url_for("restfulapi.market_status3") }}',
                            data: {
                                code: codelist[k],
                                starttime: '19911231',
                                endtime: '20161231',
                                indexes: Chosenindexes,
                            },
                            dataType: 'json',
                            success: function (data) {
                                for (var i = 0; i < data.indexes.length; i++) {
                                    temp = {
                                        name: data.the_code,
                                        type: 'line',
                                        lineStyle: {normal: {width: 2}},
                                        itemStyle: {normal: {color: colorlist[data.the_code]}},
                                        symbolSize: 8,
                                        smooth: true,
                                        data: numfilter(eval("data." + data.indexes[i])),
                                    };
                                    dataSeries.push(temp);
                                }
                                option = {
                                    title: {
                                        text: '财务指标分析图',
                                        left: '45%'
                                    },
                                    tooltip: {
                                        trigger: 'item',
                                        formatter: function (params) {
                                            return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                        }
                                    },
                                    legend: {
                                        data: [],
                                        orient: 'vertical',
                                        left: '85%',
                                        top: '10%',
                                        formatter: function (name) {
                                            return dict[name];
                                        }
                                    },
                                    grid: {
                                        left: '5%',
                                        top: '10%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            magicType: {
                                                type: ['line', 'bar']
                                            }
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        axisTick: {
                                            show: false
                                        },
                                        data: dateformat(data.the_year),
                                        Interval: 5
                                    },
                                    yAxis: {
                                        type: 'value',
                                        axisTick: {
                                            show: false
                                        },
                                    },
                                    dataZoom: [
                                        {
                                            type: 'slider',
                                            xAxisIndex: [0],
                                            startValue: "2016年Q4",
                                            endValue: "1991年Q4",
                                            filterMode: 'filter',
                                        }
                                    ],
                                    series: dataSeries
                                };
                                myChart.setOption(option, true);
                                myChart.on('datazoom', function (params) {
                                    option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                    var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                    if (Math.ceil(1 - params.end / 100)) {
                                        var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                    }
                                    else {
                                        var starts = '1991-12-31'
                                    }
                                    set_timepicker(starts, ends)
                                });
                                function set_timepicker(start, end) {
                                    document.getElementById('endtime').value = start
                                    document.getElementById('starttime').value = end
                                }
                            }
                        })
                    }
                }
                function creat_compare_option() {
                    $('#div_compare1').empty();
                    for (var x = 0; x < codelist.length; x++) {
                        $.ajax({
                            type: 'GET',
                            url: '{{ url_for("restfulapi.market_status3") }}',
                            data: {
                                code: codelist[x],
                                starttime: '19911231',
                                endtime: '20161231',
                                indexes: Chosenindexes,
                            },
                            dataType: 'json',
                            success: function (data) {
                                $('#div_compare1').append("<div class='thediv' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlist[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                    + data.the_code + "-" + dict[data.the_code] + "</span></div>")
                            }
                        })
                    }
                }
                function creat_compare(thiscode) {
                    $.ajax({
                        type: 'GET',
                        url: '{{ url_for("restfulapi.market_status3") }}',
                        data: {
                            code: thiscode,
                            starttime: '19911231',
                            endtime: '20161231',
                            indexes: Chosenindexes,
                        },
                        dataType: 'json',
                        success: function (data) {
                            $('#div_compare1').append("<div class='thediv' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlist[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                + data.the_code + "-" + dict[data.the_code] + "</span></div>")
                        }
                    })
                }
                function set_time() {
                    document.getElementById('endtime').value = "1991-12-31"
                    document.getElementById('starttime').value = "2016-12-31"
                }
                function RequestTable1(codelist) {
                    var opt = myChart.getOption();
                    var dz = opt.dataZoom[0];
                    $.ajax({
                        type: 'GET',
                        url: '{{url_for("restfulapi.market_status3")}}',
                        data: {
                            code: '10',
                            starttime: opt.xAxis[0].data[dz.endValue],
                            endtime: opt.xAxis[0].data[dz.startValue],
                            indexes: Chosenindexes
                        },
                        dataType: 'json',
                        success: function (data) {
                            console.log(data)
                            market_results_t1 = data;
                            $("#mytable").empty();
                            var table = $("<table id=\"temptable\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                            table.appendTo($("#mytable"));
                            th = $("<thead></thead>");
                            th.appendTo(table);
                            var tr = $("<tr></tr>");
                            tr.appendTo(th);
                            var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                            td.appendTo(tr);
                            theyear = dateformat(market_results_t1.the_year)
                            for (var j = 0; j < theyear.length; j++) {
                                var td = $("<td>" + theyear[j] + "</td>");
                                td.appendTo(tr);
                            }
                            tb = $("<tbody></tbody>");
                            tb.appendTo(table);
                            $("#mytable").append("</table>");
                            var mydatatb = $('#temptable').DataTable({
                                "info": false,
                                "processing": true,
                                "scrollX": true,
                                "searching": true,
                                "fixedColumns": { //固定列的配置项
                                    "leftColumns": 1//固定左边第一列
                                },
                                "language": {
                                    "emptyTable": "没有数据",
                                    "loadingRecords": "加载中…",
                                    "processing": "查询中…",
                                    "search": "检索:",
                                    "lengthMenu": "每页 _MENU_ 条",
                                    "zeroRecords": "没有数据",
                                    "paginate": {
                                        "first": "第一页",
                                        "last": "最后一页",
                                        "next": "",
                                        "previous": ""
                                    },
                                    "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                    "infoEmpty": "没有数据",
                                    "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                }
                            });
                            setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                            for (var k = 0; k < codelist.length; k++) {
                                $.ajax({
                                    type: 'GET',
                                    url: '{{url_for("restfulapi.market_status3")}}',
                                    data: {
                                        code: codelist[k],
                                        starttime: opt.xAxis[0].data[dz.endValue],
                                        endtime: opt.xAxis[0].data[dz.startValue],
                                        indexes: Chosenindexes
                                    },
                                    dataType: 'json',
                                    success: function (data) {
                                        invest_results_t1 = '';
                                        invest_results_t1 = data;
                                        for (var i = 0; i < invest_results_t1.indexes.length; i++) {
                                            var rowNode = mydatatb
                                                .row.add([dict[invest_results_t1.the_code]].concat(numfilter(eval("invest_results_t1." + invest_results_t1.indexes[i]))))
                                                .draw()
                                                .node();
                                            $(rowNode)
                                                .attr('id', invest_results_t1.the_code);
                                            $(rowNode)
                                                .css('color', colorlist[invest_results_t1.the_code]);
                                        }
                                    }
                                });
                            }
                        }
                    });
                }
            </script>
            <!--复选框操作-->
            <script>
                var Chosenindexes = new Array();
                Chosenindexes = ['tot_oper_rev'];
                $(document).ready(function () {

                });
                $(":radio").change(function () {
                    indexname = $(this).val();
                    if ($(this).is(':checked') == true) {
                        console.log(this);
                        Chosenindexes = [];
                        Chosenindexes.push(indexname);
                        console.log(Chosenindexes);
                    }
                    else {
                        Chosenindexes.remove(indexname);
                        console.log(Chosenindexes);
                    }

                    $("div#unselected").empty();
                    $("div#selected").empty();
                    $("input[type=radio]").each(function () {//each()方法遍历所有的复选框
                        if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                            var tempspan = $("<span class=\"label label-default\" data-stopPropagation=\"true\"id =\"" + indexname + "\">" + dict[indexname] + "</span>")
                            tempspan.appendTo($("div#unselected"));
                            $("div#unselected").append(" ");
                        }
                    })
                    RequestChart1(codelist);
                    RequestTable1(codelist);
                    set_time();
                });
            </script>
            <!--时间控制框-->
            <script>
                var starttime = "19911231";
                var endtime = "20161231";
                $(".form_datetime").datetimepicker({
                    format: 'yyyy-mm-dd ',
                    startView: 4,
                    minView: 4,
                    maxView: 4,
                    autoclose: true,
                    pickerPosition: 'top-right'
                });
                $('#starttime').datetimepicker('setStartDate', '1991-12-31');
                $('#starttime').datetimepicker('setEndDate', '2016-12-31');
                $('#endtime').datetimepicker('setStartDate', '1991-12-31');
                $('#endtime').datetimepicker('setEndDate', '2016-12-31');
                $('#starttime')
                    .datetimepicker()
                    .on('changeDate', function (ev) {
                        starts = ev.date.Format("yyyy年Q4");
                        option.dataZoom[0].startValue = starts;
                        myChart.setOption(option);
                        RequestTable1(codelist);
                    });
                $('#endtime')
                    .datetimepicker()
                    .on('changeDate', function (ev) {
                        ends = ev.date.Format("yyyy年Q4");
                        option.dataZoom[0].endValue = ends;
                        myChart.setOption(option);
                        RequestTable1(codelist);
                    });
                Date.prototype.Format = function (fmt) { //author: meizz
                    var o = {
                        "M+": this.getMonth() + 1, //月份
                        "d+": this.getDate(), //日
                        "h+": this.getHours(), //小时
                        "m+": this.getMinutes(), //分
                        "s+": this.getSeconds(), //秒
                        "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                        "S": this.getMilliseconds() //毫秒
                    };
                    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
                    for (var k in o)
                        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                    return fmt;
                }
                function dateformat(olddate) {
                    newdate = []
                    for (i = 0; i < olddate.length; i++) {
                        var str = olddate[i];
                        var reg = /1231/g;
                        str = str.replace(reg, '年Q4');
                        newdate.push(str)
                    }
                    return newdate
                }
            </script>
            <!--单位转换-->
            <script>
                denominator = 1
                $("select#unit").change(function () {
                    flag = $(this).val();
                    if (flag == "0") {
                        denominator = 1;
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                        set_time();
                    }
                    if (flag == "1") {
                        denominator = 1000;
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                        set_time();
                    }
                });
                function numfilter(oldnum) {
                    newnum = []
                    for (i = 0; i < oldnum.length; i++) {
                        temp = oldnum[i] / denominator;
                        newnum.push(temp.toFixed(2))
                    }
                    return newnum;
                }
            </script>

        {% elif param==4 %}
            <div id="myTabChoice4" style="width: 100%;height:600px;margin:auto ">
                <ul id="myTab" class="nav nav-tabs">
                    <li class="disabled">
                        <a href="javascript:return false;" data-toggle="tab" disabled='true'>视图：</a>
                    </li>
                    <li class="active"><a href="#chart" data-toggle="tab">图表</a></li>
                    <li><a href="#table" data-toggle="tab" onclick="RequestTable1(codelist)">数据</a></li>
                </ul>
                <div id="choice" class="tab-content">
                    <div class="tab-pane fade in active" id="chart">
                        <div id="mychart" style="width:85%;height:60%;float:right"></div>
                        <div id="myspan" style="width:15%;height:25%;float:left;overflow-y:auto">
                            <legend>比较列表</legend>
                            <div id="div_compare1" style="overflow-y: auto"></div>
                        </div>
                        <div id="mychoice" style="width:15%;height:47%;float:left;overflow-y:auto">
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_oper_rev" checked="checked"
                                                  id="first_check">总营业收入</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="net_profit_is">净利润总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="wgsd_net_inc">归属股东利润总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_assets">总资产总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="tot_liab">总负债总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="net_assets">净资产总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="wgsd_com_eq">股东权益总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="operatecashflow_ttm2">经营性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton"
                                                  value="investcashflow_ttm2">投资性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="financecashflow_ttm2">融资性现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="cashflow_ttm2">总现金流总和</label>
                                </div>
                            </div>
                            <div style="width:100%;height:30px;margin-top:10px;background-color:lightgray">
                                <div class="radio" style="width:80%;height:20px;float:left;margin-left:5px">
                                    <label><input type="radio" name="radiobutton" value="free_cash_flow">自由现金流估计</label>
                                </div>
                            </div>
                        </div>
                        <div style="float:right;width:81.5%;height:10%;margin-top:1%;border-radius:8px;background-color:#dcdcdc">
                            <div style="float: left;margin-left: 20px;margin-top:20px">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">起始时间:</a><input size="16"
                                                                                                      type="text"
                                                                                                      value="1991-12-31"
                                                                                                      id="endtime"
                                                                                                      readonly
                                                                                                      class="form_datetime">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">结束时间:</a><input size="16"
                                                                                                      type="text"
                                                                                                      value="2016-12-31"
                                                                                                      id="starttime"
                                                                                                      readonly
                                                                                                      class="form_datetime">
                                <a style="width:50px;margin-left:10px;color: #0c0c0c">单位:</a>
                                <select id="unit">
                                    <option value="0">亿</option>
                                    <option value="1">千亿</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="table">
                        <div id="mytable" style="width: 100%;height:100%;overflow-y:scroll;overflow-x:scroll"></div>
                    </div>
                </div>
            </div>
            <script>
                $("#submit4").click(function () {
                    thiscode = $("#stockcode4").val();
                    var a = 1;
                    for (var i = 0; i < codelist.length; i++) {
                        if (thiscode == codelist[i]) {
                            alert('已添加，请勿重复添加！')
                            a = 0
                        }
                    }
                    if (a) {
                        codelist.push(thiscode);
                        colorlist[thiscode] = NewColor();
                        RequestChart1(codelist);
                        creat_compare(thiscode);
                        RequestTable1(codelist);
                    }
                });
                $("#clear4").click(function () {
                    codelist = [];
                    $('#div_compare1').empty();
                    $("#mytable").empty();
                    var myChart = echarts.init(document.getElementById('mychart'));
                    myChart.clear();
                });
            </script>
            <!--图表-->
            <script>
                var myChart = echarts.init(document.getElementById('mychart'));
                var dict = {
                    '10101010': '石油天然气钻井',
                    '10101020': '石油天然气设备与服务',
                    '10102010': '综合性石油天然气',
                    '10102020': '石油天然气勘探与生产',
                    '10102030': '石油与天然气的炼制和销售',
                    '10102040': '石油与天然气的储存和运输',
                    '10102050': '煤炭与消费用燃料',
                    '15101010': '基础化工',
                    '15101011': '化纤',
                    '15101020': '多元化工',
                    '15101030': '化肥与农用化工',
                    '15101040': '工业气体',
                    '15101050': '特种化工',
                    '15102010': '建材 ',
                    '15103010': '金属与玻璃容器',
                    '15103020': '纸包装',
                    '15104010': '铝',
                    '15104020': '金属非金属',
                    '15104030': '黄金',
                    '15104040': '贵金属与矿石',
                    '15104045': '白银',
                    '15104050': '钢铁',
                    '15105010': '林木产品',
                    '15105020': '纸制品',
                    '20101010': '航天航空与国防',
                    '20102010': '建筑产品',
                    '20103010': '建筑与工程',
                    '20104010': '电气部件与设备',
                    '20104020': '重型电气设备',
                    '20105010': '综合类行业',
                    '20106010': '建筑机械与重型卡车',
                    '20106015': '农用农业机械',
                    '20106020': '工业机械',
                    '20107010': '贸易公司与工业品经销商',
                    '20201070': '综合支持服务',
                    '20202020': '调查和咨询服务',
                    '20301010': '航空货运与物流',
                    '20302010': '航空 ',
                    '20303010': '海运',
                    '20304010': '铁路运输',
                    '20304020': '公路运输',
                    '20305010': '机场服务',
                    '20305020': '公路与铁路',
                    '20305030': '海港与服务',
                    '25101010': '汽车零配件',
                    '25101020': '轮胎与橡胶',
                    '25102010': '汽车制造',
                    '25102020': '摩托车制造',
                    '25201010': '消费电子产品',
                    '25201020': '家庭装饰品',
                    '25201030': '住宅建筑',
                    '25201040': '家用电器',
                    '25201050': '家用器具与特殊消费品',
                    '25202010': '休闲用品',
                    '25202020': '摄影用品',
                    '25203010': '服装、服饰与奢侈品',
                    '25203020': '鞋类',
                    '25203030': '纺织品',
                    '25301020': '酒店、度假村与豪华游轮',
                    '25301030': '休闲设施',
                    '25301040': '餐馆',
                    '25302010': '教育服务',
                    '25401010': '广告',
                    '25401020': '有线和卫星电视',
                    '25401030': '电影与娱乐',
                    '25401040': '出版',
                    '25501010': '消费品经销商',
                    '25502010': '售货目录零售',
                    '25502020': '互联网零售',
                    '25503010': '百货商店',
                    '25503020': '综合货品商店',
                    '25504020': '电脑与电子产品零售',
                    '25504030': '专卖店',
                    '25504050': '汽车零售',
                    '30101010': '药品零售',
                    '30101020': '食品分销商',
                    '30101030': '食品零售',
                    '30101040': '大卖场与超市',
                    '30201010': '啤酒',
                    '30201020': '白酒与葡萄酒',
                    '30201030': '软饮料',
                    '30202010': '农产品',
                    '30202030': '食品加工与肉类',
                    '30301010': '家庭用品',
                    '30302010': '个人用品',
                    '35101010': '医疗保健设备',
                    '35101020': '医疗保健用品',
                    '35102015': '保健护理服务',
                    '35102020': '保健护理设施',
                    '35103010': '医疗保健技术',
                    '35201010': '生物科技',
                    '35202010': '西药',
                    '35202011': '中药',
                    '35203010': '生命科学工具和服务',
                    '40101010': '多元化银行',
                    '40101015': '区域性银行',
                    '40201020': '其他多元金融服务',
                    '40201030': '多领域控股',
                    '40203010': '资产管理与托管银行',
                    '40203020': '投资银行业与经纪业',
                    '40203030': '多元资本市场',
                    '40301020': '人寿与健康保险',
                    '40301030': '多元化保险',
                    '40301040': '财产与意外伤害保险',
                    '45101010': '互联网软件与服务',
                    '45102010': '信息科技咨询与其它服务',
                    '45102020': '数据处理与外包服务',
                    '45103010': '应用软件',
                    '45103020': '系统软件',
                    '45103030': '家庭娱乐软件',
                    '45202010': '通信设备',
                    '45201020': '电脑硬件',
                    '45202020': '电脑存储与外围设备',
                    '45203010': '电子元件',
                    '45203015': '电子设备和仪器',
                    '45203020': '电子制造服务',
                    '45303030': '技术产品经销商',
                    '45301010': '半导体设备',
                    '45301020': '半导体产品',
                    '50101010': '非传统电信运营商',
                    '50101020': '综合电信服务',
                    '50102010': '无线电信业务',
                    '55101010': '电力',
                    '55102010': '燃气',
                    '55103010': '复合型公用事业',
                    '55104010': '水务',
                    '55105010': '独立电力生产商与能源贸易商',
                    '55105020': '新能源发电业者',
                    '60102020': '房地产经营公司',
                    '60102030': '房地产开发',
                    '60102040': '房地产服务',
                };
                var thiscode = '10101010';
                var colorlist = {};
                var codelist = ['10101010', '10101020'];
                colorlist['10101010'] = '#000000';
                colorlist['10101020'] = '#028600';
                var market_results_t1;
                var invest_results_t1;

                $(document).ready(function () {
                    creat_compare_option();
                    RequestChart1(codelist);
                    RequestTable1(codelist);
                });
                function RequestChart1(codelist) {
                    dataSeries = [];
                    for (var k = 0; k < codelist.length; k++) {
                        $.ajax({
                            type: 'GET',
                            url: '{{ url_for("restfulapi.market_status4") }}',
                            data: {
                                code: codelist[k],
                                starttime: '19911231',
                                endtime: '20161231',
                                indexes: Chosenindexes,
                            },
                            dataType: 'json',
                            success: function (data) {
                                for (var i = 0; i < data.indexes.length; i++) {
                                    temp = {
                                        name: data.the_code,
                                        type: 'line',
                                        lineStyle: {normal: {width: 2}},
                                        itemStyle: {normal: {color: colorlist[data.the_code]}},
                                        symbolSize: 8,
                                        smooth: true,
                                        data: numfilter(eval("data." + data.indexes[i])),
                                    };
                                    dataSeries.push(temp);
                                }
                                option = {
                                    title: {
                                        text: '财务指标分析图',
                                        left: '45%'
                                    },
                                    tooltip: {
                                        trigger: 'item',
                                        formatter: function (params) {
                                            return dict[params.seriesName] + "<br/> 时间：" + params.name + "<br/> 数据：" + params.data;
                                        }
                                    },
                                    legend: {
                                        data: [],
                                        orient: 'vertical',
                                        left: '85%',
                                        top: '10%',
                                        formatter: function (name) {
                                            return dict[name];
                                        }
                                    },
                                    grid: {
                                        left: '5%',
                                        top: '10%',
                                        containLabel: true
                                    },
                                    toolbox: {
                                        feature: {
                                            magicType: {
                                                type: ['line', 'bar']
                                            }
                                        }
                                    },
                                    xAxis: {
                                        type: 'category',
                                        boundaryGap: false,
                                        axisTick: {
                                            show: false
                                        },
                                        data: dateformat(data.the_year),
                                        Interval: 5
                                    },
                                    yAxis: {
                                        type: 'value',
                                        axisTick: {
                                            show: false
                                        },
                                    },
                                    dataZoom: [
                                        {
                                            type: 'slider',
                                            xAxisIndex: [0],
                                            startValue: "2016年Q4",
                                            endValue: "1991年Q4",
                                            filterMode: 'filter',
                                        }
                                    ],
                                    series: dataSeries
                                };
                                myChart.setOption(option, true);
                                myChart.on('datazoom', function (params) {
                                    option.xAxis.interval = 10 * (params.end - params.start) / 100;
                                    var ends = (2016 - Math.ceil(params.start / 100 * 25)) + '-12-31'
                                    if (Math.ceil(1 - params.end / 100)) {
                                        var starts = (1991 + Math.ceil((1 - params.end / 100) * 25) - 1) + '-12-31'
                                    }
                                    else {
                                        var starts = '1991-12-31'
                                    }
                                    set_timepicker(starts, ends)
                                });
                                function set_timepicker(start, end) {
                                    document.getElementById('endtime').value = start
                                    document.getElementById('starttime').value = end
                                }
                            }
                        })
                    }
                }
                function creat_compare_option() {
                    $('#div_compare1').empty();
                    for (var x = 0; x < codelist.length; x++) {
                        $.ajax({
                            type: 'GET',
                            url: '{{ url_for("restfulapi.market_status4") }}',
                            data: {
                                code: codelist[x],
                                starttime: '19911231',
                                endtime: '20161231',
                                indexes: Chosenindexes,
                            },
                            dataType: 'json',
                            success: function (data) {
                                $('#div_compare1').append("<div class='thediv' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlist[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                    + data.the_code + "-" + dict[data.the_code] + "</span></div>")
                            }
                        })
                    }
                }
                function creat_compare(thiscode) {
                    $.ajax({
                        type: 'GET',
                        url: '{{ url_for("restfulapi.market_status4") }}',
                        data: {
                            code: thiscode,
                            starttime: '19911231',
                            endtime: '20161231',
                            indexes: Chosenindexes,
                        },
                        dataType: 'json',
                        success: function (data) {
                            $('#div_compare1').append("<div class='thediv' style='width:100%;height:auto;margin-top:5px'><div  id='div_" + data.the_code + "' style='height: 10px;width: 10px;float:right;margin-right:5px;margin-top:5px;background-color:" + colorlist[data.the_code] + "'></div><span class='options' id='" + data.the_code + "'>"
                                + data.the_code + "-" + dict[data.the_code] + "</span></div>")
                        }
                    })
                }
                function set_time() {
                    document.getElementById('endtime').value = "1991-12-31"
                    document.getElementById('starttime').value = "2016-12-31"
                }
                function RequestTable1(codelist) {
                    var opt = myChart.getOption();
                    var dz = opt.dataZoom[0];
                    $.ajax({
                        type: 'GET',
                        url: '{{url_for("restfulapi.market_status4")}}',
                        data: {
                            code: '10',
                            starttime: opt.xAxis[0].data[dz.endValue],
                            endtime: opt.xAxis[0].data[dz.startValue],
                            indexes: Chosenindexes
                        },
                        dataType: 'json',
                        success: function (data) {
                            console.log(data)
                            market_results_t1 = data;
                            $("#mytable").empty();
                            var table = $("<table id=\"temptable\" style=\"text-align:center\" class=\"row-border hover order-column\" cellspacing=\"0\" width=\"100%\"  >");
                            table.appendTo($("#mytable"));
                            th = $("<thead></thead>");
                            th.appendTo(table);
                            var tr = $("<tr></tr>");
                            tr.appendTo(th);
                            var td = $("<td id=\"subject\">" + "比较数据" + "</td>");
                            td.appendTo(tr);
                            theyear = dateformat(market_results_t1.the_year)
                            for (var j = 0; j < theyear.length; j++) {
                                var td = $("<td>" + theyear[j] + "</td>");
                                td.appendTo(tr);
                            }
                            tb = $("<tbody></tbody>");
                            tb.appendTo(table);
                            $("#mytable").append("</table>");
                            var mydatatb = $('#temptable').DataTable({
                                "info": false,
                                "processing": true,
                                "scrollX": true,
                                "searching": true,
                                "fixedColumns": { //固定列的配置项
                                    "leftColumns": 1//固定左边第一列
                                },
                                "language": {
                                    "emptyTable": "没有数据",
                                    "loadingRecords": "加载中…",
                                    "processing": "查询中…",
                                    "search": "检索:",
                                    "lengthMenu": "每页 _MENU_ 条",
                                    "zeroRecords": "没有数据",
                                    "paginate": {
                                        "first": "第一页",
                                        "last": "最后一页",
                                        "next": "",
                                        "previous": ""
                                    },
                                    "info": "第 _PAGE_ 页 / 总 _PAGES_ 页",
                                    "infoEmpty": "没有数据",
                                    "infoFiltered": "(过滤总件数 _MAX_ 条)"
                                }
                            });
                            setTimeout("$(\"#subject\").trigger(\"click\")", 100);
                            for (var k = 0; k < codelist.length; k++) {
                                $.ajax({
                                    type: 'GET',
                                    url: '{{url_for("restfulapi.market_status4")}}',
                                    data: {
                                        code: codelist[k],
                                        starttime: opt.xAxis[0].data[dz.endValue],
                                        endtime: opt.xAxis[0].data[dz.startValue],
                                        indexes: Chosenindexes
                                    },
                                    dataType: 'json',
                                    success: function (data) {
                                        invest_results_t1 = '';
                                        invest_results_t1 = data;
                                        for (var i = 0; i < invest_results_t1.indexes.length; i++) {
                                            var rowNode = mydatatb
                                                .row.add([dict[invest_results_t1.the_code]].concat(numfilter(eval("invest_results_t1." + invest_results_t1.indexes[i]))))
                                                .draw()
                                                .node();
                                            $(rowNode)
                                                .attr('id', invest_results_t1.the_code);
                                            $(rowNode)
                                                .css('color', colorlist[invest_results_t1.the_code]);
                                        }
                                    }
                                });
                            }
                            for (var key in codelist) {
                                $('tr#' + key).css('color', colorlist[key])
                            }
                        }
                    });
                }
            </script>
            <!--复选框操作-->
            <script>
                var Chosenindexes = new Array();
                Chosenindexes = ['tot_oper_rev'];
                $(document).ready(function () {

                });
                $(":radio").change(function () {
                    indexname = $(this).val();
                    if ($(this).is(':checked') == true) {
                        console.log(this);
                        Chosenindexes = [];
                        Chosenindexes.push(indexname);
                        console.log(Chosenindexes);
                    }
                    else {
                        Chosenindexes.remove(indexname);
                        console.log(Chosenindexes);
                    }

                    $("div#unselected").empty();
                    $("div#selected").empty();
                    $("input[type=radio]").each(function () {//each()方法遍历所有的复选框
                        if ($(this).is(':checked') == true) {//这里就可以判断当前是否被选择了
                            var tempspan = $("<span class=\"label label-default\" data-stopPropagation=\"true\"id =\"" + indexname + "\">" + dict[indexname] + "</span>")
                            tempspan.appendTo($("div#unselected"));
                            $("div#unselected").append(" ");
                        }
                    })
                    RequestChart1(codelist);
                    RequestTable1(codelist);
                    set_time();
                });
            </script>
            <!--时间控制框-->
            <script>
                var starttime = "19911231";
                var endtime = "20161231";
                $(".form_datetime").datetimepicker({
                    format: 'yyyy-mm-dd ',
                    startView: 4,
                    minView: 4,
                    maxView: 4,
                    autoclose: true,
                    pickerPosition: 'top-right'
                });
                $('#starttime').datetimepicker('setStartDate', '1991-12-31');
                $('#starttime').datetimepicker('setEndDate', '2016-12-31');
                $('#endtime').datetimepicker('setStartDate', '1991-12-31');
                $('#endtime').datetimepicker('setEndDate', '2016-12-31');
                $('#starttime')
                    .datetimepicker()
                    .on('changeDate', function (ev) {
                        starts = ev.date.Format("yyyy年Q4");
                        option.dataZoom[0].startValue = starts;
                        myChart.setOption(option);
                        RequestTable1(codelist);
                    });
                $('#endtime')
                    .datetimepicker()
                    .on('changeDate', function (ev) {
                        ends = ev.date.Format("yyyy年Q4");
                        option.dataZoom[0].endValue = ends;
                        myChart.setOption(option);
                        RequestTable1(codelist);
                    });
                Date.prototype.Format = function (fmt) { //author: meizz
                    var o = {
                        "M+": this.getMonth() + 1, //月份
                        "d+": this.getDate(), //日
                        "h+": this.getHours(), //小时
                        "m+": this.getMinutes(), //分
                        "s+": this.getSeconds(), //秒
                        "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                        "S": this.getMilliseconds() //毫秒
                    };
                    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
                    for (var k in o)
                        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                    return fmt;
                }
                function dateformat(olddate) {
                    newdate = []
                    for (i = 0; i < olddate.length; i++) {
                        var str = olddate[i];
                        var reg = /1231/g;
                        str = str.replace(reg, '年Q4');
                        newdate.push(str)
                    }
                    return newdate
                }
            </script>
            <!--单位转换-->
            <script>
                denominator = 1
                $("select#unit").change(function () {
                    flag = $(this).val();
                    if (flag == "0") {
                        denominator = 1;
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                        set_time();
                    }
                    if (flag == "1") {
                        denominator = 1000;
                        RequestChart1(codelist);
                        RequestTable1(codelist);
                        set_time();
                    }
                });
                function numfilter(oldnum) {
                    newnum = []
                    for (i = 0; i < oldnum.length; i++) {
                        temp = oldnum[i] / denominator;
                        newnum.push(temp.toFixed(2))
                    }
                    return newnum;
                }
            </script>

        {% endif %}
    </div>
    <!--面板切换-->
    <script>
        $("#mydropdown").on("click", "[data-stopPropagation]", function (e) {
            e.stopPropagation();
        })
    </script>
    <!--随机生成颜色-->
    <script>
        function NewColor() {
            var colorElements = "0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";
            var colorArray = colorElements.split(",");
            var color = "#";
            for (var i = 0; i < 6; i++) {
                color += colorArray[Math.floor(Math.random() * 16)];
            }
            return color;
        }
    </script>
    <!--删除函数-->
    <script>
        Array.prototype.indexOf = function (val) {
            for (var i = 0; i < this.length; i++) {
                if (this[i] == val) return i;
            }
            return -1;
        };
        Array.prototype.remove = function (val) {
            var index = this.indexOf(val);
            if (index > -1) {
                this.splice(index, 1);
            }
        };
    </script>
    <!--搜索事件-->
    <script>
        function selectline(linename) {
            for (var line in option.series) {
                l = parseInt(line);
                if (option.series[l].name == linename) {
                    tempcolor = NewColor();
                    option.series[l].lineStyle.normal.color = tempcolor;
                    option.series[l].itemStyle.normal.color = tempcolor;
                    $("span#" + linename).css('color', tempcolor);
                    selectedindexes.push(l);
                    selectedindexname.push(option.series[l].name);
                    option.legend.data = selectedindexname;
                    myChart.setOption(option);
                }
            }
        }
        function unselectline(linename) {
            for (var line in option.series) {
                l = parseInt(line);
                if (option.series[l].name == linename) {
                    option.series[l].lineStyle.normal.color = '#C4D2DB';
                    option.series[l].itemStyle.normal.color = '#C4D2DB';
                    $("span#" + linename).css('color', 'white');
                    selectedindexes.splice(selectedindexes.indexOf(l), 1);
                    selectedindexname.splice(selectedindexname.indexOf(option.series[l].name), 1);
                    option.legend.data = selectedindexname;
                    myChart.setOption(option);
                }
            }
        }
    </script>
{% endblock %}