<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="utf-8">
        <title>金融投资分析系统</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
	    <meta name="keywords" content="金融投资分析系统">
	    <meta name="content" content="金融投资分析系统">
        <!-- CSS -->
        <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=PT+Sans:400,700'>
        <link href="{{ url_for('static',filename='login/css/reset.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ url_for('static',filename='login/css/supersized.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ url_for('static',filename='login/css/style.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ url_for('static',filename='login/css/fstyle.css') }}" rel="stylesheet" type="text/css">
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <script type="text/javascript" src="{{ url_for('static',filename='login/js/jquery-1.8.2.min.js') }}"></script>
        <script type="text/javascript" src="{{ url_for('static',filename='login/js/supersized.3.2.7.min.js') }}"></script>
        <script type="text/javascript" src="{{ url_for('static',filename='login/js/supersized-init.js') }}"></script>
        <!-- Javascript -->
    </head>
<style>
    .btn_zhuce{ width:270px; height:33px; background:#37b5f9; font-size:14px; line-height:33px; text-align:center; border:0px; color:#fff; border-radius:3px; cursor:pointer;}
</style>
    <body>

        <div class="page-container">
{#            <h1>Metric</h1>#}
                    <main>
                        <div class="form">
                <div class="form__cover">
                </div>
                <div class="form__loader">
                    <div class="spinner active">
                        <svg class="spinner__circular" viewBox="25 25 50 50">
                            <circle class="spinner__path" cx="50" cy="50" r="20" fill="none" stroke-width="4"
                            stroke-miterlimit="10">
                            </circle>
                        </svg>
                    </div>
                </div>
                <div class="form__content">
                    <h1>
                        <p>魔法金融</p>
                        <p>Fin-magic</p>
                    </h1>
                    <div class="styled-input">
                        <input type="text" id="phone_number" class="styled-input__input" name="phone_number" autocomplete="off">
                        <div class="styled-input__placeholder">
                            <span class="styled-input__placeholder-text">
                                手机号
                            </span>
                        </div>
                        <div class="styled-input__circle">
                        </div>
                        <div id="user_msg"></div>
                    </div>
                    <div class="styled-input">
                        <input type="email" id="Verification_code" class="styled-input__input" name="Verification_code" autocomplete="off">
                        <div class="styled-input__placeholder">
                            <span class="styled-input__placeholder-text">
                                验证码
                            </span>
                        </div>
                        <div class="styled-input__circle">
                        </div>
                    </div>

                                    <div style="margin-bottom: 25px">
                    <input name="验证码" id="get_Verification_code" type="button" class="btn_zhuce" value="获取验证码">
                </div>

                    <div class="styled-input">
                        <input type="password" id="pwd" class="styled-input__input" name="password">
                        <div class="styled-input__placeholder">
                            <span class="styled-input__placeholder-text">
                                密码
                            </span>
                        </div>
                        <div class="styled-input__circle">
                        </div>
                        <div id="pwd_msg"></div>
                    </div>
                                        <div class="styled-input">
                        <input type="password" id="cpwd" class="styled-input__input" name="confirm_password">
                        <div class="styled-input__placeholder">
                            <span class="styled-input__placeholder-text">
                                确认密码
                            </span>
                        </div>
                        <div class="styled-input__circle">
                        </div>
                                            <div id="cpwd_msg"></div>
                    </div>
                    <div style="color: red;margin-bottom: 5px">{{ error }}</div>
                    <button id="register_btn" class="styled-button"  disabled="true">
                        <span class="styled-button__real-text-holder">
                            <span class="styled-button__real-text">
                                注册
                            </span>
                            <span class="styled-button__moving-block face">
                                <span class="styled-button__text-holder">
                                    <span class="styled-button__text">
                                        注册
                                    </span>
                                </span>
                            </span>
                            <span class="styled-button__moving-block back">
                                <span class="styled-button__text-holder">
                                    <span class="styled-button__text">
                                        注册
                                    </span>
                                </span>
                            </span>
                        </span>
                    </button>


{#                    <div class="connect">#}
{#                <p>使用以下账号直接登录</p>#}
{#                <p>#}
{#                    <a class="facebook" href=""></a>#}
{#                    <a class="twitter" href=""></a>#}
{#                </p>#}
{##}
{#            </div>#}
                    <div > <p><a href="{{ url_for("stock_solo.basic") }}">访客登陆</a></p></div>
                    <div > <p>已有账号？<a href="{{ url_for("main.index") }}">立即登陆</a></p></div>
        </div>


</div>
        </main>
{#            <form action="" method="post">#}
{#                <input type="text" name="username" class="username" placeholder="Username">#}
{#                <input type="password" name="password" class="password" placeholder="Password">#}
{#                <button type="submit">登陆</button>#}
{#                <div class="error"><span>+</span></div>#}
{#            </form>#}
{#            <div class="connect">#}
{#                <p>使用以下账号直接登录</p>#}
{#                <p>#}
{#                    <a class="facebook" href=""></a>#}
{#                    <a class="twitter" href=""></a>#}
{#                </p>#}
{#            </div>#}
{#        </div>#}
{#        <div align="center"> <p>还没有账号？<a href="{{ url_for("main.register_phone") }}">立即注册</a></p></div>#}
            <div style="position: fixed;bottom: 10px;margin: 0 auto;left: 0px;right: 0px"><p>欢迎来到魔法金融的世界</p>
                <p>Welcome to the Fin-magic world</p></div>
        </div>
    </body>
<script>
var placeholder = document.querySelectorAll('.styled-input__placeholder-text')
var input = document.querySelectorAll('.styled-input__input');
var placeholders = new Array()
var inputs=new Array()
for (var i = 0; i < placeholder.length; i++) {
    var ele = placeholder[i]
    placeholders.push(ele)
}
for (var i = 0; i < input.length; i++) {
    var ele = input[i]
    inputs.push(ele)
}
placeholders.forEach(function (el, i) {
    var text = el.innerText, html = '';
    value = text.split('')
    for (var _iterator = value, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator;;) {
        var _ref;

        if (_isArray) {
            if (_i >= _iterator.length) break;
            _ref = _iterator[_i++];
        } else {
            _i = _iterator.next();
            if (_i.done) break;
            _ref = _i.value;
        }

        var w = _ref;

        if (!value) value = '&nbsp;';
        html += '<span class="letter">' + w + '</span>';
    }
    el.innerHTML = html;
});

inputs.forEach(function (el) {
    var parent = el.parentNode;
    el.addEventListener('focus', function () {
        parent.classList.add('filled');
        placeholderAnimationIn(parent, true);
    }, false);
    el.addEventListener('blur', function () {
        if (el.value.length) return;
        parent.classList.remove('filled');
        placeholderAnimationIn(parent, false);
    }, false);
});
function placeholderAnimationIn(parent, action) {
    var act = action ? 'add' : 'remove';
    var letters = parent.querySelectorAll('.letter');
    letters = [].slice.call(letters, 0);
    if (!action) letters = letters.reverse();
    letters.forEach(function (el, i) {
        setTimeout(function () {
            var contains = parent.classList.contains('filled');
            if (action && !contains || !action && contains) return;
            el.classList[act]('active');
        }, 50 * i);
    });
}

setTimeout(function () {
    document.body.classList.add('on-start');
}, 100);

setTimeout(function () {
    document.body.classList.add('document-loaded');
}, 500);

</script>
<script>
    function checkName(name) {
        $.ajax({
            url:"{{ url_for("main_api.checkName") }}",
            type:"post",
            dataType:"Json",
            data:{"name":name},
            success:function (data) {
                console.log(data)
                if (data.result== true){
                                        $("#user_msg").html("用户名已存在")
                    $("#register_btn").attr("disabled",true)

                }else {

                                        $("#user_msg").html("用户名可用")
                    $("#register_btn").attr("disabled",false)
                }
            }
        })
    }
    function checkPwd(data) {
        var reg=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,16}$/
        if(reg.test(data)){
            $("#register_btn").attr("disabled",false)
            $("#pwd_msg").html("")
        }else {
            $("#pwd_msg").html("请使用8-16位数字字母混合密码")
            $("#register_btn").attr("disabled",true)
        }
    }
    $("#user").focusout(function () {
        var name=$("#user").val()
        if (name != null && name!= ''){
            checkName(name)
        }else {
            $("#user_msg").html("")
        }
    })
    $("#pwd").focusout(function () {
        var pwd=$("#pwd").val()
        if (pwd!=null && pwd!=''){
            checkPwd(pwd)
        }
        else {
            $("#pwd_msg").html("")
        }
    })
        $("#cpwd").focusout(function () {
        var pwd=$("#pwd").val()
        var cpwd=$("#cpwd").val()
        if (cpwd !="" && cpwd != pwd){
            $("#cpwd_msg").html("密码不一致")
            $("#register_btn").attr("disabled",true)
        }else {
            $("#cpwd_msg").html("")
            $("#register_btn").attr("disabled",false)
        }
    })
</script>
    <script>
        {#    发送验证码#}
        $("#get_Verification_code").click(function () {
            phone_number = document.getElementById("phone_number").value
            if (phone_number === "") {
                alert('手机号码不能为空')
            }
            else {
                this.disabled = 'disabled';
                setTimeout(function () {
                    $("#get_Verification_code").disabled = false;
                }, 60000);//1秒后才能点击
                $.ajax({
                    type: 'GET',
                    url: '{{url_for("main_api.send_Verification_code")}}',
                    data: {
                        'phone_number': phone_number,
                    },
                    dataType: 'json',
                    success: function (data) {
                        console.log(data)
                        if (data.exit == 'flase') {
                            alert('短信已发送')
                        }
                        else {
                            alert('该号码已经注册！')
                        }
                    }
                })
            }
        })
        {# 注册 #}
        $("#register_btn").click(function () {

            phone_number = document.getElementsByName("phone_number").value
            password = document.getElementsByName("password").value
            confirm_password = document.getElementsByName("confirm_password").value
            Verification_code = document.getElementsByName("Verification_code").value
            if (phone_number === "") {
                alert('手机号码不能为空')
            }
            else {
                if (password == confirm_password) {
                    $.ajax({
                        type: 'GET',
                        url: '{{url_for("main_api.register_phone")}}',
                        data: {
                            'phone_number': phone_number,
                            'password': password,
                            'confirm_password': confirm_password,
                            'Verification_code': Verification_code,
                        },
                        dataType: 'json',
                        success: function (data) {
                            if (data.msg == 'success') {
                                alert('注册成功！')
                            }
                            else {
                                alert('注册失败！')
                            }

                        }
                    })
                }
                else {
                    alert('两次密码不一致！')
                }
            }
        })
    </script>
</html>

